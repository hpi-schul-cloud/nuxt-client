{"version":3,"file":"src_app_features_dialogs_dialog-modules_send-feedback-dialog_send-feedback-dialog_module_ts.js","mappings":"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","sources":["./src/app/features/dialogs/dialog-modules/send-feedback-dialog/send-feedback-dialog-data.ts","./src/app/features/dialogs/dialog-modules/send-feedback-dialog/send-feedback-dialog.component.ts","./src/app/features/dialogs/dialog-modules/send-feedback-dialog/send-feedback-dialog.component.html","./src/app/features/dialogs/dialog-modules/send-feedback-dialog/send-feedback-dialog.module.ts"],"sourcesContent":["import { Node } from '../../../../core-module/core.module';\n\nexport class SendFeedbackDialogData {\n    node: Node;\n}\n\nexport type SendFeedbackDialogResult = void;\n","import { Component, Inject, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { delay, first } from 'rxjs/operators';\nimport { DialogButton, RestConstants } from '../../../../core-module/core.module';\nimport { Toast } from '../../../../services/toast';\nimport { FeedbackV1Service } from 'ngx-edu-sharing-api';\nimport { MdsEditorInstanceService } from '../../../mds/mds-editor/mds-editor-instance.service';\nimport { Values } from '../../../mds/types/types';\nimport { CARD_DIALOG_DATA } from '../../card-dialog/card-dialog-config';\nimport { CardDialogRef } from '../../card-dialog/card-dialog-ref';\nimport { SendFeedbackDialogData, SendFeedbackDialogResult } from './send-feedback-dialog-data';\n\n@Component({\n    selector: 'es-send-feedback-dialog',\n    templateUrl: './send-feedback-dialog.component.html',\n    styleUrls: ['./send-feedback-dialog.component.scss'],\n    providers: [MdsEditorInstanceService],\n})\nexport class SendFeedbackDialogComponent implements OnInit {\n    constructor(\n        @Inject(CARD_DIALOG_DATA) public data: SendFeedbackDialogData,\n        private dialogRef: CardDialogRef<SendFeedbackDialogData, SendFeedbackDialogResult>,\n        private route: ActivatedRoute,\n        private feedbackService: FeedbackV1Service,\n        private toast: Toast,\n        private mdsEditorInstance: MdsEditorInstanceService,\n    ) {\n        this.dialogRef.patchState({ isLoading: true });\n    }\n\n    ngOnInit(): void {\n        this.initButtons();\n        void this.mdsEditorInstance.initWithoutNodes(\n            'material_feedback',\n            undefined,\n            RestConstants.HOME_REPOSITORY,\n            'form',\n            {},\n        );\n        this.mdsEditorInstance.mdsInflated.pipe(first(), delay(0)).subscribe(() => {\n            this.dialogRef.patchState({ isLoading: false });\n        });\n    }\n\n    private initButtons(): void {\n        const buttons = [\n            new DialogButton('CANCEL', { color: 'standard' }, () => this.dialogRef.close(null)),\n            new DialogButton('FEEDBACK.SAVE', { color: 'primary' }, () => this.addFeedback()),\n        ];\n        this.dialogRef.patchConfig({\n            buttons,\n        });\n        this.mdsEditorInstance\n            .observeCanSave()\n            .subscribe((canSave) => (buttons[1].disabled = !canSave));\n    }\n\n    private async addFeedback() {\n        const values = (await this.mdsEditorInstance.save()) as Values;\n        this.dialogRef.patchState({ isLoading: true });\n        try {\n            await this.feedbackService\n                .addFeedback({\n                    repository: RestConstants.HOME_REPOSITORY,\n                    node: this.data.node.ref.id,\n                    body: values,\n                })\n                .toPromise();\n        } catch (e) {\n            this.toast.error(e);\n        }\n        this.dialogRef.close();\n        const queryParams = await this.route.queryParams.toPromise();\n        if (queryParams.feedbackClose) {\n            window.close();\n        }\n    }\n}\n","<es-mds-editor-core></es-mds-editor-core>\n","import { NgModule } from '@angular/core';\nimport { SharedModule } from '../../../../shared/shared.module';\nimport { MdsModule } from '../../../mds/mds.module';\nimport { SendFeedbackDialogComponent } from './send-feedback-dialog.component';\n\nexport { SendFeedbackDialogComponent };\n\n@NgModule({\n    declarations: [SendFeedbackDialogComponent],\n    imports: [SharedModule, MdsModule],\n})\nexport class SendFeedbackDialogModule {}\n"],"names":["SendFeedbackDialogData","delay","first","DialogButton","RestConstants","MdsEditorInstanceService","CARD_DIALOG_DATA","SendFeedbackDialogComponent","constructor","data","dialogRef","route","feedbackService","toast","mdsEditorInstance","patchState","isLoading","ngOnInit","initButtons","initWithoutNodes","undefined","HOME_REPOSITORY","mdsInflated","pipe","subscribe","buttons","color","close","addFeedback","patchConfig","observeCanSave","canSave","disabled","_this","_asyncToGenerator","values","save","repository","node","ref","id","body","toPromise","e","error","queryParams","feedbackClose","window","_","i0","ɵɵdirectiveInject","i1","CardDialogRef","i2","ActivatedRoute","i3","FeedbackV1Service","i4","Toast","i5","_2","selectors","features","ɵɵProvidersFeature","decls","vars","template","SendFeedbackDialogComponent_Template","rf","ctx","ɵɵelement","SharedModule","MdsModule","SendFeedbackDialogModule","_3","declarations","imports"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}