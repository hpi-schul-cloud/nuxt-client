"use strict";(self.webpackChunkapp_as_web_component=self.webpackChunkapp_as_web_component||[]).push([[6547],{66547:(pn,Z,l)=>{l.r(Z),l.d(Z,{WorkspacePageModule:()=>Ho});var B=l(50555),V=l(47159),h=l(15861),f=l(86825),c=l(52081),a=l(81771),k=l(4254),X=l(16090),e=l(65879),y=l(36692),E=l(22941),b=l(1189),W=l(52517),u=l(96814),v=l(45125),$=l(97734),z=l(32068),O=l(90721),m=l(8077),g=l(71365),A=l(48098),R=l(76754),N=l(32296),w=l(74104),ee=l(44431);function te(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onEditMetadata.emit(n._node))}),e.TgZ(1,"i",14),e._uU(2,"edit"),e.qZA()()}}function oe(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NODE.cclom:title")))}function ne(i,s){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.title)}}function ie(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NODE.cclom:general_keyword")," "))}function se(i,s){if(1&i&&(e.TgZ(0,"div",16)(1,"span",17),e._uU(2),e.qZA()()),2&i){const t=s.$implicit;e.xp6(2),e.Oqu(t)}}function re(i,s){if(1&i&&(e.TgZ(0,"div",6),e.YNc(1,se,3,1,"div",15),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.data.keywords)}}function ae(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NODE.description")))}function ce(i,s){if(1&i&&(e.TgZ(0,"div",18),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.description)}}function le(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NODE.ccm:author_freetext")," "))}function pe(i,s){if(1&i&&(e.TgZ(0,"div",19),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.author_freetext)}}function _e(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NODE.ccm:lifecyclecontributer_authorFN")," "))}function de(i,s){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.author)}}function ue(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,1,"MEDIATYPE."+t.data.mediatype))}}function he(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"MEDIATYPE.file")))}function ge(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"MEDIATYPE.folder")))}function me(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"MEDIATYPE.collection")))}function fe(i,s){if(1&i&&(e.TgZ(0,"span",20),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij("(",t.data.mimetype,")")}}function Te(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NODE.exif:dateTimeOriginal")," "))}function Ce(i,s){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.exifDate)}}function Ee(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NODE.dimensions")))}function xe(i,s){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.dimensions)}}function ve(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NODE.cclom:duration")))}function Oe(i,s){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(t.data.duration)}}function Ae(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NODE.size")))}function Se(i,s){if(1&i&&(e.TgZ(0,"div",6),e._uU(1),e.ALo(2,"formatSize"),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Oqu(e.lcZ(2,1,t.data.size))}}function Me(i,s){1&i&&(e.TgZ(0,"div",6),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NO_SIZE")))}function ke(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"WORKSPACE.METADATA.INVITED_USERS")," "))}function Ne(i,s){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"permissionName"),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function ye(i,s){if(1&i&&(e.TgZ(0,"div",6),e.YNc(1,Ne,3,3,"div",21),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.permissions.users)}}function be(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"WORKSPACE.METADATA.INVITED_GROUPS")," "))}function Re(i,s){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"permissionName"),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function we(i,s){if(1&i&&(e.TgZ(0,"div",6),e.YNc(1,Re,3,3,"div",21),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.permissions.groups)}}function Ie(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ke,3,3,"div",7),e.YNc(2,ye,2,1,"div",8),e.YNc(3,be,3,3,"div",7),e.YNc(4,we,2,1,"div",8),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.permissions.users.length),e.xp6(1),e.Q6J("ngIf",t.permissions.users.length),e.xp6(1),e.Q6J("ngIf",t.permissions.groups.length),e.xp6(1),e.Q6J("ngIf",t.permissions.groups.length)}}function Pe(i,s){1&i&&(e.TgZ(0,"div",5),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NODE.ccm:commonlicense_key")," "))}function De(i,s){if(1&i&&(e.TgZ(0,"div",22),e._UZ(1,"img",23),e.TgZ(2,"div",24),e._uU(3),e.qZA()()),2&i){const t=s.ngIf,o=e.oxw(2);e.xp6(1),e.Q6J("src",t,e.LSH),e.xp6(2),e.Oqu(o.data.licenseName)}}function Le(i,s){if(1&i&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Oqu(t)}}function Ze(i,s){if(1&i&&(e.TgZ(0,"div")(1,"div",5),e._uU(2),e.qZA(),e.TgZ(3,"div",6),e._uU(4),e.qZA()()),2&i){const t=s.$implicit;e.xp6(2),e.Oqu(t[0]),e.xp6(2),e.Oqu(t[1])}}function We(i,s){if(1&i&&(e.TgZ(0,"div")(1,"div",5),e._uU(2),e.qZA(),e.TgZ(3,"div",6),e.YNc(4,Le,2,1,"div",25),e.qZA(),e.YNc(5,Ze,5,2,"div",21),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.Oqu("Aspects"),e.xp6(2),e.Q6J("ngForOf",t.data.aspects),e.xp6(1),e.Q6J("ngForOf",t.data.properties)}}const Ye=function(){return{}},Fe=function(){return{crop:!0,width:600,height:450}};function Ue(i,s){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"img",1),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onDisplay.emit(n._node))}),e.ALo(2,"async"),e.ALo(3,"esNodeImage"),e.qZA(),e.TgZ(4,"div",2),e.YNc(5,te,3,0,"button",3),e.TgZ(6,"div",4)(7,"div",5),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div",6),e._uU(11),e.qZA(),e.YNc(12,oe,3,3,"div",7),e.YNc(13,ne,2,1,"div",8),e.YNc(14,ie,3,3,"div",7),e.YNc(15,re,2,1,"div",8),e.YNc(16,ae,3,3,"div",7),e.YNc(17,ce,2,1,"div",9),e.YNc(18,le,3,3,"div",7),e.YNc(19,pe,2,1,"div",10),e.YNc(20,_e,3,3,"div",7),e.YNc(21,de,2,1,"div",8),e.TgZ(22,"div",5),e._uU(23),e.ALo(24,"translate"),e.qZA(),e.TgZ(25,"div",6),e._uU(26),e._UZ(27,"br"),e._uU(28),e.qZA(),e.TgZ(29,"div",5),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div",6),e.YNc(33,ue,3,3,"span",0),e.YNc(34,he,3,3,"span",0),e.YNc(35,ge,3,3,"span",0),e.YNc(36,me,3,3,"span",0),e.YNc(37,fe,2,1,"span",11),e.qZA(),e.YNc(38,Te,3,3,"div",7),e.YNc(39,Ce,2,1,"div",8),e.YNc(40,Ee,3,3,"div",7),e.YNc(41,xe,2,1,"div",8),e.YNc(42,ve,3,3,"div",7),e.YNc(43,Oe,2,1,"div",8),e.YNc(44,Ae,3,3,"div",7),e.YNc(45,Se,3,3,"div",8),e.YNc(46,Me,3,3,"div",8),e.YNc(47,Ie,5,4,"div",0),e.YNc(48,Pe,3,3,"div",7),e.YNc(49,De,4,2,"div",12),e.ALo(50,"async"),e.YNc(51,We,6,3,"div",0),e.qZA()(),e.BQk()}if(2&i){const t=e.oxw();let o;e.xp6(1),e.Q6J("src",e.lcZ(2,36,e.xi3(3,38,t._node,t.isAnimated()?e.DdM(49,Ye):e.DdM(50,Fe))),e.LSH),e.xp6(4),e.Q6J("ngIf",t.canEdit()),e.xp6(3),e.Oqu(e.lcZ(9,41,"NODE.cm:name")),e.xp6(3),e.Oqu(t.data.name),e.xp6(1),e.Q6J("ngIf",t.data.title),e.xp6(1),e.Q6J("ngIf",t.data.title),e.xp6(1),e.Q6J("ngIf",t.data.keywords),e.xp6(1),e.Q6J("ngIf",t.data.keywords),e.xp6(1),e.Q6J("ngIf",t.data.description),e.xp6(1),e.Q6J("ngIf",t.data.description),e.xp6(1),e.Q6J("ngIf",t.data.author_freetext),e.xp6(1),e.Q6J("ngIf",t.data.author_freetext),e.xp6(1),e.Q6J("ngIf",t.data.author),e.xp6(1),e.Q6J("ngIf",t.data.author),e.xp6(2),e.Oqu(e.lcZ(24,43,"NODE.cm:creator")),e.xp6(3),e.Oqu(t.data.creator),e.xp6(2),e.Oqu(t.data.createDate),e.xp6(2),e.Oqu(e.lcZ(31,45,"NODE.mimetype")),e.xp6(3),e.Q6J("ngIf",t.data.mediatype&&!t.data.isDirectory),e.xp6(1),e.Q6J("ngIf",!t.data.mediatype),e.xp6(1),e.Q6J("ngIf",t.data.isDirectory&&!t.data.isCollection),e.xp6(1),e.Q6J("ngIf",t.data.isCollection),e.xp6(1),e.Q6J("ngIf",t.data.mimetype&&t.data.mediatype!=t.data.mimetype&&!t.data.isDirectory),e.xp6(1),e.Q6J("ngIf",t.data.exifDate),e.xp6(1),e.Q6J("ngIf",t.data.exifDate),e.xp6(1),e.Q6J("ngIf",t.data.dimensions),e.xp6(1),e.Q6J("ngIf",t.data.dimensions),e.xp6(1),e.Q6J("ngIf",t.data.duration),e.xp6(1),e.Q6J("ngIf",t.data.duration),e.xp6(1),e.Q6J("ngIf",!t.data.isDirectory),e.xp6(1),e.Q6J("ngIf",!t.data.isDirectory&&t.data.size),e.xp6(1),e.Q6J("ngIf",!t.data.isDirectory&&!t.data.size),e.xp6(1),e.Q6J("ngIf",t.permissions),e.xp6(1),e.Q6J("ngIf",t.data.license),e.xp6(1),e.Q6J("ngIf",e.lcZ(50,47,t.data.license)),e.xp6(2),e.Q6J("ngIf",null==(o=t.connector.getCurrentLogin())?null:o.isAdmin)}}let He=(()=>{class i{set node(t){this.load(t)}load(t){var o=this;return(0,h.Z)(function*(){o._node=t,o.data=yield o.format(t),o.nodeApi.getNodePermissions(t.ref.id).subscribe(n=>{o.permissions=o.formatPermissions(n)})})()}format(t){const o={};o.name=t.name,o.title=t.title,o.isDirectory=t.isDirectory,o.isCollection=null!=t.collection,o.description=t.properties[a.u6.LOM_PROP_GENERAL_DESCRIPTION],o.preview=t.preview.url,o.keywords=t.properties[a.u6.LOM_PROP_GENERAL_KEYWORD],o.keywords&&1===o.keywords.length&&!o.keywords[0]&&(o.keywords=null),o.creator=a.qp.getPersonWithConfigDisplayName(t.createdBy,this.configService),o.createDate=new c.ik(this.translate).transform(t.createdAt),o.duration=c.T.getDurationFormatted(t.properties[a.u6.LOM_PROP_TECHNICAL_DURATION]),o.author=this.toVCards(t.properties[a.u6.CCM_PROP_LIFECYCLECONTRIBUTER_AUTHOR]).join(", "),o.author_freetext=t.properties[a.u6.CCM_PROP_AUTHOR_FREETEXT]?t.properties[a.u6.CCM_PROP_AUTHOR_FREETEXT][0]:null,o.mediatype="file"===t.mediatype?t.mimetype:t.mediatype,o.mimetype=t.mimetype,o.size=t.size,t.properties[a.u6.EXIF_PROP_DATE_TIME_ORIGINAL]&&(o.exifDate=new c.ik(this.translate).transform(t.properties[a.u6.EXIF_PROP_DATE_TIME_ORIGINAL][0])),o.dimensions=(new c.iG).transform(t),o.license=this.nodeHelper.getLicenseIcon(t),o.licenseName=this.nodeHelper.getLicenseName(t),o.properties=[],o.aspects=t.aspects.sort();for(const n of Object.keys(t.properties).sort())o.properties.push([n,t.properties[n].join(", ")]);return o}constructor(t,o,n,r,p){this.connector=t,this.nodeApi=o,this.translate=n,this.configService=r,this.nodeHelper=p,this.onEditMetadata=new e.vpe,this.onDisplay=new e.vpe}isAnimated(){return this.nodeHelper.hasAnimatedPreview(this._node)}formatPermissions(t){const o=this.connector.getCurrentLogin()?.authorityName,n={users:[],groups:[]};if(!t.permissions)return n;for(const r of t.permissions.inheritedPermissions)r.authority.authorityName===o||r.authority.authorityType===a.u6.AUTHORITY_TYPE_OWNER||(r.authority.authorityType===a.u6.AUTHORITY_TYPE_USER?n.users.push(r):n.groups.push(r));for(const r of t.permissions.localPermissions.permissions)r.authority.authorityName===o||r.authority.authorityType===a.u6.AUTHORITY_TYPE_OWNER||(r.authority.authorityType===a.u6.AUTHORITY_TYPE_USER?this.containsPermission(n.groups,r)||n.users.push(r):this.containsPermission(n.groups,r)||n.groups.push(r));return n}toVCards(t){const o=[];if(t)for(const n of t)o.push(new c._W(n).getDisplayName());return o}containsPermission(t,o){for(const n of t)if(n.authority.authorityName==o.authority.authorityName)return!0;return!1}canEdit(){return this._node&&-1!==this._node.access.indexOf(a.u6.ACCESS_WRITE)}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(a.xD),e.Y36(a.xE),e.Y36(g.sK),e.Y36(A.E4),e.Y36(R.G))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["es-workspace-metadata-block"]],inputs:{node:"node"},outputs:{onEditMetadata:"onEditMetadata",onDisplay:"onDisplay"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"preview","clickable",3,"src","click"],[1,"metadata-container"],["mat-icon-button","","class","edit",3,"click",4,"ngIf"],[1,"metadata"],[1,"description"],[1,"value"],["class","description",4,"ngIf"],["class","value",4,"ngIf"],["class","value descriptionValue",4,"ngIf"],["class","value valueFreetext",4,"ngIf"],["class","mimetype",4,"ngIf"],["class","value license-value",4,"ngIf"],["mat-icon-button","",1,"edit",3,"click"],[1,"material-icons"],["class","badge",4,"ngFor","ngForOf"],[1,"badge"],[1,"text"],[1,"value","descriptionValue"],[1,"value","valueFreetext"],[1,"mimetype"],[4,"ngFor","ngForOf"],[1,"value","license-value"],[1,"license",3,"src"],[1,"licenseName"],["class","aspect",4,"ngFor","ngForOf"],[1,"aspect"]],template:function(o,n){1&o&&e.YNc(0,Ue,52,51,"ng-container",0),2&o&&e.Q6J("ngIf",n.data)},dependencies:[u.sg,u.O5,c.ar,N.RK,u.Ov,g.X$,c.WF,c.PW,ee.B],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.metadata-container[_ngcontent-%COMP%]{overflow-wrap:anywhere}.metadata[_ngcontent-%COMP%]{flex-grow:1;min-width:0}.description[_ngcontent-%COMP%]{color:#383838;font-size:90%;text-transform:uppercase;font-weight:700}.descriptionValue[_ngcontent-%COMP%]{white-space:pre-wrap}.edit[_ngcontent-%COMP%]{color:var(--textLight);float:right;position:relative}.value[_ngcontent-%COMP%]{padding-top:0;padding-bottom:20px}.aspect[_ngcontent-%COMP%]:not(:last-child){padding-bottom:4px}.valueFreetext[_ngcontent-%COMP%]{white-space:pre-line}.preview[_ngcontent-%COMP%]{width:calc(100% + 24px);margin-left:-12px;margin-bottom:12px;height:200px;position:relative;object-fit:cover}.license-value[_ngcontent-%COMP%]   img.license[_ngcontent-%COMP%]{height:30px;margin-top:5px}"]})}return i})();var Qe=l(94194);const Je=["canvas"];function qe(i,s){1&i&&e._UZ(0,"es-spinner")}function Ke(i,s){1&i&&e._UZ(0,"i",15),2&i&&e.Q6J("aria",!0)}function Ge(i,s){1&i&&e.Hsn(0,0,["*ngTemplateOutlet","infoTab"])}function je(i,s){if(1&i&&(e._UZ(0,"i",16),e._uU(1)),2&i){const t=e.oxw(4);e.xp6(1),e.hij(" ",t.statsTotalPoints," ")}}function Be(i,s){1&i&&e.Hsn(0,1,["*ngTemplateOutlet","usageTab"])}function Ve(i,s){1&i&&e._UZ(0,"i",17)}function Xe(i,s){1&i&&e.Hsn(0,2,["*ngTemplateOutlet","versionsTab"])}function $e(i,s){if(1&i&&(e.TgZ(0,"mat-tab-group")(1,"mat-tab"),e.YNc(2,Ke,1,1,"ng-template",13),e.YNc(3,Ge,1,0,"ng-content",14),e.qZA(),e.TgZ(4,"mat-tab"),e.YNc(5,je,2,1,"ng-template",13),e.YNc(6,Be,1,0,"ng-content",14),e.qZA(),e.TgZ(7,"mat-tab"),e.YNc(8,Ve,1,0,"ng-template",13),e.YNc(9,Xe,1,0,"ng-content",14),e.qZA()()),2&i){e.oxw();const t=e.MAs(5),o=e.MAs(7),n=e.MAs(9);e.xp6(3),e.Q6J("ngTemplateOutlet",t),e.xp6(3),e.Q6J("ngTemplateOutlet",o),e.xp6(3),e.Q6J("ngTemplateOutlet",n)}}function ze(i,s){1&i&&e.Hsn(0,3,["*ngTemplateOutlet","infoTab"])}function et(i,s){if(1&i&&(e.TgZ(0,"div",18),e.YNc(1,ze,1,0,"ng-content",14),e.qZA()),2&i){e.oxw();const t=e.MAs(5);e.xp6(1),e.Q6J("ngTemplateOutlet",t)}}function tt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"es-workspace-metadata-block",19),e.NdJ("onDisplay",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.display())})("onEditMetadata",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.edit())}),e.qZA()}if(2&i){const t=e.oxw(3);e.Q6J("node",t.nodeObject)}}function ot(i,s){if(1&i&&(e.TgZ(0,"li",32)(1,"i",6),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&i){const t=s.$implicit,o=s.index,n=e.oxw(4);e.xp6(2),e.Oqu(n.stats.pointsIcons[o]),e.xp6(1),e.hij(" ",t," ")}}const Y=function(i){return{count:i}};function nt(i,s){if(1&i&&(e.TgZ(0,"p",33),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"async"),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.hij(" ",e.xi3(2,1,"WORKSPACE.METADATA.COLLECTIONS",e.VKq(6,Y,e.lcZ(3,4,t.usagesCollectionData).length))," ")}}function it(i,s){if(1&i&&e._UZ(0,"es-node-entries-wrapper",34),2&i){const t=e.oxw(4);e.Q6J("dataSource",t.usagesCollection)("columns",t.columnsCollections)("displayType",t.NodeEntriesDisplayType.SmallGrid)("elementInteractionType",t.InteractionType.DefaultActionLink)}}function st(i,s){1&i&&(e.TgZ(0,"div",35),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"WORKSPACE.METADATA.FORKED_PARENT")," "))}function rt(i,s){if(1&i&&e._UZ(0,"es-node-entries-wrapper",36),2&i){const t=e.oxw(4);e.Q6J("dataSource",t.staticDataSource(t.forkedParent))("columns",t.columns)("checkbox",!1)("displayType",t.NodeEntriesDisplayType.Table)("elementInteractionType",t.InteractionType.DefaultActionLink)}}function at(i,s){if(1&i&&(e.TgZ(0,"div",35),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.hij(" ",e.xi3(2,1,"WORKSPACE.METADATA.FORKED_CHILDS",e.VKq(4,Y,t.forkedChildren.getData().length))," ")}}function ct(i,s){if(1&i&&e._UZ(0,"es-node-entries-wrapper",36),2&i){const t=e.oxw(4);e.Q6J("dataSource",t.forkedChildren)("columns",t.columns)("checkbox",!1)("displayType",t.NodeEntriesDisplayType.Table)("elementInteractionType",t.InteractionType.DefaultActionLink)}}function lt(i,s){if(1&i&&(e.TgZ(0,"div",20)(1,"p",21),e._uU(2),e.ALo(3,"translate"),e.qZA(),e._UZ(4,"canvas",22,23),e.TgZ(6,"ul",24),e.YNc(7,ot,4,2,"li",25),e.qZA(),e.TgZ(8,"p",26),e._uU(9),e.ALo(10,"translate"),e.TgZ(11,"span",27),e._uU(12),e.qZA()(),e.YNc(13,nt,4,8,"p",28),e.YNc(14,it,1,4,"es-node-entries-wrapper",29),e.YNc(15,st,3,3,"div",30),e.YNc(16,rt,1,5,"es-node-entries-wrapper",31),e.YNc(17,at,3,6,"div",30),e.YNc(18,ct,1,5,"es-node-entries-wrapper",31),e.qZA()),2&i){const t=e.oxw(3);e.xp6(2),e.Oqu(e.lcZ(3,10,"WORKSPACE.METADATA.USAGE_COUNT_TITLE")),e.xp6(5),e.Q6J("ngForOf",t.stats.points),e.xp6(2),e.hij(" ",e.lcZ(10,12,"WORKSPACE.METADATA.USAGE_COUNT")," "),e.xp6(3),e.Oqu(t.statsTotalPoints),e.xp6(1),e.Q6J("ngIf",!t.usagesCollection.isEmpty()),e.xp6(1),e.Q6J("ngIf",!t.usagesCollection.isEmpty()),e.xp6(1),e.Q6J("ngIf",t.forkedParent),e.xp6(1),e.Q6J("ngIf",t.forkedParent),e.xp6(1),e.Q6J("ngIf",!t.forkedChildren.isEmpty()),e.xp6(1),e.Q6J("ngIf",!t.forkedChildren.isEmpty())}}function pt(i,s){1&i&&(e.TgZ(0,"div",40),e._UZ(1,"es-spinner"),e.qZA())}function _t(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"WORKSPACE.METADATA.CURRENT_VERSION")))}function dt(i,s){1&i&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"WORKSPACE.METADATA.VERSION")))}function ut(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",50),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,r=e.oxw(4);return e.KtG(r.restoreVersion(n))}),e._UZ(1,"i",48),e._uU(2),e.ALo(3,"translate"),e.qZA()}if(2&i){const t=e.oxw(5);e.ekj("disabled",!t.canRevert()),e.xp6(1),e.Q6J("esIcon","restore"),e.xp6(1),e.hij(" ",e.lcZ(3,4,"WORKSPACE.METADATA.RESTORE")," ")}}function ht(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",41)(1,"div",42),e.YNc(2,_t,3,3,"span",7),e.YNc(3,dt,3,3,"span",7),e._uU(4),e.qZA(),e.TgZ(5,"div",43),e._uU(6),e.qZA(),e.TgZ(7,"div",44),e._uU(8),e.ALo(9,"formatDate"),e.qZA(),e.TgZ(10,"div",45),e._uU(11),e.ALo(12,"versionComment"),e.qZA(),e.TgZ(13,"div",46)(14,"button",47),e.NdJ("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(4);return e.KtG(p.displayVersion(r))}),e._UZ(15,"i",48),e._uU(16),e.ALo(17,"translate"),e.qZA(),e.YNc(18,ut,4,6,"button",49),e.qZA()()}if(2&i){const t=s.$implicit,o=e.oxw(4);e.ekj("versionMain",o.isCurrentVersion(t)),e.xp6(2),e.Q6J("ngIf",o.isCurrentVersion(t)),e.xp6(1),e.Q6J("ngIf",!o.isCurrentVersion(t)),e.xp6(1),e.AsE(" (",t.version.major,".",t.version.minor,") "),e.xp6(2),e.AsE(" ",t.modifiedBy.firstName," ",t.modifiedBy.lastName," "),e.xp6(2),e.Oqu(e.lcZ(9,13,t.modifiedAt)),e.xp6(3),e.Oqu(e.lcZ(12,15,t)),e.xp6(4),e.Q6J("esIcon","remove_red_eye"),e.xp6(1),e.hij(" ",e.lcZ(17,17,"WORKSPACE.METADATA.VIEW_VERSION")," "),e.xp6(2),e.Q6J("ngIf",!o.isCurrentVersion(t))}}function gt(i,s){if(1&i&&(e.TgZ(0,"div",37),e.YNc(1,pt,2,0,"div",38),e.YNc(2,ht,19,19,"div",39),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.versionsLoading),e.xp6(1),e.Q6J("ngForOf",t.versions)}}function mt(i,s){if(1&i&&(e.ynx(0),e.YNc(1,$e,10,3,"mat-tab-group",8),e.YNc(2,et,2,1,"ng-template",null,9,e.W1O),e.YNc(4,tt,1,1,"ng-template",null,10,e.W1O),e.YNc(6,lt,19,14,"ng-template",null,11,e.W1O),e.YNc(8,gt,3,2,"ng-template",null,12,e.W1O),e.BQk()),2&i){const t=e.MAs(3),o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!o.data.isDirectory)("ngIfElse",t)}}function ft(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._uU(3),e.qZA(),e.TgZ(4,"div",4)(5,"button",5),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.close())}),e.TgZ(6,"i",6),e._uU(7,"close"),e.qZA()()()(),e.YNc(8,qe,1,0,"es-spinner",7),e.YNc(9,mt,10,2,"ng-container",7),e.qZA()}if(2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.data.name),e.xp6(5),e.Q6J("ngIf",t.loading),e.xp6(1),e.Q6J("ngIf",!t.loading)}}const F=["*","*","*","*"];m.kL.register(m.vn,m.ZL,m.uw,m.od,m.u,m.f$,m.Dx);let Tt=(()=>{class i{get canvas(){return this._canvas}set canvas(t){this._canvas=t,this.drawBarChart()}set node(t){this.nodeSubject.next(t)}constructor(t,o,n,r,p,d,_,C,x){this.translate=t,this.config=o,this.nodeHelper=n,this.router=r,this.iamApi=p,this.nodeApi=d,this.nodeService=_,this.searchApi=C,this.usageApi=x,this.onEditMetadata=new e.vpe,this.onDownload=new e.vpe,this.onDisplay=new e.vpe,this.onClose=new e.vpe,this.onRestore=new e.vpe,this.NodeEntriesDisplayType=c.P8,this.InteractionType=c.s_,this.INFO="INFO",this.PROPERTIES="PROPERTIES",this.VERSIONS="VERSIONS",this.loading=!0,this.usagesCollection=new c.AL,this.usagesCollectionData=this.usagesCollection.connect(),this.versionsLoading=!1,this.columns=[],this.columnsCollections=[],this.forkedChildren=new c.AL,this.stats={labels:[],points:[],pointsIcons:["input","layers","cloud_download","remove_red_eye"],colors:["rgba(230, 178, 71, .8)","rgba(151, 91, 93, .8)","rgba(27, 102, 49, .8)","rgba(102,167,217,.8)"]},this.nodeSubject=new v.X(null),this.columns.push(new c.HC("NODE",a.u6.CM_NAME)),this.columnsCollections.push(new c.HC("COLLECTION","title")),this.columnsCollections.push(new c.HC("COLLECTION","info")),this.columnsCollections.push(new c.HC("COLLECTION","scope"))}ngOnInit(){this.nodeSubject.pipe((0,$.h)(t=>null!==t),(0,z.x)()).subscribe(t=>this.load(t))}load(t){var o=this;return(0,h.Z)(function*(){o.versions=null,o.versionsLoading=!0,o.resetStats(),o.loading=!0,o.data=o.format(t),o.nodeObject=(yield o.nodeApi.getNodeMetadata(t.ref.id,[a.u6.ALL]).toPromise()).node,o.loading=!1,o.data=o.format(o.nodeObject);const n=o.nodeObject;o.nodeService.getVersionsMetadata(o.nodeObject.ref.repo,o.nodeObject.ref.id).subscribe(p=>{if(n!==o.nodeObject)return;o.versions=p.versions.reverse();for(const _ of o.versions)if(_.comment&&(_.comment===a.u6.COMMENT_MAIN_FILE_UPLOAD||_.comment===a.u6.COMMENT_METADATA_UPDATE||_.comment===a.u6.COMMENT_CONTRIBUTOR_UPDATE||_.comment===a.u6.COMMENT_CONTENT_UPDATE||_.comment===a.u6.COMMENT_LICENSE_UPDATE||_.comment===a.u6.COMMENT_NODE_PUBLISHED||_.comment===a.u6.COMMENT_PREVIEW_CHANGED||_.comment.startsWith(a.u6.COMMENT_EDITOR_UPLOAD))){const C=_.comment.split(",");let x="";C.length>1&&(x=o.translate.instant("CONNECTOR."+C[1]+".NAME")),_.comment=o.translate.instant("WORKSPACE.METADATA.COMMENT."+C[0],{editor:x})}let d=0;for(const _ of o.versions){if(o.isCurrentVersion(_)){o.versions.splice(d,1),o.versions.splice(0,0,_);break}d++}o.versionsLoading=!1}),o.iamApi.getUser().subscribe(p=>{o.nodeApi.getNodePermissions(o.nodeObject.ref.id).subscribe(d=>{o.permissions=o.formatPermissions(p,d)})}),o.usages=null,o.forkedParent=null,o.forkedChildren.reset(),o.nodeObject.properties[a.u6.CCM_PROP_FORKED_ORIGIN]&&o.nodeApi.getNodeMetadata(a.bv.removeSpacesStoreRef(o.nodeObject.properties[a.u6.CCM_PROP_FORKED_ORIGIN][0]),[a.u6.ALL]).subscribe(p=>{o.forkedParent=p.node},p=>{}),o.nodeService.getForkedChilds(t).subscribe(p=>{o.forkedChildren.setData(p.nodes)}),o.usageApi.getNodeUsages(o.nodeObject.ref.id).subscribe(p=>{o.usages=p.usages,o.usageApi.getNodeUsagesCollection(o.nodeObject.ref.id).subscribe(d=>{o.usagesCollection.setData(d.filter(_=>"ACTIVE"===_.collectionUsageType).map(_=>_.collection)),o.getStats()})})})()}isCurrentVersion(t){if(!this.nodeObject)return!1;const o=this.nodeObject.properties[a.u6.LOM_PROP_LIFECYCLE_VERSION];return!!o&&o[0]==t.version.major+"."+t.version.minor}display(t=null){this.nodeObject.version=t,this.onDisplay.emit(this.nodeObject)}displayNode(t){this.router.navigate([c.ru.ROUTER_PREFIX+"render",t.ref.id])}displayCollection(t){O.d.goToCollection(this.router,t)}openPermalink(){this.displayNode(this.nodeObject)}displayVersion(t){this.isCurrentVersion(t)?this.display():this.display(t.version.major+"."+t.version.minor)}format(t){const o={};o.name=t.name,o.title=t.title,o.isDirectory=t.isDirectory,o.isCollection=null!=t.collection,o.description=t.properties[a.u6.LOM_PROP_GENERAL_DESCRIPTION],o.preview=t.preview.url,o.keywords=t.properties[a.u6.LOM_PROP_GENERAL_KEYWORD],o.keywords&&1==o.keywords.length&&!o.keywords[0]&&(o.keywords=null),o.creator=a.qp.getPersonWithConfigDisplayName(t.createdBy,this.config),o.createDate=new c.ik(this.translate).transform(t.createdAt),o.duration=c.T.getDurationFormatted(t.properties[a.u6.LOM_PROP_TECHNICAL_DURATION]?.[0]),o.author=this.toVCards(t.properties[a.u6.CCM_PROP_LIFECYCLECONTRIBUTER_AUTHOR]).join(", "),o.author_freetext=t.properties[a.u6.CCM_PROP_AUTHOR_FREETEXT]?t.properties[a.u6.CCM_PROP_AUTHOR_FREETEXT][0]:null,o.mediatype="file"==t.mediatype?t.mimetype:t.mediatype,o.mimetype=t.mimetype,o.size=t.size,t.properties[a.u6.EXIF_PROP_DATE_TIME_ORIGINAL]&&(o.exifDate=new c.ik(this.translate).transform(t.properties[a.u6.EXIF_PROP_DATE_TIME_ORIGINAL][0])),o.dimensions=(new c.iG).transform(t),o.license=this.nodeHelper.getLicenseIcon(t),o.licenseName=this.nodeHelper.getLicenseName(t),o.properties=[],o.aspects=t.aspects.sort();for(const n of Object.keys(t.properties).sort())o.properties.push([n,t.properties[n].join(", ")]);return o}close(){this.onClose.emit()}edit(){this.onEditMetadata.emit(this.nodeObject)}restoreVersion(t){this.onRestore.emit({version:t,node:this.nodeObject})}canRevert(){return this.nodeObject&&-1!=this.nodeObject.access.indexOf(a.u6.ACCESS_WRITE)}isAnimated(){return this.nodeHelper.hasAnimatedPreview(this.nodeObject)}formatPermissions(t,o){const n={users:[],groups:[]};if(!o.permissions)return n;for(const r of o.permissions.inheritedPermissions)r.authority.authorityName==t.person.authorityName||r.authority.authorityType==a.u6.AUTHORITY_TYPE_OWNER||(r.authority.authorityType==a.u6.AUTHORITY_TYPE_USER?n.users.push(r):n.groups.push(r));for(const r of o.permissions.localPermissions.permissions)r.authority.authorityName==t.person.authorityName||r.authority.authorityType==a.u6.AUTHORITY_TYPE_OWNER||(r.authority.authorityType==a.u6.AUTHORITY_TYPE_USER?this.containsPermission(n.groups,r)||n.users.push(r):this.containsPermission(n.groups,r)||n.groups.push(r));return n}toVCards(t){const o=[];if(t)for(const n of t)o.push(new c._W(n).getDisplayName());return o}containsPermission(t,o){for(const n of t)if(n.authority.authorityName==o.authority.authorityName)return!0;return!1}resetStats(){this.stats.labels=[],this.stats.points=[],this.statsTotalPoints=null}getStats(){this.resetStats(),this.stats.labels.push(this.translate.instant("WORKSPACE.METADATA.USAGE_TYPE.LMS")),this.stats.labels.push(this.translate.instant("WORKSPACE.METADATA.USAGE_TYPE.COLLECTION")),this.stats.labels.push(this.translate.instant("WORKSPACE.METADATA.USAGE_TYPE.DOWNLOAD")),this.stats.labels.push(this.translate.instant("WORKSPACE.METADATA.USAGE_TYPE.VIEW")),this.stats.points.push(this.usages.length-this.usagesCollection.getData().length),this.stats.points.push(this.usagesCollection.getData().length),this.stats.points.push(U(this.nodeObject.properties[a.u6.CCM_PROP_TRACKING_DOWNLOADS])),this.stats.points.push(U(this.nodeObject.properties[a.u6.CCM_PROP_TRACKING_VIEWS])),this.statsTotalPoints=this.stats.points.reduce((t,o)=>t+o),this.drawBarChart()}drawBarChart(){const t=this.canvas?.nativeElement;if(!t)return;const o=t.getContext("2d"),n=Math.max(...this.stats.points);this.stats.labels?.length&&(this.currentChart&&this.currentChart.destroy(),console.log(this.stats),this.currentChart=new m.kL(o,{type:"bar",data:{labels:this.stats.labels,datasets:[{data:this.stats.points,backgroundColor:this.stats.colors,borderWidth:.2}]},options:{indexAxis:"x",plugins:{legend:{display:!1},tooltip:{}},responsive:!1,layout:{padding:{left:0,right:0,top:20,bottom:0}},scales:{x:{ticks:{display:!1}},y:{type:"linear",beginAtZero:!0,max:Math.max(Math.round(1.25*n),6)}}}}))}canEdit(){return this.nodeObject&&-1!==this.nodeObject.access.indexOf(a.u6.ACCESS_WRITE)}staticDataSource(t){return new c.AL([t])}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(g.sK),e.Y36(A.E4),e.Y36(R.G),e.Y36(E.F0),e.Y36(a.Du),e.Y36(a.xE),e.Y36(A.sX),e.Y36(a.Y6),e.Y36(a.kD))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["es-workspace-metadata"]],viewQuery:function(o,n){if(1&o&&e.Gf(Je,5),2&o){let r;e.iGM(r=e.CRH())&&(n.canvas=r.first)}},inputs:{isAdmin:"isAdmin",node:"node"},outputs:{onEditMetadata:"onEditMetadata",onDownload:"onDownload",onDisplay:"onDisplay",onClose:"onClose",onRestore:"onRestore"},ngContentSelectors:F,decls:1,vars:1,consts:[["class","main","data-test","workspace-sidebar",4,"ngIf"],["data-test","workspace-sidebar",1,"main"],[1,"header"],["data-test","workspace-sidebar-element-name",1,"name"],[1,"close"],["mat-icon-button","",3,"click"],[1,"material-icons"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["standaloneInfoTab",""],["infoTab",""],["usageTab",""],["versionsTab",""],["mat-tab-label",""],[4,"ngTemplateOutlet"],["esIcon","info_outline",3,"aria"],["esIcon","equalizer"],["esIcon","restore"],[1,"standalone-container"],[1,"content",3,"node","onDisplay","onEditMetadata"],[1,"content","content-properties"],[1,"description"],["width","320","height","200"],["canvas",""],[1,"statistic-value"],["class","point",4,"ngFor","ngForOf"],[1,"description","usage-count"],[1,"usage-counter"],["class","description collections",4,"ngIf"],[3,"dataSource","columns","displayType","elementInteractionType",4,"ngIf"],["class","description forkedParend",4,"ngIf"],[3,"dataSource","columns","checkbox","displayType","elementInteractionType",4,"ngIf"],[1,"point"],[1,"description","collections"],[3,"dataSource","columns","displayType","elementInteractionType"],[1,"description","forkedParend"],[3,"dataSource","columns","checkbox","displayType","elementInteractionType"],[1,"content","content-versions"],["class","center",4,"ngIf"],["class","version",3,"versionMain",4,"ngFor","ngForOf"],[1,"center"],[1,"version"],[1,"versionTitle"],[1,"versionAuthor"],[1,"versionDate"],[1,"versionComment"],[1,"button-actions"],["mat-flat-button","","color","primary",3,"click"],[3,"esIcon"],["mat-flat-button","","color","warn",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn",3,"click"]],template:function(o,n){1&o&&(e.F$t(F),e.YNc(0,ft,10,3,"div",0)),2&o&&e.Q6J("ngIf",n.data)},dependencies:[u.sg,u.O5,u.tP,c.ar,c.OR,c.cE,N.lW,N.RK,w.uD,w.uX,w.SP,He,u.Ov,g.X$,c.ik,Qe.E],styles:["[_nghost-%COMP%]{display:flex}[_nghost-%COMP%]     mat-header-row{display:none}.main[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}.main[_ngcontent-%COMP%] > es-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-top:30%}.mimetype[_ngcontent-%COMP%]{word-break:break-all;padding-left:5px}.header[_ngcontent-%COMP%]{display:flex;background-color:#f7f7f7;align-items:center}.header[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{flex-grow:1;font-size:110%;padding:10px 15px;word-break:break-all}mat-tab-group[_ngcontent-%COMP%]{min-height:0}mat-tab-group[_ngcontent-%COMP%]     mat-tab-header{background-color:#f7f7f7}.standalone-container[_ngcontent-%COMP%]{overflow-y:auto;overflow-x:hidden}.versionTitle[_ngcontent-%COMP%]{font-weight:700}.versionComment[_ngcontent-%COMP%]{font-style:italic;padding-bottom:10px}.versionAuthor[_ngcontent-%COMP%]{line-height:1.25}.versionDate[_ngcontent-%COMP%]{color:var(--textLight)}.button-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.content[_ngcontent-%COMP%]{padding:0 12px}.content-properties[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px 12px}.content-versions[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:20px 12px;gap:20px}p.description[_ngcontent-%COMP%]{margin-top:0;margin-bottom:12px}canvas[_ngcontent-%COMP%]{align-self:flex-start}.statistic-value[_ngcontent-%COMP%]{display:grid;width:100%;padding:0 3px 0 25px;grid-template-columns:1fr 1fr 1fr 1fr}.statistic-value[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;float:left;text-align:center;color:#383838;font-weight:700;font-size:26px}.statistic-value[_ngcontent-%COMP%]   .point[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--textLight);font-size:20px}.usage-counter[_ngcontent-%COMP%]{font-weight:700}.license-value[_ngcontent-%COMP%]{padding-top:4px;display:flex}.license-value[_ngcontent-%COMP%]   .license[_ngcontent-%COMP%]{padding-right:6px;height:21px}"]})}return i})();function U(i){return i?.length>0?parseInt(i[0]):0}function Ct(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"es-workspace-metadata",1),e.NdJ("onRestore",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.restoreVersion(n))})("onDisplay",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.goToNode(n))})("onEditMetadata",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.openMdsEditor([n]))})("onClose",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.closeSidebar())}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("@fromRight",t.nodeSidebar)("node",t.nodeSidebar)}}let Et=(()=>{class i{get nodeSidebar(){return this.workspace.nodeSidebar}constructor(t,o,n,r,p,d){this.dialogs=t,this.localEvents=o,this.node=n,this.router=r,this.toast=p,this.workspace=d}handleKeyboardEvent(t){if("Escape"===t.key&&null!=this.workspace.nodeSidebar)return this.closeSidebar(),t.preventDefault(),void t.stopPropagation()}restoreVersion(t){var o=this;return(0,h.Z)(function*(){(yield o.dialogs.openGenericDialog({title:"WORKSPACE.METADATA.RESTORE_TITLE",message:"WORKSPACE.METADATA.RESTORE_MESSAGE",buttons:k.G2,nodes:[t.node]})).afterClosed().subscribe(r=>{"YES"===r&&o.doRestoreVersion(t.version)})})()}doRestoreVersion(t){this.toast.showProgressSpinner(),this.node.revertNodeToVersion(t.version.node.id,t.version.major,t.version.minor).subscribe(o=>{this.toast.closeProgressSpinner(),this.closeSidebar(),this.node.getNodeMetadata(t.version.node.id,[a.u6.ALL]).subscribe(n=>{this.localEvents.nodesChanged.emit([n.node]),this.workspace.nodeSidebar=n.node,this.workspace.nodeSidebarChange.emit(n.node),this.toast.toast("WORKSPACE.REVERTED_VERSION")},n=>this.toast.error(n))},o=>this.toast.error(o))}closeSidebar(){this.workspace.nodeSidebar=null,this.workspace.nodeSidebarChange.emit(null)}goToNode(t){this.router.navigate(t.version?[c.ru.ROUTER_PREFIX+"render",t.ref.id,t.version]:[c.ru.ROUTER_PREFIX+"render",t.ref.id])}openMdsEditor(t){var o=this;return(0,h.Z)(function*(){(yield o.dialogs.openMdsEditorDialogForNodes({nodes:t,bulkBehavior:X.B1.Default})).afterClosed().subscribe(r=>o.closeMdsEditor(t,r))})()}closeMdsEditor(t,o=null){let n=!!o;this.workspace.nodeSidebar&&this.workspace.nodeSidebar.ref.id===t[0]?.ref.id&&o&&(this.workspace.nodeSidebar=o[0]),n&&this.localEvents.nodesChanged.emit(o)}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(y.H),e.Y36(c.Xn),e.Y36(a.xE),e.Y36(E.F0),e.Y36(b.F),e.Y36(W.A))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["es-metadata-sidebar"]],hostBindings:function(o,n){1&o&&e.NdJ("keydown",function(p){return n.handleKeyboardEvent(p)},!1,e.evT)},decls:1,vars:1,consts:[["class","metadata-sidebar",3,"node","onRestore","onDisplay","onEditMetadata","onClose",4,"ngIf"],[1,"metadata-sidebar",3,"node","onRestore","onDisplay","onEditMetadata","onClose"]],template:function(o,n){1&o&&e.YNc(0,Ct,1,2,"es-workspace-metadata",0),2&o&&e.Q6J("ngIf",n.nodeSidebar)},dependencies:[u.O5,Tt],styles:[".metadata-sidebar[_ngcontent-%COMP%]{min-width:350px;max-width:350px;position:fixed;-webkit-overflow-scrolling:touch;box-shadow:0 0 5px #0000004d;height:calc(100% - (var(--mainnavHeight) + 65px));top:calc(var(--mainnavHeight) + 65px);right:0;z-index:5;background-color:#fff}@media screen and (max-width: 900px){.metadata-sidebar[_ngcontent-%COMP%]{height:calc(100% - (var(--mainnavHeight) + 127px))}}"],data:{animation:[(0,f.X$)("fromRight",c.Le.fromRight())]}})}return i})();var I=l(72079),S=l(19352),P=l(53461),H=l(86381),M=l(56223),xt=l(75986);const vt=["list"],Ot=["confirmDeleteDialog"],At=["restoreDialog"];function St(i,s){1&i&&(e.TgZ(0,"h3",6),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RECYCLE.NO_RESULTS_MESSAGE")," "))}function Mt(i,s){1&i&&(e.TgZ(0,"h3",6),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"RECYCLE.ARCHIVE_EMPTY")," "))}function kt(i,s){if(1&i&&(e.YNc(0,St,3,3,"h3",5),e.YNc(1,Mt,3,3,"h3",5)),2&i){const t=e.oxw();e.Q6J("ngIf",!!t.searchQuery),e.xp6(1),e.Q6J("ngIf",!t.searchQuery)}}function Nt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"p"),e._uU(1),e.ALo(2,"translate"),e.qZA(),e.TgZ(3,"form")(4,"div",7)(5,"mat-checkbox",8),e.NdJ("ngModelChange",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.skipDeleteConfirmation=n)}),e._uU(6),e.ALo(7,"translate"),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,3,"RECYCLE.DELETE.CONFIRM_MESSAGE")),e.xp6(4),e.Q6J("ngModel",t.skipDeleteConfirmation),e.xp6(1),e.Oqu(e.lcZ(7,5,"RECYCLE.DELETE.NOT_ASK_AGAIN"))}}function yt(i,s){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"span",11),e._uU(3),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.hij("(",t.message,")")}}function bt(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,yt,4,2,"div",9),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf","DUPLICATENAME"===t.restoreStatus)}}function Rt(i,s){if(1&i&&(e.TgZ(0,"div")(1,"p"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,bt,2,1,"div",10),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(2),e.Oqu(e.lcZ(3,2,"RECYCLE.RESTORE.LIST_DUPLICATE_NAMES")),e.xp6(2),e.Q6J("ngForOf",t.results)}}function wt(i,s){1&i&&e._UZ(0,"hr")}function It(i,s){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.TgZ(2,"span",11),e._uU(3),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.hij("(",t.message,")")}}function Pt(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,It,4,2,"div",9),e.qZA()),2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf","FALLBACK_PARENT_NOT_EXISTS"===t.restoreStatus||"FALLBACK_PARENT_NO_PERMISSION"===t.restoreStatus)}}function Dt(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,wt,1,0,"hr",9),e.TgZ(2,"p"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,Pt,2,1,"div",10),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",t.hasDuplicateNames),e.xp6(2),e.Oqu(e.lcZ(4,3,"RECYCLE.RESTORE.LIST_PARENT_FOLDER_MISSING")),e.xp6(2),e.Q6J("ngForOf",t.results)}}function Lt(i,s){if(1&i&&(e.YNc(0,Rt,5,4,"div",9),e.YNc(1,Dt,6,5,"div",9)),2&i){const t=s.$implicit;e.Q6J("ngIf",t.hasDuplicateNames),e.xp6(1),e.Q6J("ngIf",t.hasParentFolderMissing)}}let Q=(()=>{class i{loadData(t,o,n,r){return this.archive.search(t||"*","",{propertyFilter:[a.u6.ALL],offset:o,sortBy:[n],sortAscending:r})}constructor(t,o,n,r,p,d){this.archive=t,this.toast=o,this.translate=n,this.service=r,this.searchField=p,this.dialogs=d,this.NodeEntriesDisplayType=c.P8,this.InteractionType=c.s_,this.Scope=c.sX,this.dataSource=new c.AL,this.columns=[new c.HC("NODE",a.u6.CM_NAME),new c.HC("NODE",a.u6.CM_ARCHIVED_DATE)],this.options={useDefaultOptions:!1,addOptions:[]},this.sort={columns:[new c.Sw("NODE",a.u6.CM_NAME),new c.Sw("NODE",a.u6.CM_ARCHIVED_DATE)],allowed:!0,active:a.u6.CM_ARCHIVED_DATE,direction:"desc"},this.skipDeleteConfirmation=!1,this.destroyed=new I.xQ}ngOnInit(){const t=new c.BA("RECYCLE.OPTION.RESTORE_SINGLE","undo",n=>this.restoreSingle(n));t.group=c.EM.Primary;const o=new c.BA("RECYCLE.OPTION.DELETE_SINGLE","delete",n=>this.deleteSingle(n));o.group=c.EM.Primary,this.options.addOptions.push(t),this.options.addOptions.push(o),this.options.addOptions.forEach(n=>{n.elementType=[c.Hd.Node,c.Hd.NodePublishedCopy]}),this.searchField.observeCurrentInstance().pipe((0,S.R)(this.destroyed)).subscribe(n=>n.onSearchTriggered().pipe((0,S.R)(this.destroyed)).subscribe(({searchString:r})=>{this.searchQuery=r,this.refresh()}))}ngAfterViewInit(){this.refresh(),this.list.initOptionsGenerator({actionbar:this.actionbar,customOptions:this.options})}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}openConfirmDeleteDialog(t){var o=this;return(0,h.Z)(function*(){o.skipDeleteConfirmation=!1,(yield o.dialogs.openGenericDialog({title:"RECYCLE.DELETE.CONFIRM_TITLE",buttons:k.OU,closable:P.IA.Standard,contentTemplate:o.confirmDeleteDialog,nodes:t})).afterClosed().subscribe(r=>{"YES_DELETE"===r&&(o.skipDeleteConfirmation&&o.service.set("recycleSkipDeleteConfirmation",!0),o.deleteNodesWithoutConfirmation(t))})})()}restoreFinished(t,o){this.toast.closeProgressSpinner(),this.prepareResults(o),(o.hasDuplicateNames||o.hasParentFolderMissing)&&this.openRestoreDialog(o),this.toast.toast(1==t.length?"RECYCLE.TOAST.RESTORE_FINISHED_SINGLE":"RECYCLE.TOAST.RESTORE_FINISHED"),this.refresh()}openRestoreDialog(t){this.dialogs.openGenericDialog({title:"RECYCLE.RESTORE.NEW_LOCATION_TITLE",subtitle:"RECYCLE.RESTORE.NEW_LOCATION_SUBTITLE",avatar:{kind:"icon",icon:"undo"},buttons:k.F$,closable:P.IA.Standard,contentTemplate:this.restoreDialog,context:{$implicit:t}})}delete(){this.deleteNodes(this.list.getSelection().selected)}deleteSingle(t){null!=t?this.deleteNodes([t]):this.delete()}deleteNodesWithoutConfirmation(t){this.toast.showProgressSpinner(),this.archive.delete(t).subscribe(()=>this.deleteFinished(),o=>this.handleErrors(o))}deleteFinished(){this.toast.closeProgressSpinner(),this.toast.toast("RECYCLE.TOAST.DELETE_FINISHED"),this.list.getSelection().clear(),this.refresh()}deleteNodes(t){this.service.get("recycleSkipDeleteConfirmation",!1)?this.deleteNodesWithoutConfirmation(t):this.openConfirmDeleteDialog([...t])}restoreNodes(t,o=""){this.toast.showProgressSpinner(),this.archive.restore(t,o).subscribe(n=>this.restoreFinished(t,n),n=>this.handleErrors(n))}handleErrors(t){this.toast.error(t),this.toast.closeProgressSpinner()}restoreSingle(t){null!=t?this.restoreNodes([t]):this.restore()}restore(){this.restoreNodes(this.list.getSelection().selected)}refresh(t){var o=this;return(0,h.Z)(function*(){o.dataSource.isLoading=!0,null==t&&(o.dataSource.reset(),o.list?.getSelection().clear());const n=yield o.loadData(o.searchQuery,t?t?.offset||o.dataSource.getData().length:0,o.sort.active,"asc"===o.sort.direction).toPromise();null==t?o.dataSource.setData(n.nodes,n.pagination):(o.dataSource.appendData(n.nodes),o.dataSource.setPagination(n.pagination)),o.dataSource.isLoading=!1})()}click(t){this.list.getSelection().toggle(t.element)}updateSort(t){this.sort=t,this.refresh()}prepareResults(t){for(const o of t.results)"FINE"!==o.restoreStatus&&(this.translate.get("RECYCLE.RESTORE."+o.restoreStatus).subscribe(n=>o.message=n),"DUPLICATENAME"===o.restoreStatus&&(t.hasDuplicateNames=!0),("FALLBACK_PARENT_NOT_EXISTS"===o.restoreStatus||"FALLBACK_PARENT_NO_PERMISSION"===o.restoreStatus)&&(t.hasParentFolderMissing=!0))}static#e=this.\u0275fac=function(o){return new(o||i)(e.Y36(a.qG),e.Y36(b.F),e.Y36(g.sK),e.Y36(a.xU),e.Y36(H.LN),e.Y36(y.H))};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["es-recycle"]],viewQuery:function(o,n){if(1&o&&(e.Gf(vt,5),e.Gf(Ot,5),e.Gf(At,5)),2&o){let r;e.iGM(r=e.CRH())&&(n.list=r.first),e.iGM(r=e.CRH())&&(n.confirmDeleteDialog=r.first),e.iGM(r=e.CRH())&&(n.restoreDialog=r.first)}},inputs:{actionbar:"actionbar"},decls:8,vars:7,consts:[[3,"columns","checkbox","displayType","scope","elementInteractionType","sort","dataSource","sortChange","clickItem","fetchData"],["list",""],["empty",""],["confirmDeleteDialog",""],["restoreDialog",""],["class","empty mat-heading-3",4,"ngIf"],[1,"empty","mat-heading-3"],[1,"checkbox"],["name","skipDeleteConfirmation",3,"ngModel","ngModelChange"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"restore-message"]],template:function(o,n){1&o&&(e.TgZ(0,"es-node-entries-wrapper",0,1),e.NdJ("sortChange",function(p){return n.updateSort(p)})("clickItem",function(p){return n.click(p)})("fetchData",function(p){return n.refresh(p)}),e.YNc(2,kt,2,2,"ng-template",null,2,e.W1O),e.qZA(),e.YNc(4,Nt,8,7,"ng-template",null,3,e.W1O),e.YNc(6,Lt,2,2,"ng-template",null,4,e.W1O)),2&o&&e.Q6J("columns",n.columns)("checkbox",!0)("displayType",n.NodeEntriesDisplayType.Table)("scope",n.Scope.WorkspaceList)("elementInteractionType",n.InteractionType.Emitter)("sort",n.sort)("dataSource",n.dataSource)},dependencies:[u.sg,u.O5,c.cE,M._Y,M.JJ,M.JL,M.On,M.F,xt.oG,g.X$],styles:[".empty[_ngcontent-%COMP%]{justify-content:center}.restore-message[_ngcontent-%COMP%]{color:#500}"]})}return i})();var Zt=l(47354),J=l(64634),D=l(58164),q=l(34423),Wt=l(77988),Yt=l(65928);const Ft=["dropdown"],Ut=["dropdownTrigger"];function Ht(i,s){1&i&&e._UZ(0,"i",17)}function Qt(i,s){1&i&&e._UZ(0,"i",18)}function Jt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"es-workspace-sub-tree",19),e.NdJ("onLoading",function(n){e.CHM(t);const r=e.oxw().index,p=e.oxw(2);return e.KtG(p.setLoadingState(n,r))})("onUpdateOptions",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.updateOptions(n))})("hasChildren",function(n){e.CHM(t);const r=e.oxw().$implicit,p=e.oxw(2);return e.KtG(p._hasChildren[r.ref.id]=n)})("onClick",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.openPathEvent(n))})("onDrop",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.dropToParent(n))}),e.qZA()}if(2&i){const t=e.oxw().$implicit,o=e.oxw(2);e.Q6J("node",t.ref.id)("currentPath",o.currentPath)("depth",o.depth+1)}}const qt=function(i){return[i]};function Kt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",9),e.NdJ("contextmenu",function(n){const p=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.contextMenu(n,p))}),e.TgZ(1,"div",10),e.NdJ("nodeDropped",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onDropped(n))})("click",function(){const r=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.openOrCloseNode(r))}),e.ALo(2,"async"),e.TgZ(3,"button",11),e.NdJ("click",function(n){const p=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.toggleNodeExpansion(n,p))}),e.YNc(4,Ht,1,0,"i",12),e.YNc(5,Qt,1,0,"i",13),e.qZA(),e._UZ(6,"img",14),e.ALo(7,"async"),e.ALo(8,"esNodeIcon"),e.TgZ(9,"span",15),e._uU(10),e.qZA()(),e.YNc(11,Jt,1,3,"es-workspace-sub-tree",16),e.qZA()}if(2&i){const t=s.$implicit,o=e.oxw(2);e.xp6(1),e.Udp("padding-left",20*(o.depth+1),"px"),e.ekj("sub-tree-element-selected",o.isSelected(t)),e.Q6J("cdkDragDisabled",e.lcZ(2,16,o.ui.isTouchSubject))("cdkDragData",e.VKq(22,qt,t))("esNodesDropTarget",t)("canDropNodes",o.canDropOnNode),e.xp6(2),e.ekj("opacity-invisible",!1===o._hasChildren[t.ref.id]),e.xp6(1),e.Q6J("ngIf",!o.isOpen(t)),e.xp6(1),e.Q6J("ngIf",o.isOpen(t)),e.xp6(1),e.s9C("src",e.lcZ(7,18,e.lcZ(8,20,t)),e.LSH),e.s9C("alt",t.name),e.xp6(4),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",o.isOpen(t))}}const Gt=function(i){return{count:i}};function jt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",20),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.loadAll())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&i){const t=e.oxw(2);e.Udp("margin-left",50+20*t.depth,"px"),e.xp6(1),e.hij(" ",e.xi3(2,3,"WORKSPACE.TREE_MORE_ITEMS",e.VKq(6,Gt,t.moreItems))," ")}}function Bt(i,s){if(1&i&&e._UZ(0,"es-spinner",21),2&i){const t=e.oxw(2);e.Udp("margin-left",50+20*t.depth,"px")}}function Vt(i,s){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Kt,12,24,"div",6),e.YNc(2,jt,3,8,"button",7),e.YNc(3,Bt,1,2,"es-spinner",8),e.qZA()),2&i){const t=e.oxw();e.Q6J("@open",t._nodes&&t._nodes.length),e.xp6(1),e.Q6J("ngForOf",t._nodes),e.xp6(1),e.Q6J("ngIf",t.moreItems>0&&!t.loadingMore),e.xp6(1),e.Q6J("ngIf",t.loadingMore)}}function Xt(i,s){1&i&&(e.TgZ(0,"div",22),e._UZ(1,"es-spinner-small"),e.qZA())}let K=(()=>{class i{static#e=this.MAX_FOLDER_COUNT=100;get currentPath(){return this._currentPath}set currentPath(t){this._currentPath=t,this.expandCurrentPath()}set node(t){this._node=t,null!=t&&this.refresh()}constructor(t,o,n,r){this.nodeApi=t,this.optionsService=o,this.localEvents=n,this.ui=r,this._currentPath=[],this.depth=0,this.onClick=new e.vpe,this.onLoading=new e.vpe,this.onDrop=new e.vpe,this.hasChildren=new e.vpe,this.onUpdateOptions=new e.vpe,this.loading=!0,this._hasChildren={},this.loadingStates=[],this.expandedNodes=[],this.destroyed=new I.xQ,this.canDropOnNode=D.y}ngOnInit(){Zt.T(this.localEvents.nodesChanged,this.localEvents.nodesDeleted).pipe((0,S.R)(this.destroyed)).subscribe(t=>{const o=this._nodes.map(n=>n.ref.id);t.some(n=>o.includes(n.ref.id))&&this.refresh()})}expandCurrentPath(){const t=this._nodes?.find(o=>o.ref.id===this.currentPath[this.depth]);t&&(this.expandedNodes=[t.ref.id])}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}setLoadingState(t,o){this.loadingStates[o]=t}optionIsShown(t,o){return!t.showCallback||t.showCallback(o)}loadAll(){this.loadingMore=!0,this.nodeApi.getChildren(this._node,[a.u6.FILTER_FOLDERS],{offset:this._nodes.length,count:a.u6.COUNT_UNLIMITED}).subscribe(t=>{this.loadingMore=!1,this._nodes=this._nodes.concat(t.nodes),this.moreItems=0})}contextMenu(t,o){t.preventDefault(),t.stopPropagation(),this.showDropdown(t,o)}updateOptions(t){this.onUpdateOptions.emit(t)}showDropdown(t,o){this.dropdownLeft=t.clientX+"px",this.dropdownTop=t.clientY+"px",this.optionsService.setData({activeObjects:[o],scope:c.sX.WorkspaceTree}),this.optionsService.initComponents(null,null,this.dropdown),this.optionsService.refreshComponents(),this.dropdownTrigger.openMenu()}dropToParent(t){this.onDrop.emit(t)}isSelected(t){return this.currentPath[this.currentPath.length-1]===t.ref.id}openPathEvent(t){this.onClick.emit(t)}isOpen(t){return this.expandedNodes.includes(t.ref.id)}openOrCloseNode(t){this.onClick.emit(t)}toggleNodeExpansion(t,o){if(!1===this._hasChildren[o.ref.id])return;t.stopPropagation();const n=this.expandedNodes.indexOf(o.ref.id);n<0?this.expandedNodes.push(o.ref.id):this.expandedNodes.splice(n,1)}refresh(){this._node&&this.nodeApi.getChildren(this._node,[a.u6.FILTER_FOLDERS],{count:i.MAX_FOLDER_COUNT}).subscribe(t=>{this._nodes=t.nodes,this.moreItems=t.pagination.total-t.pagination.count,this.loadingStates=J.W.initArray(this._nodes.length,!0),this.hasChildren.emit(this._nodes?.length>0),this.onLoading.emit(!1),this.loading=!1,this.expandCurrentPath()})}onDropped(t){this.onDrop.emit({target:t.target,source:{element:t.draggedNodes,mode:t.action}})}static#t=this.\u0275fac=function(o){return new(o||i)(e.Y36(a.xE),e.Y36(c.tC),e.Y36(c.Xn),e.Y36(a.VL))};static#o=this.\u0275cmp=e.Xpm({type:i,selectors:[["es-workspace-sub-tree"]],viewQuery:function(o,n){if(1&o&&(e.Gf(Ft,5),e.Gf(Ut,5)),2&o){let r;e.iGM(r=e.CRH())&&(n.dropdown=r.first),e.iGM(r=e.CRH())&&(n.dropdownTrigger=r.first)}},inputs:{currentPath:"currentPath",depth:"depth",node:"node"},outputs:{onClick:"onClick",onLoading:"onLoading",onDrop:"onDrop",hasChildren:"hasChildren",onUpdateOptions:"onUpdateOptions"},features:[e._Bn([c.tC])],decls:7,vars:7,consts:[[1,"sub-tree-wrapper"],["dropdown",""],["mat-button","","tabindex","-1","aria-hidden","true",1,"dropdown-dummy",3,"matMenuTriggerFor"],["dropdownTrigger","matMenuTrigger"],[4,"ngIf"],["class","spinner",4,"ngIf"],[3,"contextmenu",4,"ngFor","ngForOf"],["mat-flat-button","","color","primary","class","more-items",3,"marginLeft","click",4,"ngIf"],["class","more-items-loading",3,"marginLeft",4,"ngIf"],[3,"contextmenu"],["cdkDrag","","esNodesDrag","",1,"sub-tree-element",3,"cdkDragDisabled","cdkDragData","esNodesDropTarget","canDropNodes","nodeDropped","click"],[1,"expand-toggle",3,"click"],["esIcon","keyboard_arrow_right",4,"ngIf"],["esIcon","keyboard_arrow_down",4,"ngIf"],[1,"node-icon",3,"src","alt"],[1,"name"],["class","sub-tree",3,"node","currentPath","depth","onLoading","onUpdateOptions","hasChildren","onClick","onDrop",4,"ngIf"],["esIcon","keyboard_arrow_right"],["esIcon","keyboard_arrow_down"],[1,"sub-tree",3,"node","currentPath","depth","onLoading","onUpdateOptions","hasChildren","onClick","onDrop"],["mat-flat-button","","color","primary",1,"more-items",3,"click"],[1,"more-items-loading"],[1,"spinner"]],template:function(o,n){if(1&o&&(e.TgZ(0,"div",0),e._UZ(1,"es-dropdown",null,1)(3,"button",2,3),e.YNc(5,Vt,4,4,"div",4),e.YNc(6,Xt,2,0,"div",5),e.qZA()),2&o){const r=e.MAs(2);e.xp6(3),e.Udp("left",n.dropdownLeft)("top",n.dropdownTop),e.Q6J("matMenuTriggerFor",r.menu),e.xp6(2),e.Q6J("ngIf",n._nodes&&n._nodes.length),e.xp6(1),e.Q6J("ngIf",n.loading)}},dependencies:[u.sg,u.O5,q.Zt,c.JO,c.ar,c.OR,c.uW,c.dX,N.lW,Wt.p6,Yt.h,i,u.Ov,g.X$,c.R2],styles:[".dropdown-dummy[_ngcontent-%COMP%]{position:fixed}.sub-tree-element[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;padding-top:12px;padding-bottom:12px;white-space:nowrap;margin:4px 0}.sub-tree-element.cdk-drag-preview[_ngcontent-%COMP%]{background-color:#fff}[_nghost-%COMP%]     es-spinner-small .preloader-wrapper.small{width:14px;height:14px}.spinner[_ngcontent-%COMP%]{position:absolute;top:-48px;right:0;z-index:10;padding:10px}.expand-toggle[_ngcontent-%COMP%]{background:unset;border:unset;padding:unset;display:flex;align-items:center;color:var(--textLight);flex-shrink:0;width:25px}.moreOpen[_ngcontent-%COMP%]{left:30px;width:240px}.sub-tree-element[_ngcontent-%COMP%]:hover{background-color:#fff}.sub-tree-element-selected[_ngcontent-%COMP%]{background-color:#fff!important;background:linear-gradient(to right,var(--primary) 0,var(--primary) 5px,rgba(0,0,0,0) 5px,rgba(0,0,0,0) 5px);font-weight:700}.name[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;-webkit-mask-image:linear-gradient(to left,transparent 0 18px,black 60px);mask-image:linear-gradient(to left,transparent 0 18px,black 60px)}.node-icon[_ngcontent-%COMP%]{padding-right:10px;width:30px;height:20px}.sub-tree-wrapper[_ngcontent-%COMP%]{position:relative}.empty[_ngcontent-%COMP%]{font-style:italic;padding-top:10px}.more-items[_ngcontent-%COMP%]{color:var(--primary);background-color:transparent}.more-items-loading[_ngcontent-%COMP%]{position:relative;top:-15px}"],data:{animation:[(0,f.X$)("openOverlay",c.Le.openOverlay(c.Le.ANIMATION_TIME_FAST)),(0,f.X$)("open",c.Le.openOverlay())]}})}return i})();function $t(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_down"),e.qZA())}function zt(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_right"),e.qZA())}function eo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"es-workspace-sub-tree",8),e.NdJ("onUpdateOptions",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.updateOptions(n))})("onDrop",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.drop(n))})("onClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.openNode(n))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("node","-userhome-")("currentPath",t.currentPath)}}function to(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_down"),e.qZA())}function oo(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_right"),e.qZA())}function no(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"es-workspace-sub-tree",8),e.NdJ("onUpdateOptions",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.updateOptions(n))})("onDrop",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.drop(n))})("onClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.openNode(n))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("node","-shared_files-")("currentPath",t.currentPath)}}function io(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_down"),e.qZA())}function so(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_right"),e.qZA())}function ro(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"es-workspace-sub-tree",8),e.NdJ("onUpdateOptions",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.updateOptions(n))})("onDrop",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.drop(n))})("onClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.openNode(n))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("node","-my_shared_files-")("currentPath",t.currentPath)}}function ao(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_down"),e.qZA())}function co(i,s){1&i&&(e.TgZ(0,"i",6),e._uU(1,"keyboard_arrow_right"),e.qZA())}function lo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"es-workspace-sub-tree",8),e.NdJ("onUpdateOptions",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.updateOptions(n))})("onDrop",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.drop(n))})("onClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.openNode(n))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("node",t.workspace.getRootFolderInternalId())("currentPath",t.currentPath)}}function po(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",7)(1,"es-workspace-sub-tree",8),e.NdJ("onUpdateOptions",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.updateOptions(n))})("onDrop",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.drop(n))})("onClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.openNode(n))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("node","-workflow_receive-")("currentPath",t.currentPath)}}let G=(()=>{class i{set path(t){const o=t.map(n=>n.ref.id);this.currentPath=o}constructor(){this.options=[],this.onOpenNode=new e.vpe,this.onUpdateOptions=new e.vpe,this.onSetRoot=new e.vpe,this.onDrop=new e.vpe,this.onDeleteNodes=new e.vpe,this.MY_FILES="MY_FILES",this.SHARED_FILES="SHARED_FILES",this.MY_SHARED_FILES="MY_SHARED_FILES",this.TO_ME_SHARED_FILES="TO_ME_SHARED_FILES",this.WORKFLOW_RECEIVE="WORKFLOW_RECEIVE",this.RECYCLE="RECYCLE",this.currentPath=[],this.canDropOnRecycle=t=>({accept:"move"===t.action})}setRoot(t){this.onSetRoot.emit(t),this.currentPath=[]}onNodesDrop(t){t.target===this.RECYCLE&&"move"===t.action&&this.onDeleteNodes.emit(t.draggedNodes)}drop(t){this.onDrop.emit(t)}updateOptions(t){this.onUpdateOptions.emit(t)}openNode(t){this.onOpenNode.emit(t)}refresh(){this.subTree?.refresh()}static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275cmp=e.Xpm({type:i,selectors:[["es-workspace-tree"]],viewQuery:function(o,n){if(1&o&&e.Gf(K,5),2&o){let r;e.iGM(r=e.CRH())&&(n.subTree=r.first)}},inputs:{root:"root",workspace:"workspace",isSafe:"isSafe",selectedNode:"selectedNode",path:"path",options:"options"},outputs:{onOpenNode:"onOpenNode",onUpdateOptions:"onUpdateOptions",onSetRoot:"onSetRoot",onDrop:"onDrop",onDeleteNodes:"onDeleteNodes"},decls:43,vars:45,consts:[[1,"rootNode",3,"click"],[1,"material-icons","typeIcon"],["class","material-icons",4,"ngIf"],["class","arrow","class","material-icons",4,"ngIf"],["class","tree",4,"ngIf"],[1,"rootNode",3,"esNodesDropTarget","canDropNodes","click","nodeDropped"],[1,"material-icons"],[1,"tree"],[3,"node","currentPath","onUpdateOptions","onDrop","onClick"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0),e.NdJ("click",function(){return n.setRoot(n.MY_FILES)}),e.TgZ(1,"i",1),e._uU(2,"person"),e.qZA(),e._uU(3),e.ALo(4,"translate"),e.YNc(5,$t,2,0,"i",2),e.YNc(6,zt,2,0,"i",3),e.qZA(),e.YNc(7,eo,2,2,"div",4),e.TgZ(8,"div",0),e.NdJ("click",function(){return n.setRoot(n.SHARED_FILES)}),e.TgZ(9,"i",1),e._uU(10,"group"),e.qZA(),e._uU(11),e.ALo(12,"translate"),e.YNc(13,to,2,0,"i",2),e.YNc(14,oo,2,0,"i",3),e.qZA(),e.YNc(15,no,2,2,"div",4),e.TgZ(16,"div",0),e.NdJ("click",function(){return n.setRoot(n.MY_SHARED_FILES)}),e.TgZ(17,"i",1),e._uU(18,"share"),e.qZA(),e._uU(19),e.ALo(20,"translate"),e.YNc(21,io,2,0,"i",2),e.YNc(22,so,2,0,"i",3),e.qZA(),e.YNc(23,ro,2,2,"div",4),e.TgZ(24,"div",0),e.NdJ("click",function(){return n.setRoot(n.TO_ME_SHARED_FILES)}),e.TgZ(25,"i",1),e._uU(26,"send"),e.qZA(),e._uU(27),e.ALo(28,"translate"),e.YNc(29,ao,2,0,"i",2),e.YNc(30,co,2,0,"i",3),e.qZA(),e.YNc(31,lo,2,2,"div",4),e.TgZ(32,"div",0),e.NdJ("click",function(){return n.setRoot(n.WORKFLOW_RECEIVE)}),e.TgZ(33,"i",1),e._uU(34,"inbox"),e.qZA(),e._uU(35),e.ALo(36,"translate"),e.qZA(),e.YNc(37,po,2,2,"div",4),e.TgZ(38,"div",5),e.NdJ("click",function(){return n.setRoot(n.RECYCLE)})("nodeDropped",function(p){return n.onNodesDrop(p)}),e.TgZ(39,"i",1),e._uU(40,"delete"),e.qZA(),e._uU(41),e.ALo(42,"translate"),e.qZA()),2&o&&(e.ekj("rootNodeSelected",n.root==n.MY_FILES),e.xp6(3),e.hij("",e.lcZ(4,33,"WORKSPACE.MY_FILES")," "),e.xp6(2),e.Q6J("ngIf",n.root==n.MY_FILES),e.xp6(1),e.Q6J("ngIf",n.root!=n.MY_FILES),e.xp6(1),e.Q6J("ngIf",n.root==n.MY_FILES),e.xp6(1),e.ekj("rootNodeSelected",n.root==n.SHARED_FILES),e.xp6(3),e.hij("",e.lcZ(12,35,"WORKSPACE.SHARED_FILES")," "),e.xp6(2),e.Q6J("ngIf",n.root==n.SHARED_FILES),e.xp6(1),e.Q6J("ngIf",n.root!=n.SHARED_FILES),e.xp6(1),e.Q6J("ngIf",n.root==n.SHARED_FILES),e.xp6(1),e.ekj("rootNodeSelected",n.root==n.MY_SHARED_FILES),e.xp6(3),e.hij("",e.lcZ(20,37,"WORKSPACE.MY_SHARED_FILES")," "),e.xp6(2),e.Q6J("ngIf",n.root==n.MY_SHARED_FILES),e.xp6(1),e.Q6J("ngIf",n.root!=n.MY_SHARED_FILES),e.xp6(1),e.Q6J("ngIf",n.root==n.MY_SHARED_FILES),e.xp6(1),e.ekj("rootNodeSelected",n.root==n.TO_ME_SHARED_FILES),e.xp6(3),e.hij("",e.lcZ(28,39,"WORKSPACE.TO_ME_SHARED_FILES")," "),e.xp6(2),e.Q6J("ngIf",n.root==n.TO_ME_SHARED_FILES),e.xp6(1),e.Q6J("ngIf",n.root!=n.TO_ME_SHARED_FILES),e.xp6(1),e.Q6J("ngIf",n.root==n.TO_ME_SHARED_FILES),e.xp6(1),e.ekj("rootNodeSelected",n.root==n.WORKFLOW_RECEIVE),e.xp6(3),e.hij("",e.lcZ(36,41,"WORKSPACE.WORKFLOW_RECEIVE"),"\n"),e.xp6(2),e.Q6J("ngIf",n.root==n.WORKFLOW_RECEIVE),e.xp6(1),e.ekj("rootNodeSelected",n.root==n.RECYCLE),e.Q6J("esNodesDropTarget",n.RECYCLE)("canDropNodes",n.canDropOnRecycle),e.xp6(3),e.hij("",e.lcZ(42,43,"WORKSPACE.RECYCLE"),"\n"))},dependencies:[u.O5,c.ar,c.dX,K,g.X$],styles:[".rootNode[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;padding-left:10px;padding-top:12px;padding-bottom:12px;margin:4px 0}.typeIcon[_ngcontent-%COMP%]{margin-right:7px}.arrow[_ngcontent-%COMP%]{padding-left:3px}.rootNode[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{padding-right:9px;color:var(--textLight);position:relative}.rootNodeSelected[_ngcontent-%COMP%]{color:var(--primary);font-weight:700}.rootNodeSelected[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}"]})}return i})();var _o=l(12994),uo=l(75810),j=l(88419),ho=l(96124),go=l(51418),mo=l(49511),fo=l(19445),To=l(329),Co=l(63030),Eo=l(5178),xo=l(42471);const vo=["explorer"],Oo=["actionbar"];function Ao(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"es-breadcrumbs",8),e.NdJ("onDrop",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.handleDropOnBreadcrumb(n))})("onClick",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.openBreadcrumb(n))}),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("searchQuery",null==t.searchQuery?null:t.searchQuery.query)("home","WORKSPACE."+t.root)("canDropNodes",t.canDropOnBreadcrumb)}}function So(i,s){1&i&&(e.TgZ(0,"div",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NO_PERMISSIONS_FOR_SCOPE")," "))}function Mo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",17),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.showSelectRoot=!1)}),e.qZA()}}function ko(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",18)(1,"a",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.showSelectRoot=!1,e.KtG(n.setRoot("MY_FILES"))}),e._UZ(2,"i",20),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"a",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.showSelectRoot=!1,e.KtG(n.setRoot("SHARED_FILES"))}),e._UZ(6,"i",21),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"a",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.showSelectRoot=!1,e.KtG(n.setRoot("MY_SHARED_FILES"))}),e._UZ(10,"i",22),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"a",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.showSelectRoot=!1,e.KtG(n.setRoot("TO_ME_SHARED_FILES"))}),e._UZ(14,"i",23),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"a",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.showSelectRoot=!1,e.KtG(n.setRoot("WORKFLOW_RECEIVE"))}),e._UZ(18,"i",24),e._uU(19),e.ALo(20,"translate"),e.qZA(),e.TgZ(21,"a",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.showSelectRoot=!1,e.KtG(n.setRoot("RECYCLE"))}),e._UZ(22,"i",25),e._uU(23),e.ALo(24,"translate"),e.qZA()()}if(2&i){const t=e.oxw(2);e.Q6J("@overlay",t.showSelectRoot),e.xp6(1),e.ekj("rootSelected","MY_FILES"===t.root),e.xp6(2),e.hij(" ",e.lcZ(4,19,"WORKSPACE.MY_FILES"),""),e.xp6(2),e.ekj("rootSelected","SHARED_FILES"===t.root),e.xp6(2),e.hij(" ",e.lcZ(8,21,"WORKSPACE.SHARED_FILES"),""),e.xp6(2),e.ekj("rootSelected","MY_SHARED_FILES"===t.root),e.xp6(2),e.hij(" ",e.lcZ(12,23,"WORKSPACE.MY_SHARED_FILES"),""),e.xp6(2),e.ekj("rootSelected","TO_ME_SHARED_FILES"===t.root),e.xp6(2),e.hij(" ",e.lcZ(16,25,"WORKSPACE.TO_ME_SHARED_FILES"),""),e.xp6(2),e.ekj("rootSelected","WORKFLOW_RECEIVE"===t.root),e.xp6(2),e.hij(" ",e.lcZ(20,27,"WORKSPACE.WORKFLOW_RECEIVE"),""),e.xp6(2),e.ekj("rootSelected","RECYCLE"===t.root),e.xp6(2),e.hij(" ",e.lcZ(24,29,"WORKSPACE.RECYCLE"),"")}}function No(i,s){if(1&i&&e._UZ(0,"es-user-quota",29),2&i){const t=e.oxw(3);e.Q6J("quota",t.user.person.quota)}}function yo(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",26)(1,"es-workspace-tree",27),e.NdJ("onDrop",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handleDrop(n))})("onSetRoot",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.setRoot(n))})("onOpenNode",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.openNode(n))})("onDeleteNodes",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onDeleteNodes(n))}),e.qZA(),e.YNc(2,No,1,1,"es-user-quota",28),e.qZA()}if(2&i){const t=e.oxw(2);e.xp6(1),e.ekj("tree-quota",t.user.person.quota.enabled),e.Q6J("path",t.path)("selectedNode",t.selectedNodeTree)("root",t.root)("workspace",t)("isSafe",t.isSafe),e.xp6(1),e.Q6J("ngIf",t.user.person.quota.enabled)}}function bo(i,s){if(1&i&&e._UZ(0,"es-recycle",30),2&i){e.oxw(2);const t=e.MAs(5);e.Q6J("actionbar",t)}}function Ro(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"es-workspace-explorer",31,32),e.NdJ("refreshTree",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(null==n.treeComponent?null:n.treeComponent.refresh())})("displayTypeChange",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.setDisplayType(n))})("reorderDialogChange",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.reorderDialog=n)})("onSearchGlobal",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.searchGlobal(n))})("onDrop",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.handleDrop(n))})("onViewNode",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.openNode(n,!1))})("onOpenNode",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.openNode(n,!1))})("onReset",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.resetWorkspace())}),e.ALo(2,"async"),e.qZA()}if(2&i){const t=e.oxw(2),o=e.MAs(5);e.Q6J("current",t.currentFolder)("root",t.root)("searchQuery",t.searchQuery)("customOptions",t.customOptions)("displayType",t.displayType)("reorderDialog",t.reorderDialog)("preventKeyevents",e.lcZ(2,9,t.cardHasOpenModals$))("dataSource",t.dataSource)("actionbar",o)}}function wo(i,s){if(1&i&&(e.TgZ(0,"div",10),e.YNc(1,Mo,1,0,"div",11),e.YNc(2,ko,25,31,"div",12),e.YNc(3,yo,3,8,"div",13),e.YNc(4,bo,1,1,"es-recycle",14),e.TgZ(5,"h1",15),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.YNc(8,Ro,3,11,"es-workspace-explorer",16),e.qZA()),2&i){const t=e.oxw();e.ekj("hide",t.globalProgress),e.xp6(1),e.Q6J("ngIf",t.showSelectRoot),e.xp6(1),e.Q6J("ngIf",t.showSelectRoot),e.xp6(1),e.Q6J("ngIf",t.isLoggedIn),e.xp6(1),e.Q6J("ngIf","RECYCLE"===t.root),e.xp6(2),e.Oqu(e.lcZ(7,8,"WORKSPACE.TITLE")),e.xp6(2),e.Q6J("ngIf","RECYCLE"!==t.root)}}function Io(i,s){1&i&&e._UZ(0,"es-global-progress")}class T{static#e=this.VALID_ROOTS=["MY_FILES","SHARED_FILES","MY_SHARED_FILES","TO_ME_SHARED_FILES","WORKFLOW_RECEIVE","RECYCLE"];static#t=this.VALID_ROOTS_NODES=[a.u6.USERHOME,"-shared_files-","-my_shared_files-","-to_me_shared_files_personal-","-to_me_shared_files-","-workflow_receive-"];get allowBinary(){return this.allowBinarySubject.value}set allowBinary(s){this.allowBinarySubject.next(s)}get createAllowed(){return this.createAllowedSubject.value}set createAllowed(s){this.createAllowedSubject.next(s)}get currentFolder(){return this.currentFolderSubject.value}set currentFolder(s){this.currentFolderSubject.next(s)}get searchQuery(){return this.searchQuerySubject.value}set searchQuery(s){this.searchQuerySubject.next(s)}constructor(s,t,o,n,r,p,d,_,C,x,Qo,Jo,qo,Ko,Go,jo,Bo,Vo,Xo,$o,zo,en,tn,on,nn,sn,rn,an,cn,ln){this.appContainer=s,this.breadcrumbsService=t,this.card=o,this.config=n,this.connector=r,this.connectors=p,this.dialogs=d,this.event=_,this.iam=C,this.loadingScreen=x,this.localEvents=Qo,this.mainNavService=Jo,this.mds=qo,this.ngZone=Ko,this.node=Go,this.nodeHelper=jo,this.route=Bo,this.router=Vo,this.searchField=Xo,this.session=$o,this.storage=zo,this.userService=en,this.toast=tn,this.toolService=on,this.translate=nn,this.translations=sn,this.configService=rn,this.themeService=an,this.ui=cn,this.workspace=ln,this.sharedFolders=[],this.path=[],this.root="MY_FILES",this.showSelectRoot=!1,this.allowBinarySubject=new v.X(!0),this.createAllowedSubject=new v.X(null),this.currentFolderSubject=new v.X(null),this.searchQuerySubject=new v.X(null),this.globalProgress=!1,this.editNodeDeleteOnCancel=!1,this.isSafe=!1,this.isLoggedIn=!1,this.mainnav=!0,this.isBlocked=!1,this.customOptions={useDefaultOptions:!0},this.dataSource=new c.AL,this.showLtiTools=!1,this.displayType=null,this.destroyed$=new I.xQ,this.loadingTask=this.loadingScreen.addLoadingTask({until:this.destroyed$}),this.canDropOnBreadcrumb=L=>"HOME"===L.target?"MY_FILES"===this.root?(0,D._)(L):{accept:!1,denyExplicit:!1}:(0,D.y)(L),this.event.addListener(this,this.destroyed$),this.connector.setRoute(this.route,this.router),this.globalProgress=!0,this.translations.waitForInit().subscribe(()=>{this.initialize(),this.cardHasOpenModals$=this.card.hasOpenModals.pipe((0,uo.g)(0))})}ngOnInit(){this.registerScroll(),this.registerUpdateMainNav()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete(),this.storage.remove("workspace_clipboard"),this.currentFolder&&this.storage.set(this.getLastLocationStorageId(),this.currentFolder.ref.id)}beforeunloadHandler(s){}handleScroll(s){const t=this.appContainer.getScrollContainer().scrollTop;t>0&&this.storage.set("workspace_scroll",t)}onEvent(s,t){s===a.I_.EVENT_REFRESH&&this.refresh()}initMainNav(){if(this.mainNavService.setMainNavConfig({title:this.isSafe?"WORKSPACE.TITLE_SAFE":"WORKSPACE.TITLE",currentScope:this.isSafe?"safe":"workspace",create:{allowed:this.createAllowed,allowBinary:this.allowBinary,parent:this.currentFolder,folder:!0},onCreate:s=>this.explorer.nodeEntries.addVirtualNodes(s),onCreateNotAllowed:()=>this.createNotAllowed(),canOpen:this.mainnav}),this.isBlocked)this.searchField.disable();else{const s=this.searchField.enable({placeholder:this.isSafe?"WORKSPACE.SAFE_SEARCH":"WORKSPACE.SEARCH"},this.destroyed$);s.onSearchTriggered().subscribe(t=>this.doSearch(t)),this.searchQuerySubject.subscribe(t=>s.setSearchString(t?.query))}}registerUpdateMainNav(){_o.aj([this.createAllowedSubject,this.allowBinarySubject,this.currentFolderSubject]).subscribe(([s,t,o])=>this.mainNavService.patchMainNavConfig({create:{allowed:s,allowBinary:t,parent:o,folder:!0}}))}registerScroll(){this.appContainer.registerScrollEvents(s=>this.handleScroll(s),this.destroyed$)}editConnector(s=null,t=null,o=null,n=null){O.d.openConnector(this.connectors,this.iam,this.event,this.toast,this.getNodeList(s)[0],t,o,n)}handleDrop(s){"copy"===s.source.mode?this.copyNode(s.target,s.source.element):this.moveNode(s.target,s.source.element)}handleDropOnBreadcrumb(s){this.handleDrop("HOME"===s.target?{target:this.root,source:s.source}:s)}moveNode(s,t,o=0){if(this.globalProgress=!0,o>=t.length)return this.finishMoveCopy(s,t,!1),void(this.globalProgress=!1);this.node.moveNode(s.ref?.id||a.u6.USERHOME,t[o].ref.id).subscribe(n=>{this.moveNode(s,t,o+1)},n=>{this.nodeHelper.handleNodeError(t[o].name,n),t.splice(o,1),this.moveNode(s,t,o+1)})}copyNode(s,t,o=0){if(this.globalProgress=!0,o>=t.length)return this.finishMoveCopy(s,t,!0),void(this.globalProgress=!1);this.node.copyNode(s.ref?.id||a.u6.USERHOME,t[o].ref.id).subscribe(n=>{this.copyNode(s,t,o+1)},n=>{this.nodeHelper.handleNodeError(t[o].name,n),t.splice(o,1),this.copyNode(s,t,o+1)})}finishMoveCopy(s,t,o){this.toast.closeProgressSpinner();const n={to:s.name||this.translate.instant("WORKSPACE.MY_FILES"),count:t.length,mode:this.translate.instant("WORKSPACE."+(o?"PASTE_COPY":"PASTE_MOVE"))};t.length&&this.toast.toast("WORKSPACE.TOAST.PASTE_DRAG",n),this.globalProgress=!1,this.refresh()}initialize(){var s=this;return(0,h.Z)(function*(){s.route.params.pipe((0,S.R)(s.destroyed$)).subscribe(t=>s.handleParamsUpdate(t)),s.route.queryParams.pipe((0,S.R)(s.destroyed$)).subscribe(t=>s.handleQueryParamsUpdate(t))})()}initUser(){var s=this;return(0,h.Z)(function*(){try{s.user=yield s.userService.observeCurrentUser().pipe((0,j.P)(Po),(0,ho.U)(mo.J)).toPromise()}catch(t){return void s.toast.error(t)}})()}handleParamsUpdate(s){var t=this;return(0,h.Z)(function*(){t.isSafe="safe"===s.mode;const o=yield t.connector.isLoggedIn().toPromise();if(o.statusCode!==a.u6.STATUS_CODE_OK)return void a.bv.goToLogin(t.router,t.config);let n=!0;if((!o.isValidLogin||o.isGuest)&&(n=!1),t.isBlocked=!t.connector.hasToolPermissionInstant(a.u6.TOOLPERMISSION_WORKSPACE),t.isSafe&&o.currentScope!==a.u6.SAFE_SCOPE&&(n=!1),t.isSafe||null==o.currentScope)if(n){if(yield t.prepareActionbar(),yield t.initUser(),t.loadFolders(t.user),t.connector.scope=t.isSafe?a.u6.SAFE_SCOPE:null,t.isLoggedIn=!0,t.globalProgress=!1,t.isSafe){const r=yield t.configService.observeConfig().pipe((0,go.q)(1)).toPromise();r.themeColors?.colorSafe&&t.themeService.applyFromConfigColors(r.themeColors.colorSafe)}}else t.goToLogin();else t.connector.logout().subscribe(()=>{t.goToLogin()},r=>{t.toast.error(r),t.goToLogin()})})()}handleQueryParamsUpdate(s){let t=!1;if(this.oldParams)for(const n of Object.keys(this.oldParams).concat(Object.keys(s)))s[n]!==this.oldParams[n]&&n!==c.ru.QUERY_PARAM_LIST_VIEW_TYPE&&(["page","pageSize"].includes(n)||(t=!0));else t=!0;if(this.setDisplayType(null!=s.displayType?parseInt(s[c.ru.QUERY_PARAM_LIST_VIEW_TYPE],10):this.config.instant("workspaceViewType",c.P8.Table),!1),this.root=s.root&&-1!==T.VALID_ROOTS.indexOf(s.root)?s.root:"MY_FILES",s.reurl&&(this.reurl=s.reurl),this.mainnav="false"!==s.mainnav,this.initMainNav(),s.file&&s.file!==this.oldParams?.file&&this.showNodeInCurrentFolder(s.file),!t)return;this.createAllowed="MY_FILES"===this.root;let o=this.storage.pop(this.getLastLocationStorageId(),null);this.isSafe&&(o=null),s.id||s.query||!o?this.openDirectoryFromRoute(s):this.openDirectory(o,{replaceUrl:!0}),s.showAlpha&&this.showAlpha(),this.oldParams=s}showNodeInCurrentFolder(s){var t=this;return(0,h.Z)(function*(){let n=(yield t.explorer.dataSource.connect().pipe((0,j.P)(r=>r?.length>1)).toPromise()).find(r=>r.ref.id===s);if(!n){if(({node:n}=yield t.node.getNodeMetadata(s,[a.u6.ALL]).toPromise()),n.parent?.id!==t.currentFolder?.ref.id)return void t.toast.error(null,"WORKSPACE.TOAST.ELEMENT_NOT_IN_FOLDER");t.explorer.dataSource.appendData([n],"before")}t.setSelection([n]),t.parameterNode=n,t.workspace.nodeSidebar=n})()}resetWorkspace(){this.workspace.nodeSidebar&&this.parameterNode&&this.setSelection([this.parameterNode])}doSearch(s){this.routeTo(this.root,this.currentFolder?this.currentFolder.ref.id:this.searchQuery&&this.searchQuery.node?this.searchQuery.node.ref.id:null,s.searchString),s.cleared||this.ui.hideKeyboardIfMobile()}doSearchFromRoute(s,t){this.searchQuery={query:s.query,node:t=this.isRootFolder?null:t},null==t&&"RECYCLE"!==this.root&&(this.root="ALL_FILES"),this.createAllowed="EMIT_EVENT",this.notAllowedReason="WORKSPACE.CREATE_REASON.SEARCH",this.path=[],this.breadcrumbsService.setNodePath(this.path),this.setSelection([])}displayNode(s){const t=this.getNodeList(s);t[0].isDirectory||t[0].type===a.u6.SYS_TYPE_CONTAINER?t[0].collection?O.d.goToCollection(this.router,t[0]):this.openDirectory(t[0].ref.id):(this.storage.set(c.xU.NODE_RENDER_PARAMETER_DATA_SOURCE,this.dataSource),this.router.navigate([c.ru.ROUTER_PREFIX+"render",t[0].ref.id,t[0].version?t[0].version:""],{state:{scope:"workspace"}}))}getNodeList(s){if(Array.isArray(s))return s;let t=[s];return null==s&&(t=this.explorer.nodeEntries.getSelection().selected),t}loadFolders(s){for(const t of s.person.sharedFolders)this.node.getNodeMetadata(t.id).subscribe(o=>this.sharedFolders.push(o.node))}setRoot(s){this.root=s,this.searchQuery=null,this.routeTo(s,null,null),this.actionbarRef.invalidate()}setSelection(s){this.explorer?.nodeEntries.getSelection().clear(),this.explorer?.nodeEntries.getSelection().select(...s),this.setFixMobileNav()}setFixMobileNav(){this.mainNavService.getMainNav().setFixMobileElements(this.explorer?.nodeEntries.getSelection().selected?.length>0)}closeMetadata(){this.workspace.nodeSidebar=null,this.workspace.nodeSidebarChange.emit(null)}openDirectory(s,{replaceUrl:t=!1}={}){this.routeTo(this.root,s,null,{replaceUrl:t})}searchGlobal(s){this.routeTo(this.root,null,s)}openDirectoryFromRoute(s=null){let t=s?.id;if(this.closeMetadata(),t?(this.selectedNodeTree=t,t===a.u6.USERHOME?(this.selectedNodeTree=null,this.path=[]):this.node.getNodeParents(t,!1,[a.u6.ALL]).subscribe(n=>{"RECYCLE"===this.root?(this.path=[],this.breadcrumbsService.setNodePath(this.path),this.createAllowed=!1):(this.path=n.nodes.reverse(),this.breadcrumbsService.setNodePath(this.path)),this.selectedNodeTree=null},n=>{this.selectedNodeTree=null,this.path=[],this.breadcrumbsService.setNodePath(this.path)})):(this.path=[],this.breadcrumbsService.setNodePath(this.path),t=this.getRootFolderInternalId(),"RECYCLE"===this.root&&(this.createAllowed=!1)),this.currentFolder?.ref.id!==t&&(this.currentFolder=null),this.allowBinary=!0,t&&-1===T.VALID_ROOTS_NODES.indexOf(t))this.isRootFolder=!1,this.node.getNodeMetadata(t).subscribe(n=>{this.mds.getSet(n.node.metadataset?n.node.metadataset:a.u6.DEFAULT).subscribe(r=>{r.create&&(this.allowBinary=!r.create.onlyMetadata)}),this.updateNodeByParams(s,n.node),this.createAllowed=!(this.searchQuery||!this.nodeHelper.getNodesRight([n.node],a.u6.ACCESS_ADD_CHILDREN))||"EMIT_EVENT",this.notAllowedReason="WORKSPACE.CREATE_REASON.PERMISSIONS",this.recoverScrollposition()},n=>{this.updateNodeByParams(s,{ref:{id:t}})});else{this.isRootFolder=!0,("-my_shared_files-"===t||"-to_me_shared_files_personal-"===t||"-to_me_shared_files-"===t)&&(this.isRootFolder=!1),t===a.u6.USERHOME?this.createAllowed=!0:"RECYCLE"===this.root?this.createAllowed=!1:(this.createAllowed="EMIT_EVENT",this.notAllowedReason="WORKSPACE.CREATE_REASON.VIRTUAL");const n={ref:{id:t},name:this.translate.instant("WORKSPACE."+this.root)};"MY_FILES"===this.root&&(n.access=[a.u6.ACCESS_ADD_CHILDREN]),this.updateNodeByParams(s,n)}}openNode(s,t=!0){this.nodeHelper.isSavedSearchObject(s)?O.d.routeToSearchNode(this.router,null,s):a.bl.isLtiObject(s)?this.toolService.openLtiObject(s):t&&this.connectors.connectorSupportsEdit(s)?this.editConnector(s):this.displayNode(s)}openBreadcrumb(s){this.searchQuery=null,s>0||(a.VL.evaluateMediaQuery(c.ru.MEDIA_QUERY_MAX_WIDTH,c.ru.MOBILE_TAB_SWITCH_WIDTH)?this.showSelectRoot=!0:this.routeTo(this.root))}refresh(s=!0,t=null){if(t&&t.length)return void this.updateNodes(t);const o=this.searchQuery,n=this.currentFolder;this.currentFolder=null,this.searchQuery=null;const r=this.path;s&&(this.path=[],this.breadcrumbsService.setNodePath(this.path)),setTimeout(()=>{this.path=r,this.breadcrumbsService.setNodePath(this.path),this.currentFolder=n,this.searchQuery=o})}routeTo(s,t=null,o=null,{replaceUrl:n=!1}={}){var r=this;return(0,h.Z)(function*(){const p=yield O.d.getCommonParameters(r.route).toPromise();p.root=s,p.id=t,p.query=o,p.mainnav=r.mainnav,null!==r.displayType&&(p.displayType=r.displayType),r.router.navigate(["./"],{queryParams:p,relativeTo:r.route,replaceUrl:n}).then(d=>{d||r.refresh(!1)})})()}showAlpha(){this.dialogs.openGenericDialog({title:"WORKSPACE.ALPHA_TITLE",message:"WORKSPACE.ALPHA_MESSAGE",buttons:k.OK,closable:P.IA.Disabled})}addToCollection(s){const t=this.getNodeList(s);this.addNodesToCollection=t}addToStream(s){const t=this.getNodeList(s);this.addNodesStream=t}createVariant(s){const t=this.getNodeList(s);this.variantNode=t[0]}goToLogin(){a.bv.goToLogin(this.router,this.config,this.isSafe?a.u6.SAFE_SCOPE:"")}getRootFolderId(){return"MY_FILES"===this.root?a.u6.USERHOME:"SHARED_FILES"===this.root?a.u6.SHARED_FILES:"MY_SHARED_FILES"===this.root?a.u6.MY_SHARED_FILES:"TO_ME_SHARED_FILES"===this.root?a.u6.TO_ME_SHARED_FILES:"WORKFLOW_RECEIVE"===this.root?a.u6.WORKFLOW_RECEIVE:""}getRootFolderInternalId(){return"TO_ME_SHARED_FILES"===this.root?this.toMeSharedToggle?a.u6.TO_ME_SHARED_FILES:a.u6.TO_ME_SHARED_FILES_PERSONAL:this.getRootFolderId()}listLTI(){this.showLtiTools=!0}recoverScrollposition(){window.scrollTo(0,this.storage.get("workspace_scroll",0))}applyNode(s,t=!1){this.nodeHelper.addNodeToLms(s,this.reurl)}updateNodeByParams(s,t){this.loadingTask.isDone||this.loadingTask.done(),s?.query?this.doSearchFromRoute(s,t):(this.searchQuery=null,this.currentFolder=t,this.event.broadcastEvent(a.I_.EVENT_NODE_FOLDER_OPENED,this.currentFolder))}canPasteInCurrentLocation(){const s=this.storage.get("workspace_clipboard");return this.currentFolder&&!this.searchQuery&&s&&(!s.sourceNode||s.sourceNode.ref.id!==this.currentFolder.ref.id||s.copy)&&this.createAllowed}updateNodes(s){for(let t of this.dataSource.getData()){const o=s.filter(n=>n.ref.id===t.ref.id);o&&1===o.length&&J.W.copyObjectProperties(t,o[0])}}prepareActionbar(){var s=this;return(0,h.Z)(function*(){s.toMeSharedToggle=yield s.session.get("toMeSharedGroup",s.config.instant("workspaceSharedToMeDefaultAll",!1)).toPromise();const t=new c.BA("OPTIONS.TOGGLE_SHARED_TO_ME",s.toMeSharedToggle?"edu-content_shared_me_all":"edu-content_shared_me_private",()=>{s.toMeSharedToggle=!s.toMeSharedToggle,t.icon=s.toMeSharedToggle?"edu-content_shared_me_all":"edu-content_shared_me_private",s.session.set("toMeSharedGroup",s.toMeSharedToggle),s.openDirectoryFromRoute(),s.toast.toast("WORKSPACE.TOAST.TO_ME_SHARED_"+(s.toMeSharedToggle?"ALL":"PERSONAL"))});t.isToggle=!0,t.group=c.EM.Toggles,t.elementType=[c.Hd.Unknown],t.priority=5,t.customShowCallback=(0,h.Z)(function*(){return"TO_ME_SHARED_FILES"===s.root}),s.customOptions.addOptions=[t]})()}getLastLocationStorageId(){return c.xU.WORKSPACE_LAST_LOCATION+(this.isSafe?a.u6.SAFE_SCOPE:"")}setDisplayType(s,t=!0){this.displayType!==s&&(this.displayType=s,t&&this.router.navigate(["./"],{relativeTo:this.route,replaceUrl:!0,queryParamsHandling:"merge",queryParams:{[c.ru.QUERY_PARAM_LIST_VIEW_TYPE]:s}}))}createNotAllowed(){var s=this;return(0,h.Z)(function*(){(yield s.dialogs.openGenericDialog({title:"WORKSPACE.CREATE_REASON.TITLE",message:(yield s.translate.get(s.notAllowedReason).toPromise())+"\n"+(yield s.translate.get("WORKSPACE.CREATE_REASON.GENERAL").toPromise()),buttons:[{label:"WORKSPACE.GO_TO_HOME",config:{color:"primary",position:"opposite"}},{label:"CLOSE",config:{color:"standard"}}]})).afterClosed().subscribe(o=>{"WORKSPACE.GO_TO_HOME"===o&&s.openDirectory(a.u6.USERHOME)})})()}onDeleteNodes(s){this.dialogs.openDeleteNodesDialog({nodes:s})}static#o=this.\u0275fac=function(t){return new(t||T)(e.Y36(c.fo),e.Y36(fo.d),e.Y36(To.J),e.Y36(a.eB),e.Y36(a.xD),e.Y36(a.OJ),e.Y36(y.H),e.Y36(a.I_),e.Y36(a.Du),e.Y36(Co.O),e.Y36(c.Xn),e.Y36(Eo.ZF),e.Y36(a.xW),e.Y36(e.R0b),e.Y36(a.xE),e.Y36(R.G),e.Y36(E.gz),e.Y36(E.F0),e.Y36(H.LN),e.Y36(a.uR),e.Y36(c.xU),e.Y36(A.KD),e.Y36(b.F),e.Y36(a.bl),e.Y36(g.sK),e.Y36(c.fA),e.Y36(A.E4),e.Y36(xo.f),e.Y36(a.VL),e.Y36(W.A))};static#n=this.\u0275cmp=e.Xpm({type:T,selectors:[["es-workspace-page"]],viewQuery:function(t,o){if(1&t&&(e.Gf(vo,5),e.Gf(G,5),e.Gf(Q,5),e.Gf(Oo,5)),2&t){let n;e.iGM(n=e.CRH())&&(o.explorer=n.first),e.iGM(n=e.CRH())&&(o.treeComponent=n.first),e.iGM(n=e.CRH())&&(o.recycleMainComponent=n.first),e.iGM(n=e.CRH())&&(o.actionbarRef=n.first)}},hostBindings:function(t,o){1&t&&e.NdJ("beforeunload",function(r){return o.beforeunloadHandler(r)},!1,e.Jf7)},decls:10,vars:5,consts:[["cdkDropList","",1,"frame",3,"cdkDropListSortingDisabled"],[1,"topbarFrame"],[1,"mobile-move-top"],[3,"searchQuery","home","canDropNodes","onDrop","onClick",4,"ngIf"],["actionbar",""],["class","workspace-container isBlocked",4,"ngIf"],["class","workspace-container",3,"hide",4,"ngIf"],[4,"ngIf"],[3,"searchQuery","home","canDropNodes","onDrop","onClick"],[1,"workspace-container","isBlocked"],[1,"workspace-container"],["class","dialog",3,"click",4,"ngIf"],["class","selectRootMenu collection",4,"ngIf"],["class","tree",4,"ngIf"],["class","explorer",3,"actionbar",4,"ngIf"],["esTitle","",1,"cdk-visually-hidden"],["class","explorer","role","main","esSkipTarget","MAIN_CONTENT","appCreateContextMenu","",3,"current","root","searchQuery","customOptions","displayType","reorderDialog","preventKeyevents","dataSource","actionbar","refreshTree","displayTypeChange","reorderDialogChange","onSearchGlobal","onDrop","onViewNode","onOpenNode","onReset",4,"ngIf"],[1,"dialog",3,"click"],[1,"selectRootMenu","collection"],[1,"collection-item",3,"click"],["esIcon","person"],["esIcon","group"],["esIcon","share"],["esIcon","send"],["esIcon","inbox"],["esIcon","delete"],[1,"tree"],[3,"path","selectedNode","root","workspace","isSafe","onDrop","onSetRoot","onOpenNode","onDeleteNodes"],[3,"quota",4,"ngIf"],[3,"quota"],[1,"explorer",3,"actionbar"],["role","main","esSkipTarget","MAIN_CONTENT","appCreateContextMenu","",1,"explorer",3,"current","root","searchQuery","customOptions","displayType","reorderDialog","preventKeyevents","dataSource","actionbar","refreshTree","displayTypeChange","reorderDialogChange","onSearchGlobal","onDrop","onViewNode","onOpenNode","onReset"],["explorer",""]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,Ao,1,3,"es-breadcrumbs",3),e._UZ(4,"es-actionbar",null,4),e.qZA()(),e.YNc(6,So,3,3,"div",5),e.YNc(7,wo,9,10,"div",6),e.YNc(8,Io,1,0,"es-global-progress",7),e.qZA(),e._UZ(9,"es-metadata-sidebar")),2&t&&(e.Q6J("cdkDropListSortingDisabled",!0),e.xp6(3),e.Q6J("ngIf",o.isLoggedIn),e.xp6(3),e.Q6J("ngIf",o.isBlocked),e.xp6(1),e.Q6J("ngIf",!o.isBlocked),e.xp6(1),e.Q6J("ngIf",o.globalProgress))},styles:[".frame[_ngcontent-%COMP%]{display:flex;flex-direction:column}.topbarFrame[_ngcontent-%COMP%]{position:sticky;top:var(--mainnavHeight);z-index:60}.topbarFrame[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:100%;height:65px;background-color:#fff;box-shadow:0 0 5px #0000004d;display:flex}.topbarFrame[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > es-breadcrumbs[_ngcontent-%COMP%]{padding-left:30px;flex-grow:1;height:100%}.topbarFrame[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > es-actionbar[_ngcontent-%COMP%]{position:absolute;right:0;height:100%;padding:0 10px;display:flex;align-items:center;z-index:62;background:linear-gradient(to right,rgba(255,255,255,.001) 0,#fff 10px,#fff 100%)}.topbarFrame[_ngcontent-%COMP%]     .breadcrumb div{word-break:break-all}.workspace-container[_ngcontent-%COMP%]{display:flex}.isBlocked[_ngcontent-%COMP%]{position:absolute;color:#0000008a;font-size:150%;text-align:center;width:100%;padding-top:25px}.tree[_ngcontent-%COMP%]{display:table-cell}.globalProgress[_ngcontent-%COMP%]{z-index:122}.tree[_ngcontent-%COMP%]{min-width:300px;max-width:300px;top:calc(65px + var(--mainnavHeight));position:fixed;height:calc(100% - 65px - var(--mainnavHeight));z-index:2;background:#f7f7f7}.tree[_ngcontent-%COMP%]   es-workspace-tree[_ngcontent-%COMP%]{min-width:300px;max-width:300px;top:calc(65px + var(--mainnavHeight));position:fixed;height:calc(100% - 65px - var(--mainnavHeight));overflow-y:auto}.tree[_ngcontent-%COMP%]   .tree-quota[_ngcontent-%COMP%]{height:calc(100% - 65px - var(--mainnavHeight) - 60px)}es-user-quota[_ngcontent-%COMP%]{position:absolute;width:300px;height:60px;background:#f7f7f7;bottom:0;z-index:3;padding:10px 20px}.nodeRender[_ngcontent-%COMP%]{padding:20px}.addDesktop[_ngcontent-%COMP%], .addMobile[_ngcontent-%COMP%]{z-index:65}.addMobile[_ngcontent-%COMP%]{z-index:66;position:fixed;right:25px;bottom:87px;display:none}.dialog[_ngcontent-%COMP%]{z-index:131}.selectRootMenu[_ngcontent-%COMP%]{position:fixed;width:250px;left:311px;top:calc(14px + var(--mainnavHeight));box-shadow:0 0 5px #0000004d;z-index:132;cursor:pointer;background-color:#fff;border:1px solid #e0e0e0;border-radius:2px}.selectRootMenu[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--textLight);padding:8px 15px;gap:8px}.rootSelected[_ngcontent-%COMP%]{color:var(--primary)!important;font-weight:700;background:linear-gradient(to right,var(--primary) 0,var(--primary) 5px,rgba(0,0,0,0) 5px,rgba(0,0,0,0) 5px);background-color:#fff}.explorer[_ngcontent-%COMP%]{position:relative;display:block;left:300px;width:calc(100% - 300px);transition:all var(--transitionNormal)}.explorerMetadata[_ngcontent-%COMP%]{width:calc(100% - 600px)}.viewType[_ngcontent-%COMP%]{position:fixed;color:var(--textLight);padding-top:20px;padding-right:25px;right:0;z-index:97}.tree[_ngcontent-%COMP%]{box-shadow:0 0 5px #0000004d}@media screen and (max-width: 1300px){.explorerMetadata[_ngcontent-%COMP%]{width:calc(100% - 300px)}}@media screen and (max-width: 900px){.tree[_ngcontent-%COMP%]{display:none}.selectRootMenu[_ngcontent-%COMP%]{left:10px}.addMobile[_ngcontent-%COMP%]{display:inherit}.topbarFrame[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > es-breadcrumbs[_ngcontent-%COMP%]{padding-left:20px}.explorer[_ngcontent-%COMP%]{left:0;width:100%;height:calc(100% - (var(--mainnavHeight) + 127px))}[_nghost-%COMP%]     es-workspace-explorer .list{margin-bottom:62px}}"],data:{animation:[(0,f.X$)("fade",c.Le.fade()),(0,f.X$)("fadeFast",c.Le.fade(c.Le.ANIMATION_TIME_FAST)),(0,f.X$)("overlay",c.Le.openOverlay(c.Le.ANIMATION_TIME_FAST)),(0,f.X$)("fromLeft",c.Le.fromLeft()),(0,f.X$)("fromRight",c.Le.fromRight())]}})}function Po(i){return null!=i}const Do=[{path:"",component:T},{path:":mode",component:T}];let Lo=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[E.Bz.forChild(Do),E.Bz]})}return i})();var Zo=l(98617),Wo=l(94618),Yo=l(19374),Fo=l(66848),Uo=l(31579);let Ho=(()=>{class i{static#e=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=e.oAB({type:i});static#o=this.\u0275inj=e.cJS({imports:[B.m,Lo]})}return i})();e.B6R(T,[Zo.n,u.O5,q.Wj,c.nv,c.ar,Wo.d,Yo.P,Fo.M,Uo.h,Et,Q,V.M,G],[u.Ov,g.X$])}}]);