{"version":3,"file":"src_app_pages_upload-page_upload-page_module_ts.js","mappings":"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","sources":["./src/app/pages/upload-page/upload-page-routing.module.ts","./src/app/pages/upload-page/upload-page.component.ts","./src/app/pages/upload-page/upload-page.component.html","./src/app/pages/upload-page/upload-page.module.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { UploadPageComponent } from './upload-page.component';\n\nconst routes: Routes = [\n    {\n        path: '',\n        component: UploadPageComponent,\n    },\n];\n\n@NgModule({\n    imports: [RouterModule.forChild(routes)],\n    exports: [RouterModule],\n})\nexport class UploadPageRoutingModule {}\n","import { Component } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { TranslationsService } from 'ngx-edu-sharing-ui';\nimport {\n    FrameEventsService,\n    Node,\n    RestConnectorService,\n    RestConstants,\n} from '../../core-module/core.module';\nimport { NodeHelperService } from '../../services/node-helper.service';\nimport { UploadDialogService } from '../../services/upload-dialog.service';\n\n@Component({\n    selector: 'es-upload-page',\n    templateUrl: 'upload-page.component.html',\n    styleUrls: ['upload-page.component.scss'],\n})\nexport class UploadPageComponent {\n    loading = true;\n    parent: Node;\n\n    private reurl: string;\n\n    constructor(\n        private translations: TranslationsService,\n        private nodeHelper: NodeHelperService,\n        private connector: RestConnectorService,\n        private events: FrameEventsService,\n        private route: ActivatedRoute,\n        private uploadDialogs: UploadDialogService,\n    ) {\n        this.translations.waitForInit().subscribe(() => {\n            this.connector.isLoggedIn(false).subscribe((login) => {\n                if (login.statusCode === RestConstants.STATUS_CODE_OK) {\n                    this.nodeHelper.getDefaultInboxFolder().subscribe((inbox) => {\n                        this.parent = inbox;\n                        this.route.queryParams.subscribe((params) => {\n                            this.reurl = params['reurl'];\n                        });\n                        this._openUploadDialog();\n                    });\n                }\n            });\n        });\n    }\n\n    private _openUploadDialog(): void {\n        this.loading = false;\n        void this.uploadDialogs\n            .openUploadDialog({ parent: this.parent, chooseParent: true, multiple: false })\n            .then((nodes) => {\n                this._onDone(nodes);\n            });\n    }\n\n    private _onDone(node: Node[]) {\n        if (node == null) {\n            this._cancel();\n            return;\n        }\n        this.nodeHelper.addNodeToLms(node[0], this.reurl);\n        window.close();\n    }\n\n    private _cancel() {\n        this.events.broadcastEvent(FrameEventsService.EVENT_UPLOAD_CANCELED);\n        window.close();\n        // There have been different paths for handling a canceled dialog before migration to\n        // overlay dialogs. One called `window.close()` like above, the other one opened the upload\n        // dialog again. Not sure, whether `window.close()` ever works, so we fallback to\n        // `_openUploadDialog` if the window is still open by now.\n        this._openUploadDialog();\n    }\n}\n","<es-global-progress *ngIf=\"loading\"></es-global-progress>\n<!-- FIXME: Is this part of a page that already has a level 1 heading? -->\n<h1 esTitle class=\"cdk-visually-hidden\">{{ 'WORKSPACE.ADD_OBJECT_TITLE' | translate }}</h1>\n","import { NgModule } from '@angular/core';\nimport { SharedModule } from '../../shared/shared.module';\nimport { UploadPageRoutingModule } from './upload-page-routing.module';\nimport { UploadPageComponent } from './upload-page.component';\n\n@NgModule({\n    declarations: [UploadPageComponent],\n    imports: [SharedModule, UploadPageRoutingModule],\n})\nexport class UploadPageModule {}\n"],"names":["RouterModule","UploadPageComponent","routes","path","component","UploadPageRoutingModule","_","_2","_3","forChild","imports","i1","exports","FrameEventsService","RestConstants","i0","ɵɵelement","constructor","translations","nodeHelper","connector","events","route","uploadDialogs","loading","waitForInit","subscribe","isLoggedIn","login","statusCode","STATUS_CODE_OK","getDefaultInboxFolder","inbox","parent","queryParams","params","reurl","_openUploadDialog","openUploadDialog","chooseParent","multiple","then","nodes","_onDone","node","_cancel","addNodeToLms","window","close","broadcastEvent","EVENT_UPLOAD_CANCELED","ɵɵdirectiveInject","TranslationsService","i2","NodeHelperService","i3","RestConnectorService","i4","ActivatedRoute","i5","UploadDialogService","selectors","decls","vars","consts","template","UploadPageComponent_Template","rf","ctx","ɵɵtemplate","UploadPageComponent_es_global_progress_0_Template","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","ɵɵadvance","ɵɵtextInterpolate","ɵɵpipeBind1","SharedModule","UploadPageModule","declarations"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}