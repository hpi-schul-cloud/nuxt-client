"use strict";(self.webpackChunkapp_as_web_component=self.webpackChunkapp_as_web_component||[]).push([[5517],{35517:(R,l,s)=>{s.r(l),s.d(l,{JoinGroupDialogComponent:()=>J,JoinGroupDialogModule:()=>b});var h=s(50555),f=s(15861),p=s(81771),d=s(53461),t=s(65879),_=s(91486),G=s(1189),P=s(3962),m=s(96814),O=s(52081),C=s(17162),x=s(35799),v=s(23680),M=s(99994),U=s(71365);function T(n,a){1&n&&t._UZ(0,"es-spinner")}function S(n,a){if(1&n){const o=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){const c=t.CHM(o).$implicit,u=t.oxw(3);return t.KtG(u.select(c))}),t._UZ(1,"es-authority-row",8),t.ALo(2,"translate"),t.qZA()}if(2&n){const o=a.$implicit,e=t.oxw(3);t.ekj("selected",o===e.group)("is-member",e.isMemberOf(o)),t.xp6(1),t.Q6J("authority",o)("secondaryTitle",t.lcZ(2,6,e.isMemberOf(o)?"SIGNUP_GROUP.ALREADY_MEMBER":"SIGNUP_GROUP.SIGNUP_TYPE."+o.signupMethod))}}function y(n,a){if(1&n&&(t.ynx(0),t.YNc(1,S,3,8,"button",6),t.BQk()),2&n){const o=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",o.groups)}}function I(n,a){1&n&&(t.TgZ(0,"p",9),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SIGNUP_GROUP.NO_GROUPS")," "))}function N(n,a){if(1&n&&(t.TgZ(0,"div",2)(1,"p",3),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,T,1,0,"es-spinner",4),t.YNc(5,y,2,1,"ng-container",4),t.YNc(6,I,3,3,"p",5),t.qZA()),2&n){const o=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"SIGNUP_GROUP.SELECT_GROUP")),t.xp6(2),t.Q6J("ngIf",o.groupsLoading),t.xp6(1),t.Q6J("ngIf",!o.groupsLoading),t.xp6(1),t.Q6J("ngIf",!(o.groupsLoading||null!=o.groups&&o.groups.length))}}function w(n,a){if(1&n){const o=t.EpF();t.TgZ(0,"es-input-password",14),t.NdJ("valueChange",function(i){t.CHM(o);const c=t.oxw(2);return t.KtG(c.password=i)})("valueChange",function(){t.CHM(o);const i=t.oxw(2);return t.KtG(i.updateButtons())}),t.ALo(1,"translate"),t.qZA()}if(2&n){const o=t.oxw(2);t.s9C("label",t.lcZ(1,2,"SIGNUP_GROUP.GROUP_PASSWORD")),t.Q6J("value",o.password)}}function D(n,a){if(1&n&&(t.TgZ(0,"div",10)(1,"p",3),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"p",11),t._uU(5),t.ALo(6,"authorityName"),t.qZA(),t._UZ(7,"es-info-message",12),t.ALo(8,"translate"),t.YNc(9,w,2,4,"es-input-password",13),t.qZA()),2&n){const o=t.oxw();t.xp6(2),t.Oqu(t.lcZ(3,4,"SIGNUP_GROUP.CONFIRM_GROUP")),t.xp6(3),t.Oqu(t.lcZ(6,6,o.group)),t.xp6(2),t.s9C("message",t.lcZ(8,8,"SIGNUP_GROUP.DESCRIPTION."+o.group.signupMethod)),t.xp6(2),t.Q6J("ngIf","password"===o.group.signupMethod)}}var r=function(n){return n[n.selectGroup=0]="selectGroup",n[n.confirmGroup=1]="confirmGroup",n}(r||{});let J=(()=>{class n{constructor(o,e,i,c,u){this.data=o,this.dialogRef=e,this.connector=i,this.iam=c,this.toast=u,this.STEP=r,this.dialogStep=r.selectGroup,this.password="",this.groupsLoading=!0,this.updateButtons(),this.connector.isLoggedIn(!1).subscribe(Z=>{this.iam.searchGroups("*",!0,"","*",{count:p.u6.COUNT_UNLIMITED}).subscribe(g=>{this.groups=g.groups,this.groupsLoading=!1},g=>{this.toast.error(g),this.groupsLoading=!1,this.toast.closeProgressSpinner()})})}ngOnInit(){var o=this;return(0,f.Z)(function*(){o.userGroups=(yield o.iam.getUserGroups().toPromise()).groups})()}cancel(){this.dialogRef.close(null)}updateButtons(){let o;if(this.dialogStep===r.selectGroup&&(o=p.Qd.getNextCancel(()=>this.cancel(),()=>{this.dialogStep=r.confirmGroup,this.updateButtons()}),o[1].disabled=!this.group||this.isMemberOf(this.group)),this.dialogStep===r.confirmGroup){const e=new p.Qd("BACK",{color:"standard"},()=>{this.dialogStep=r.selectGroup,this.updateButtons()}),i=new p.Qd("SIGNUP_GROUP.SIGNUP",{color:"primary"},()=>this.signup());i.disabled="password"===this.group.signupMethod&&!this.password,o=[e,i]}this.dialogRef.patchConfig({buttons:o})}signup(){this.toast.showProgressSpinner(),this.iam.signupGroup(this.group.authorityName,this.password).subscribe(o=>{"Ok"!==o?this.toast.error(null,"SIGNUP_GROUP.TOAST."+o):("list"===this.group.signupMethod?this.toast.toast("SIGNUP_GROUP.TOAST.ADDED_TO_LIST"):this.toast.toast("SIGNUP_GROUP.TOAST.ADDED_TO_GROUP",{group:this.group.profile.displayName}),this.cancel()),this.toast.closeProgressSpinner()},o=>{this.toast.error(o),this.toast.closeProgressSpinner()})}select(o){this.group=o,this.updateButtons(),this.dialogRef.patchConfig({closable:d.IA.Standard})}isMemberOf(o){return!!this.userGroups?.find(e=>e.authorityName===o.authorityName)}static#t=this.\u0275fac=function(e){return new(e||n)(t.Y36(d.W9),t.Y36(_.Y),t.Y36(p.xD),t.Y36(p.Du),t.Y36(G.F))};static#o=this.\u0275cmp=t.Xpm({type:n,selectors:[["es-join-group-dialog"]],decls:2,vars:2,consts:[["class","select-group",4,"ngIf"],["class","confirm-group card-content-padding",4,"ngIf"],[1,"select-group"],[1,"mat-heading-5"],[4,"ngIf"],["class","mat-heading-4 no-groups-message",4,"ngIf"],["mat-ripple","",3,"selected","is-member","click",4,"ngFor","ngForOf"],["mat-ripple","",3,"click"],[3,"authority","secondaryTitle"],[1,"mat-heading-4","no-groups-message"],[1,"confirm-group","card-content-padding"],[1,"mat-heading-4","group-name"],["mode","info",3,"message"],["autocomplete","new-password",3,"value","label","valueChange",4,"ngIf"],["autocomplete","new-password",3,"value","label","valueChange"]],template:function(e,i){1&e&&(t.YNc(0,N,7,6,"div",0),t.YNc(1,D,10,10,"div",1)),2&e&&(t.Q6J("ngIf",i.dialogStep===i.STEP.selectGroup),t.xp6(1),t.Q6J("ngIf",i.dialogStep===i.STEP.confirmGroup))},dependencies:[P.s,m.sg,m.O5,O.OR,C.u,x.P,v.wG,M.F,U.X$],styles:[".select-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.select-group[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;justify-content:center}.select-group[_ngcontent-%COMP%]   .no-groups-message[_ngcontent-%COMP%]{margin-top:20%;color:var(--textLight)}.select-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 -25px;padding:0 25px;border-radius:0;background:none;border:none}.select-group[_ngcontent-%COMP%]   button.is-member[_ngcontent-%COMP%]   app-authority-row[_ngcontent-%COMP%]{opacity:.75;filter:grayscale(100%);-webkit-backdrop-filter:grayscale(100%);backdrop-filter:grayscale(100%)}.select-group[_ngcontent-%COMP%]   button.selected[_ngcontent-%COMP%]{background:var(--listItemSelectedBackgroundEffect)}.select-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   es-authority-row[_ngcontent-%COMP%]{display:flex;width:100%;text-align:left}.confirm-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.confirm-group[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{display:flex;justify-content:center}.confirm-group[_ngcontent-%COMP%]   .group-name[_ngcontent-%COMP%]{margin-bottom:2em}.confirm-group[_ngcontent-%COMP%]   es-input-password[_ngcontent-%COMP%]{display:flex;margin-top:20px;width:100%}.confirm-group[_ngcontent-%COMP%]   es-input-password[_ngcontent-%COMP%]     mat-form-field{width:100%}"]})}return n})(),b=(()=>{class n{static#t=this.\u0275fac=function(e){return new(e||n)};static#o=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[h.m]})}return n})()}}]);