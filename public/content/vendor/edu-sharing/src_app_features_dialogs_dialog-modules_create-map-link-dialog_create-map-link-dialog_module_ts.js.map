{"version":3,"file":"src_app_features_dialogs_dialog-modules_create-map-link-dialog_create-map-link-dialog_module_ts.js","mappings":"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","sources":["./src/app/features/dialogs/dialog-modules/create-map-link-dialog/create-map-link-dialog.component.ts","./src/app/features/dialogs/dialog-modules/create-map-link-dialog/create-map-link-dialog.component.html","./src/app/features/dialogs/dialog-modules/create-map-link-dialog/create-map-link-dialog.module.ts"],"sourcesContent":["import { Component, Inject, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport {\n    DialogButton,\n    Node,\n    RestConnectorService,\n    RestConstants,\n    RestHelper,\n    RestNodeService,\n} from '../../../../core-module/core.module';\nimport { Toast } from '../../../../services/toast';\nimport { UIHelper } from '../../../../core-ui-module/ui-helper';\nimport { DialogsService } from '../../dialogs.service';\nimport { BreadcrumbsService } from '../../../../shared/components/breadcrumbs/breadcrumbs.service';\nimport { CARD_DIALOG_DATA } from '../../card-dialog/card-dialog-config';\nimport { CardDialogRef } from '../../card-dialog/card-dialog-ref';\nimport { CreateMapLinkDialogData, CreateMapLinkDialogResult } from './create-map-link-dialog-data';\n@Component({\n    selector: 'es-create-map-link-dialog',\n    templateUrl: './create-map-link-dialog.component.html',\n    styleUrls: ['./create-map-link-dialog.component.scss'],\n})\nexport class CreateMapLinkDialogComponent implements OnInit {\n    name: string;\n\n    private readonly buttons = [\n        new DialogButton('CANCEL', { color: 'standard' }, () => this.dialogRef.close(null)),\n        new DialogButton('MAP_LINK.CREATE', { color: 'primary' }, () => this.createLink()),\n    ];\n\n    constructor(\n        @Inject(CARD_DIALOG_DATA) public data: CreateMapLinkDialogData,\n        private dialogRef: CardDialogRef<CreateMapLinkDialogData, CreateMapLinkDialogResult>,\n        private connector: RestConnectorService,\n        private toast: Toast,\n        private router: Router,\n        private nodeApi: RestNodeService,\n        private breadcrumbsService: BreadcrumbsService,\n        private dialogs: DialogsService,\n    ) {}\n\n    ngOnInit(): void {\n        this.dialogRef.patchConfig({ buttons: this.buttons });\n        this.name = this.data.node.name;\n        this.updateBreadcrumbs(RestConstants.INBOX);\n        this.updateButtons();\n    }\n\n    updateButtons(): any {\n        this.buttons[1].disabled = !this.name;\n    }\n\n    async chooseDirectory() {\n        const dialogRef = await this.dialogs.openFileChooserDialog({\n            title: 'MAP_LINK.FILE_PICKER_TITLE',\n            pickDirectory: true,\n            writeRequired: true,\n        });\n        dialogRef.afterClosed().subscribe((result) => {\n            if (result) {\n                this.setDirectory(result);\n            }\n        });\n    }\n\n    setDirectory(event: Node[]) {\n        this.updateBreadcrumbs(event[0].ref.id);\n    }\n\n    private updateBreadcrumbs(id: string) {\n        this.nodeApi.getNodeParents(id, false).subscribe((parents) => {\n            this.breadcrumbsService.setNodePath(parents.nodes.reverse());\n        });\n    }\n\n    private createLink() {\n        const properties = RestHelper.createNameProperty(this.name);\n        properties[RestConstants.CCM_PROP_MAP_REF_TARGET] = [\n            RestHelper.createSpacesStoreRef(this.data.node),\n        ];\n        this.toast.showProgressSpinner();\n        this.nodeApi\n            .createNode(\n                this.breadcrumbsService.breadcrumbs$.value[\n                    this.breadcrumbsService.breadcrumbs$.value.length - 1\n                ].ref.id,\n                RestConstants.CCM_TYPE_MAP,\n                [RestConstants.CCM_ASPECT_MAP_REF],\n                properties,\n            )\n            .subscribe(\n                ({ node }) => {\n                    const additional = {\n                        link: {\n                            caption: 'MAP_LINK.CREATED_LINK',\n                            callback: () => {\n                                UIHelper.goToWorkspaceFolder(\n                                    this.nodeApi,\n                                    this.router,\n                                    this.connector.getCurrentLogin(),\n                                    this.breadcrumbsService.breadcrumbs$.value[\n                                        this.breadcrumbsService.breadcrumbs$.value.length - 1\n                                    ].ref.id,\n                                );\n                            },\n                        },\n                    };\n                    this.toast.toast(\n                        'MAP_LINK.CREATED',\n                        {\n                            folder: this.breadcrumbsService.breadcrumbs$.value[\n                                this.breadcrumbsService.breadcrumbs$.value.length - 1\n                            ].name,\n                        },\n                        null,\n                        null,\n                        additional,\n                    );\n                    this.toast.closeProgressSpinner();\n                    this.dialogRef.close(node);\n                },\n                (error) => {\n                    this.toast.closeProgressSpinner();\n                    this.toast.error(error);\n                },\n            );\n    }\n}\n","<es-info-message>\n  {{ 'MAP_LINK.INFO' | translate }}\n</es-info-message>\n<mat-form-field>\n  <mat-label>{{ 'MAP_LINK.NAME' | translate }}</mat-label>\n  <input matInput type=\"text\" [(ngModel)]=\"name\" (ngModelChange)=\"updateButtons()\" />\n</mat-form-field>\n<div class=\"breadcrumb-style\">\n  <div class=\"breadcrumb-info\">{{ 'MAP_LINK.BREADCRUMB_INFO' | translate }}</div>\n  <div class=\"breadcrumb-group\">\n    <es-breadcrumbs\n      short=\"always\"\n      [home]=\"'WORKSPACE.MY_FILES'\"\n      [clickable]=\"false\"\n    ></es-breadcrumbs>\n    <div class=\"btn-choose\"></div>\n    <button mat-raised-button (click)=\"chooseDirectory()\">\n      {{ 'MAP_LINK.CHOOSE' | translate }}\n    </button>\n  </div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { SharedModule } from '../../../../shared/shared.module';\nimport { CreateMapLinkDialogComponent } from './create-map-link-dialog.component';\n\nexport { CreateMapLinkDialogComponent };\n\n@NgModule({\n    declarations: [CreateMapLinkDialogComponent],\n    imports: [SharedModule],\n})\nexport class CreateMapLinkDialogModule {}\n"],"names":["DialogButton","RestConstants","RestHelper","UIHelper","CARD_DIALOG_DATA","CreateMapLinkDialogComponent","constructor","data","dialogRef","connector","toast","router","nodeApi","breadcrumbsService","dialogs","buttons","color","close","createLink","ngOnInit","patchConfig","name","node","updateBreadcrumbs","INBOX","updateButtons","disabled","chooseDirectory","_this","_asyncToGenerator","openFileChooserDialog","title","pickDirectory","writeRequired","afterClosed","subscribe","result","setDirectory","event","ref","id","getNodeParents","parents","setNodePath","nodes","reverse","properties","createNameProperty","CCM_PROP_MAP_REF_TARGET","createSpacesStoreRef","showProgressSpinner","createNode","breadcrumbs$","value","length","CCM_TYPE_MAP","CCM_ASPECT_MAP_REF","additional","link","caption","callback","goToWorkspaceFolder","getCurrentLogin","folder","closeProgressSpinner","error","_","i0","ɵɵdirectiveInject","i1","CardDialogRef","i2","RestConnectorService","i3","Toast","i4","Router","RestNodeService","i5","BreadcrumbsService","i6","DialogsService","_2","selectors","decls","vars","consts","template","CreateMapLinkDialogComponent_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","CreateMapLinkDialogComponent_Template_input_ngModelChange_7_listener","$event","ɵɵelement","CreateMapLinkDialogComponent_Template_button_click_15_listener","ɵɵadvance","ɵɵtextInterpolate1","ɵɵpipeBind1","ɵɵtextInterpolate","ɵɵproperty","SharedModule","CreateMapLinkDialogModule","_3","declarations","imports"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}