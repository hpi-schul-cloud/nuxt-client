{"version":3,"file":"src_app_features_dialogs_dialog-modules_file-chooser-dialog_file-chooser-dialog_module_ts.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAG6B;AAC+B;AACgC;AAS/C;AAEmB;AAC0C;AAChB;AAGS;AAOvE;;;;;;;;;;;;;;;;;;IC3B1BmB,4DAAA,aAGC;IACCA,oDAAA,GACF;;IAAAA,0DAAA,EAAM;;;IADJA,uDAAA,GACF;IADEA,gEAAA,MAAAA,yDAAA,iEACF;;;;;IACAA,4DAAA,aAAwD;IACtDA,oDAAA,GACF;;IAAAA,0DAAA,EAAM;;;IADJA,uDAAA,GACF;IADEA,gEAAA,MAAAA,yDAAA,2DACF;;;;;IARAA,wDAAA,IAAAQ,uDAAA,iBAKM;IACNR,wDAAA,IAAAS,uDAAA,iBAEM;;;;IAPHT,wDAAA,UAAAW,MAAA,CAAAC,IAAA,CAAAC,WAAA,KAAAF,MAAA,CAAAG,KAAA,CAAAC,KAAA,CAAAC,MAAA,KAAAL,MAAA,CAAAM,aAAA,CAA0E;IAKvEjB,uDAAA,GAAyB;IAAzBA,wDAAA,UAAAW,MAAA,CAAAO,gBAAA,GAAyB;;;;;IAY3BlB,uDAAA,WAAgD;IAChDA,4DAAA,eAAwB;IAAAA,oDAAA,GAA2B;;IAAAA,0DAAA,EAAO;;;;IADvDA,wDAAA,WAAAoB,MAAA,CAAAC,QAAA,CAAuB;IACFrB,uDAAA,GAA2B;IAA3BA,+DAAA,CAAAA,yDAAA,OAAAoB,MAAA,CAAAG,KAAA,EAA2B;;;;;IAErDvB,gEAAA,GAA0E;;;;;IAL5EA,4DAAA,cAAkC;IAChCA,wDAAA,IAAAyB,2EAAA,yBAGc;IACdzB,wDAAA,IAAA0B,4EAAA,0BAA0E;IAC5E1B,0DAAA,EAAU;;;;;;IADOA,uDAAA,GAA8B;IAA9BA,wDAAA,qBAAA2B,GAAA,CAA8B,4BAAAP,MAAA;;;;;;IAVjDpB,4DAAA,uBAIC;IADCA,wDAAA,+BAAA6B,+FAAAC,MAAA;MAAA9B,2DAAA,CAAAgC,IAAA;MAAA,MAAAC,OAAA,GAAAjC,2DAAA;MAAA,OAAqBA,yDAAA,CAAAiC,OAAA,CAAAG,WAAA,CAAAN,MAAA,CAAmB;IAAA,EAAC;IAEzC9B,wDAAA,IAAAqC,6DAAA,qBAMU;IACZrC,0DAAA,EAAgB;;;;IAPWA,uDAAA,GAAO;IAAPA,wDAAA,YAAAsC,MAAA,CAAAC,IAAA,CAAO;;;;;;IAW9BvC,4DAAA,yBAOC;IAHCA,wDAAA,qBAAAwC,qGAAAV,MAAA;MAAA9B,2DAAA,CAAAyC,IAAA;MAAA,MAAAC,OAAA,GAAA1C,2DAAA;MAAA,OAAWA,yDAAA,CAAA0C,OAAA,CAAAC,gBAAA,CAAAb,MAAA,CAAwB;IAAA,EAAC;;IAGrC9B,0DAAA,EAAiB;;;;;;;IAJhBA,wDAAA,qBAAoB,SAAA4C,OAAA,CAAAC,YAAA,GAAAD,OAAA,CAAAC,YAAA,CAAAtB,KAAA,GAAAvB,yDAAA,OAAA8C,SAAA,eAAAF,OAAA,CAAAC,YAAA,GAAAD,OAAA,CAAAC,YAAA,CAAAE,IAAA,GAAAC,YAAA;;;;;;IAKtBhD,4DAAA,cAAiD;IACzCA,wDAAA,sBAAAiD,iFAAA;MAAAjD,2DAAA,CAAAkD,IAAA;MAAA,MAAAC,OAAA,GAAAnD,2DAAA;MAAA,OAAYA,yDAAA,CAAAmD,OAAA,CAAAC,MAAA,EAAQ;IAAA,EAAC;IACzBpD,4DAAA,yBAAoC;IAClCA,uDAAA,gBAAuB;IAEvBA,4DAAA,gBAME;IADAA,wDAAA,2BAAAqD,uFAAAvB,MAAA;MAAA9B,2DAAA,CAAAkD,IAAA;MAAA,MAAAI,OAAA,GAAAtD,2DAAA;MAAA,OAAAA,yDAAA,CAAAsD,OAAA,CAAAC,WAAA,GAAAzB,MAAA;IAAA,EAAyB;;IAL3B9B,0DAAA,EAME;;;;IAFAA,uDAAA,GAA6C;IAA7CA,mEAAA,gBAAAA,yDAAA,sBAA6C;IAC7CA,wDAAA,YAAAyD,OAAA,CAAAF,WAAA,CAAyB;;;;;IAwB7BvD,4DAAA,aAA2C;IACzCA,oDAAA,GACF;;IAAAA,0DAAA,EAAK;;;IADHA,uDAAA,GACF;IADEA,gEAAA,MAAAA,yDAAA,gCACF;;;;;IACAA,4DAAA,aAA0C;IACxCA,oDAAA,GACF;;IAAAA,0DAAA,EAAK;;;IADHA,uDAAA,GACF;IADEA,gEAAA,MAAAA,yDAAA,0BACF;;;;;IALAA,wDAAA,IAAA0D,oEAAA,iBAEK;IACL1D,wDAAA,IAAA2D,oEAAA,iBAEK;;;;IALmB3D,wDAAA,UAAA4D,OAAA,CAAAC,UAAA,CAAiB;IAGjB7D,uDAAA,GAAgB;IAAhBA,wDAAA,SAAA4D,OAAA,CAAAC,UAAA,CAAgB;;;;;;IA9C9C7D,4DAAA,cAAyB;IACvBA,wDAAA,IAAA8D,kEAAA,6BAOkB;IAClB9D,wDAAA,IAAA+D,uDAAA,kBAcM;IAEN/D,4DAAA,kCAgBC;IAPCA,wDAAA,2BAAAgE,mGAAAlC,MAAA;MAAA9B,2DAAA,CAAAiE,IAAA;MAAA,MAAAC,OAAA,GAAAlE,2DAAA;MAAA,OAAiBA,yDAAA,CAAAkE,OAAA,CAAAC,gBAAA,CAAArC,MAAA,CAAwB;IAAA,EAAC,wBAAAsC,gGAAAtC,MAAA;MAAA9B,2DAAA,CAAAiE,IAAA;MAAA,MAAAI,OAAA,GAAArE,2DAAA;MAAA,OAC5BA,yDAAA,CAAAqE,OAAA,CAAAC,UAAA,CAAAxC,MAAA,CAAkB;IAAA,EADU,uBAAAyC,+FAAAzC,MAAA;MAAA9B,2DAAA,CAAAiE,IAAA;MAAA,MAAAO,OAAA,GAAAxE,2DAAA;MAAA,OAE7BA,yDAAA,CAAAwE,OAAA,CAAAC,UAAA,CAAA3C,MAAA,CAAA4C,OAAA,CAA0B;IAAA,EAFG,uBAAAC,+FAAA;MAAA3E,2DAAA,CAAAiE,IAAA;MAAA,MAAAW,OAAA,GAAA5E,2DAAA;MAAA,OAG7BA,yDAAA,CAAA4E,OAAA,CAAAC,QAAA,EAAU;IAAA,EAHmB,sBAAAC,8FAAA;MAAA9E,2DAAA,CAAAiE,IAAA;MAAA,MAAAc,OAAA,GAAA/E,2DAAA;MAAA,OAM9BA,yDAAA,CAAA+E,OAAA,CAAAF,QAAA,EAAU;IAAA,EANoB;IAQ1C7E,wDAAA,IAAAgF,+DAAA,iCAAAhF,oEAAA,CAOc;IAChBA,0DAAA,EAA0B;;;;IA/CvBA,uDAAA,GAAiB;IAAjBA,wDAAA,UAAAkF,MAAA,CAAArB,UAAA,CAAiB;IAMd7D,uDAAA,GAAgB;IAAhBA,wDAAA,SAAAkF,MAAA,CAAArB,UAAA,CAAgB;IAkBpB7D,uDAAA,GAAmB;IAAnBA,wDAAA,eAAAkF,MAAA,CAAAC,IAAA,CAAmB,YAAAD,MAAA,CAAAE,OAAA,2CAAAF,MAAA,CAAAG,WAAA,6BAAAH,MAAA,CAAAI,IAAA,4BAAAJ,MAAA,CAAAtF,eAAA,CAAA2F,OAAA;;;ADxBzB,MAAMC,mBAAmB,GAAG,GAAG;AAC/B,MAAMC,kBAAkB,GAAG,GAAG;AAQxB,MAAOC,0BAA0B;EAgBnC,IAAYC,eAAeA,CAAA;IACvB,OAAO,IAAI,CAACC,sBAAsB,CAAC7E,KAAK;EAC5C;EACA,IAAY4E,eAAeA,CAAC5E,KAAa;IACrC,IAAI,CAAC6E,sBAAsB,CAACC,IAAI,CAAC9E,KAAK,CAAC;EAC3C;EA4BA+E,YACqClF,IAA2B,EACpDmF,SAAwE,EACxEC,SAA+B,EAC/BC,aAAoC,EACpCC,OAAwB,EACxBC,KAAY,EACZC,kBAAsC,EACtCC,SAA2B;IAPF,KAAAzF,IAAI,GAAJA,IAAI;IAC7B,KAAAmF,SAAS,GAATA,SAAS;IACT,KAAAC,SAAS,GAATA,SAAS;IACT,KAAAC,aAAa,GAAbA,aAAa;IACb,KAAAC,OAAO,GAAPA,OAAO;IACP,KAAAC,KAAK,GAALA,KAAK;IACL,KAAAC,kBAAkB,GAAlBA,kBAAkB;IAClB,KAAAC,SAAS,GAATA,SAAS;IAtDZ,KAAAzG,eAAe,GAAGA,gEAAe;IAC1C;;;IAGS,KAAAkB,KAAK,GAAG,IAAIhC,kDAAe,CAAS,EAAE,CAAC;IAEhD,KAAAsG,OAAO,GAAe,EAAE;IAExB,KAAAkB,aAAa,GAAW,EAAE;IAC1B,KAAAjB,WAAW,GAAGtF,uEAAsB,CAACwG,KAAK;IAGlC,KAAAX,sBAAsB,GAAG,IAAI9G,kDAAe,CAAS,IAAI,CAAC;IAOlE,KAAAqG,IAAI,GAAG,IAAIrF,+DAAc,EAAQ;IAEjC,KAAA0G,UAAU,GAAG,IAAI;IACjB,KAAAjE,IAAI,GAAG,CACH;MACIhB,KAAK,EAAE,oBAAoB;MAC3BF,QAAQ,EAAE,QAAQ;MAClBoF,SAAS,EAAElH,mEAAa,CAACmH,QAAQ;MACjCzF,aAAa,EAAE;KAClB,EACD;MACIM,KAAK,EAAE,wBAAwB;MAC/BF,QAAQ,EAAE,OAAO;MACjBoF,SAAS,EAAElH,mEAAa,CAACoH,YAAY;MACrC1F,aAAa,EAAE;KAClB,CACJ;IACD;IACA,KAAA4B,YAAY,GAGR,IAAI;IAIA,KAAA+D,oBAAoB,GAAG,IAAI7H,0CAAO,EAAyC;IAY/E;IACA,IAAI,CAACqG,OAAO,CAACyB,IAAI,CAAC,IAAIhH,yDAAQ,CAAC,MAAM,EAAEN,mEAAa,CAACuH,OAAO,CAAC,CAAC;EAClE;EAEAC,QAAQA,CAAA;IACJ,IAAI,CAACC,iBAAiB,EAAE;IACxB,IAAI,CAACC,mBAAmB,EAAE;IAC1B,IAAI,CAACC,UAAU,EAAE;IACjB,IAAI,CAACC,eAAe,EAAE;IACtB,IAAI,CAACvB,sBAAsB,CACtBwB,IAAI,CACDnI,oDAAG,CAAE0G,eAAe,IAAK,IAAI,CAAC/E,IAAI,CAACyG,QAAQ,IAAI1B,eAAe,CAAC,EAC/D3G,qEAAoB,EAAE,CACzB,CACAsI,SAAS,CAAED,QAAQ,IAAK,IAAI,CAACtB,SAAS,CAACwB,WAAW,CAAC;MAAEF;IAAQ,CAAE,CAAC,CAAC;EAC1E;EAEAG,eAAeA,CAAA;IACX,IAAI,CAACzB,SAAS,CAACwB,WAAW,CAAC;MAAEE,sBAAsB,EAAE,IAAI,CAACC;IAAgB,CAAE,CAAC;EACjF;EAEQP,eAAeA,CAAA;IACnB,MAAMQ,MAAM,GAAqD;MAC7DC,KAAK,EAAE,IAAI,CAAChH,IAAI,CAACgH,KAAK;MACtBC,KAAK,EAAErC;KACV;IACD,IAAI,CAACO,SAAS,CAACwB,WAAW,CAACI,MAAM,CAAC;IAClC,IAAI,IAAI,CAACG,QAAQ,EAAE;MACfH,MAAM,CAACI,MAAM,GAAG;QAAEC,IAAI,EAAE,MAAM;QAAEjF,IAAI,EAAE,IAAI,CAAC+E;MAAQ,CAAE;;EAE7D;EAEA5G,gBAAgBA,CAAA;IACZ,OACI,IAAI,CAACJ,KAAK,EAAEC,KAAK,GAAG,IAAI,CAACD,KAAK,EAAEC,KAAK,EAAEC,MAAM,GAAG,CAAC,CAAC,EAAEiH,MAAM,EAAEC,OAAO,CAC/D3I,mEAAa,CAAC4I,YAAY,CAC7B,KAAK,CAAC,CAAC;EAEhB;EAEQlB,mBAAmBA,CAAA;IACvB,IAAI,CAACL,oBAAoB,CACpBQ,IAAI,CAACjI,0DAAS,CAAC,CAAC;MAAEsH,SAAS;MAAE2B;IAAK,CAAE,KAAK,IAAI,CAACC,aAAa,CAAC5B,SAAS,EAAE2B,KAAK,CAAC,CAAC,CAAC,CAC/Ed,SAAS,EAAE;IAChB,IAAI,CAACxG,KAAK,CAACwG,SAAS,CAAEgB,IAAI,IAAI;MAC1B,IAAI,CAAClC,kBAAkB,CAACmC,WAAW,CAACD,IAAI,CAAC;MACzC,IAAI,CAACE,aAAa,EAAE;IACxB,CAAC,CAAC;EACN;EAEApG,WAAWA,CAACqG,KAAwB;IAChC,MAAMC,GAAG,GAAG,IAAI,CAACnG,IAAI,CAACkG,KAAK,CAACE,KAAK,CAAC;IAClC,IAAI,CAACC,gBAAgB,CAACF,GAAG,CAACjC,SAAS,EAAE;MAAExF,aAAa,EAAEyH,GAAG,CAACzH;IAAa,CAAE,CAAC;EAC9E;EAEQ2H,gBAAgBA,CAACnC,SAAiB,EAAE;IAAExF,aAAa,GAAG;EAAK,CAAE;IACjE,IAAI,CAAC4H,aAAa,GAAGpC,SAAS;IAC9B;IACA,IAAI,CAACxF,aAAa,GAAGA,aAAa;IAClC,IAAI,CAAC6H,UAAU,EAAE;EACrB;EAEAC,WAAWA,CAACC,IAAY;IACpB,IAAI,CAAC1C,aAAa,GAAG0C,IAAI;EAC7B;EAEQhC,iBAAiBA,CAAA;IACrB,IAAI,IAAI,CAACpG,IAAI,CAACqI,aAAa,EAAE;MACzB,IAAI,CAACnB,QAAQ,GAAG,QAAQ;MACxB,IAAI,CAAClH,IAAI,CAACsI,MAAM,CAACrC,IAAI,CAACtH,mEAAa,CAAC4J,cAAc,CAAC;;IAEvD,IAAI,IAAI,CAACvI,IAAI,CAACC,WAAW,EAAE;MACvB,IAAI,CAACwE,WAAW,GAAGtF,uEAAsB,CAACqJ,SAAS;MACnD,IAAI,CAAC7G,IAAI,GAAG,IAAI;MAChB,IAAI,CAACqG,gBAAgB,CAACrJ,mEAAa,CAAC8J,IAAI,EAAE;QAAEpI,aAAa,EAAE;MAAK,CAAE,CAAC;MACnE,IAAI,CAACuF,UAAU,GAAG,KAAK;MACvB,IAAI,CAAC3C,UAAU,GAAG,IAAI;MACtB,IAAI,CAACN,WAAW,GAAG,EAAE;MACrB,IAAI,CAAC6B,OAAO,GAAG5F,+DAAQ,CAAC8J,2BAA2B,EAAE;MACrD,IAAI,CAAChE,IAAI,GAAG;QACRiE,MAAM,EAAEhK,mEAAa,CAACiK,gBAAgB;QACtCC,SAAS,EAAE,MAAM;QACjBrE,OAAO,EAAE;OACZ;KACJ,MAAM;MACH,IAAI,CAACA,OAAO,GAAG3F,yGAA0B,CAACiK,UAAU,CAAC,IAAI,CAAC1D,SAAS,CAAC;MACpE,IAAI,CAACZ,OAAO,GAAG,IAAI,CAACA,OAAO,CAACnG,GAAG,CAAC,CAAC0K,CAAC,EAAEC,CAAC,KAAI;QACrCD,CAAC,CAACE,OAAO,GAAGD,CAAC,KAAK,CAAC;QACnB,OAAOD,CAAC;MACZ,CAAC,CAAC;MACF,IAAI,CAACrE,IAAI,GAAG;QACRiE,MAAM,EAAE,IAAI,CAACnE,OAAO,CAAC,CAAC,CAAC,CAAC0E,IAAI;QAC5BL,SAAS,EAAE,KAAK;QAChBM,OAAO,EAAE,IAAI;QACb3E,OAAO,EAAE7F,mEAAa,CAACyK,uBAAuB,CAACd,MAAM,CAAEe,CAAC,IACpD,IAAI,CAAC7E,OAAO,CAAC8E,IAAI,CAAEP,CAAC,IAAKA,CAAC,CAACG,IAAI,KAAKG,CAAC,CAACH,IAAI,CAAC;OAElD;;EAET;EAEQ5C,UAAUA,CAAA;IACd,IAAI,IAAI,CAAC2B,aAAa,EAAE;MACpB,IAAI,CAACsB,aAAa,CAAC,IAAI,CAACtB,aAAa,CAAC;KACzC,MAAM;MACH,IAAI,CAACD,gBAAgB,CAAC,IAAI,CAACrG,IAAI,CAAC,CAAC,CAAC,CAACkE,SAAS,EAAE;QAC1CxF,aAAa,EAAE,IAAI,CAACsB,IAAI,CAAC,CAAC,CAAC,CAACtB;OAC/B,CAAC;;EAEV;EAEAmJ,mBAAmBA,CAACpB,IAAS;IACzB,IAAIA,IAAI,CAACf,MAAM,CAACC,OAAO,CAAC3I,mEAAa,CAAC4I,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE;MACvD,OAAO;QAAEkC,MAAM,EAAE,KAAK;QAAEC,OAAO,EAAE;MAAsB,CAAE;;IAE7D,OAAO;MAAED,MAAM,EAAE;IAAI,CAAE;EAC3B;EAEA1H,gBAAgBA,CAAC4H,QAAgB;IAC7B,IAAIA,QAAQ,KAAK,CAAC,EAAE;MAChB,IAAI,CAACzB,UAAU,EAAE;KACpB,MAAM;MACH,IAAI,CAACrE,UAAU,CAAC,IAAI,CAAC3D,KAAK,CAACC,KAAK,CAACwJ,QAAQ,GAAG,CAAC,CAAC,CAAC;;EAEvD;EAEAzB,UAAUA,CAAA;IACN,IAAI,CAACjG,YAAY,GAAG,IAAI;IACxB,IAAI,CAAC/B,KAAK,CAAC+E,IAAI,CAAC,EAAE,CAAC;IACnB,IAAI,CAACsE,aAAa,CAAC,IAAI,CAACtB,aAAa,EAAE,IAAI,CAAC;EAChD;EAEApE,UAAUA,CAACgE,KAAW;IAClB,IAAIA,KAAK,CAAC+B,WAAW,IAAI,IAAI,CAAC5J,IAAI,CAACC,WAAW,EAAE;MAC5C,IAAI,IAAI,CAACgD,UAAU,EAAE;QACjB,IAAI,CAACyC,aAAa,GAAG,CAACmC,KAAK,CAAC;QAC5B,IAAI,CAACD,aAAa,EAAE;QACpB;;MAEJ,IAAI,CAAClC,aAAa,GAAG,EAAE;MACvB,IAAI,IAAI,CAACxF,KAAK,CAACC,KAAK,GAAG,IAAI,CAACD,KAAK,CAACC,KAAK,CAACC,MAAM,GAAG,CAAC,CAAC,EAAEyJ,GAAG,CAACC,EAAE,KAAKjC,KAAK,CAACkC,MAAM,CAACD,EAAE,EAAE;QAC7E;QACA,IAAI,CAAC5J,KAAK,CAAC+E,IAAI,CAAC,CAAC,GAAG,IAAI,CAAC/E,KAAK,CAACC,KAAK,EAAE0H,KAAK,CAAC,CAAC;OAChD,MAAM,IAAI,IAAI,CAAC3H,KAAK,CAACC,KAAK,EAAEmJ,IAAI,CAAEU,QAAQ,IAAKA,QAAQ,CAACH,GAAG,CAACC,EAAE,KAAKjC,KAAK,CAACgC,GAAG,CAACC,EAAE,CAAC,EAAE;QAC/E;QACA,MAAM/B,KAAK,GAAG,IAAI,CAAC7H,KAAK,CAACC,KAAK,CAAC8J,SAAS,CACnCD,QAAQ,IAAKA,QAAQ,CAACH,GAAG,CAACC,EAAE,KAAKjC,KAAK,CAACgC,GAAG,CAACC,EAAE,CACjD;QACD,IAAI,CAAC5J,KAAK,CAAC+E,IAAI,CAAC,IAAI,CAAC/E,KAAK,CAACC,KAAK,CAAC+J,KAAK,CAAC,CAAC,EAAEnC,KAAK,GAAG,CAAC,CAAC,CAAC;OACxD,MAAM;QACH;QACA,IAAI,IAAI,CAAC7H,KAAK,CAACC,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;UAC/B;UACA;UACA,IAAI,CAACF,KAAK,CAAC+E,IAAI,CAAC,CAAC4C,KAAK,CAAC,CAAC;;QAE5B,IAAI,CAACsC,qBAAqB,CAACtC,KAAK,CAACgC,GAAG,CAACC,EAAE;QACnC;QAAA,CACCtD,IAAI,CAAChI,0DAAS,CAAC,IAAI,CAACwH,oBAAoB,CAACQ,IAAI,CAAClI,qDAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CACxDoI,SAAS,EAAE;;MAEpB,IAAI,CAAC6C,aAAa,CAAC1B,KAAK,CAACgC,GAAG,CAACC,EAAE,CAAC;;EAExC;EAEQK,qBAAqBA,CAACL,EAAU;IACpC,OAAO,IAAI,CAACxE,OAAO,CAAC8E,cAAc,CAACN,EAAE,CAAC,CAACtD,IAAI,CACvC/H,oDAAG,CAAEuB,IAAI,IAAI;MACT,IAAI,CAACE,KAAK,CAAC+E,IAAI,CAACjF,IAAI,CAACqK,KAAK,CAACC,OAAO,EAAE,CAAC;MACrC;MACA;MACA,IAAI,CAACtK,IAAI,CAACuK,KAAK,EAAE;QACb,IAAI,CAACtI,YAAY,GAAG;UAChBtB,KAAK,EAAE,IAAI;UACXwB,IAAI,EAAEnC,IAAI,CAACuK,KAAK,KAAK,cAAc,GAAG,OAAO,GAAG;SACnD;;IAET,CAAC,CAAC,CACL;EACL;EAEAC,kBAAkBA,CAAC3C,KAAa;IAC5B;IACA,IAAI,CAACnC,aAAa,GAAGmC,KAAK;IAC1B,IAAI,CAACD,aAAa,EAAE;EACxB;EAEApF,MAAMA,CAAA;IACF,IAAI,CAAC+G,aAAa,CAAC,IAAI,CAACtB,aAAa,CAAC;EAC1C;EAEQsB,aAAaA,CAAC1D,SAAiB,EAAE2B,KAAK,GAAG,IAAI;IACjD,IAAI,CAACxB,oBAAoB,CAACf,IAAI,CAAC;MAAEY,SAAS;MAAE2B;IAAK,CAAE,CAAC;EACxD;EAEQC,aAAaA,CAAC5B,SAAiB,EAAE2B,KAAK,GAAG,IAAI;IACjD,IAAI,CAACiD,gBAAgB,GAAG5E,SAAS;IACjC,IAAI2B,KAAK,EAAE;MACP,IAAI,CAACjD,IAAI,CAACiD,KAAK,EAAE;MACjB;;;IAEJ,IAAI,CAACkD,SAAS,GAAG,IAAI;IACrB,IAAI,IAAI,CAAC1K,IAAI,CAACC,WAAW,EAAE;MACvB,OAAO,IAAI,CAACoF,aAAa,CACpB7C,MAAM,CAAC,IAAI,CAACG,WAAW,EAAE;QACtBgI,MAAM,EAAE,IAAI,CAACpG,IAAI,CAACqG,OAAO,EAAE,CAACxK,MAAM;QAClCyK,MAAM,EAAE,CAAC,IAAI,CAACnG,IAAI,CAACiE,MAAM,CAAC;QAC1BmC,aAAa,EAAE,IAAI,CAACpG,IAAI,CAACmE,SAAS,KAAK,KAAK;QAC5CkC,cAAc,EAAE,CAACpM,mEAAa,CAACqM,GAAG;OACrC,CAAC,CACDxE,IAAI,CACD/H,oDAAG,CAAEuB,IAAI,IAAI;QACT,MAAMuE,IAAI,GAAW,EAAE;QACvB,KAAK,MAAMwE,CAAC,IAAI/I,IAAI,CAACC,WAAW,EAAE;UAC9B,MAAMgL,GAAG,GAAQlC,CAAC;UAClB;UACAkC,GAAG,CAACC,UAAU,GAAGnC,CAAC;UAClBxE,IAAI,CAAC0B,IAAI,CAACgF,GAAG,CAAC;;QAElB,IAAI,CAACE,QAAQ,CAAC;UACVC,UAAU,EAAEpL,IAAI,CAACoL,UAAU;UAC3Bf,KAAK,EAAE9F;SACV,CAAC;MACN,CAAC,CAAC,EACFlG,oDAAG,CAAC,MAAK,CAAE,CAAC,CAAC,CAChB;KACR,MAAM;MACH,OAAO,IAAI,CAACiH,OAAO,CACd+F,WAAW,CAACxF,SAAS,EAAE,IAAI,CAAC7F,IAAI,CAACsI,MAAM,EAAE;QACtCqC,MAAM,EAAE,IAAI,CAACpG,IAAI,CAACqG,OAAO,EAAE,CAACxK,MAAM;QAClCyK,MAAM,EAAE,CAAC,IAAI,CAACnG,IAAI,CAACiE,MAAM,CAAC;QAC1BmC,aAAa,EAAE,IAAI,CAACpG,IAAI,CAACmE,SAAS,KAAK,KAAK;QAC5CkC,cAAc,EAAE,CAACpM,mEAAa,CAACqM,GAAG;OACrC,CAAC,CACDxE,IAAI,CACD/H,oDAAG,CAAE8F,IAAc,IAAI;QACnB,IAAI,CAAC4G,QAAQ,CAAC5G,IAAI,CAAC;MACvB,CAAC,CAAC,EACFlG,oDAAG,CAAC,MAAK,CAAE,CAAC,CAAC,CAChB;;EAEb;EAEA4F,QAAQA,CAAA;IACJ,IAAI,CAAC,IAAI,CAACM,IAAI,CAAC+G,OAAO,EAAE,EAAE;MACtB;;IAEJ,IAAI,CAAC/B,aAAa,CAAC,IAAI,CAACkB,gBAAgB,EAAE,KAAK,CAAC;IAChD,IAAI,CAACC,SAAS,GAAG,IAAI;EACzB;EAEAhH,UAAUA,CAAC1D,IAAoB;IAC3B,IAAI,CAAC0E,IAAI,GAAG1E,IAAI;IAChB,IAAI,CAACuE,IAAI,CAACiD,KAAK,EAAE;IACjB,IAAI,CAAC+B,aAAa,CAAC,IAAI,CAACkB,gBAAgB,CAAC;EAC7C;EAEQU,QAAQA,CAAC5G,IAAc;IAC3B,IAAI,CAACgH,SAAS,CAAChH,IAAI,CAAC;IACpB,IAAI,CAACqD,aAAa,EAAE;IACpB,IAAI,CAAC8C,SAAS,GAAG,KAAK;EAC1B;EAEAc,MAAMA,CAAA;IACF,IAAI,CAACrG,SAAS,CAACsG,KAAK,CAAC,IAAI,CAAC;EAC9B;EAEQF,SAASA,CAAChH,IAAc;IAC5B,IAAI,CAACmG,SAAS,GAAG,KAAK;IACtB,IAAI,CAACnG,IAAI,CAAC8F,KAAK,CAACjK,MAAM,EAAE;MACpB;;IAEJ,IAAI,CAACmE,IAAI,CAACmH,aAAa,CAACnH,IAAI,CAAC6G,UAAU,CAAC;IACxC,IAAI,CAAC7G,IAAI,CAACoH,UAAU,CAACpH,IAAI,CAAC8F,KAAK,CAAC;EACpC;EAEQuB,eAAeA,CAAA;IACnB,CAAC,MAAK;MACF,IAAI,IAAI,CAAC1L,KAAK,CAACC,KAAK,CAACC,MAAM,EAAE;QACzB,OAAOnC,qCAAO,CAAC,IAAI,CAACiC,KAAK,CAACC,KAAK,CAAC,IAAI,CAACD,KAAK,CAACC,KAAK,CAACC,MAAM,GAAG,CAAC,CAAC,CAAC;OAChE,MAAM;QACH,OAAO,IAAI,CAACkF,OAAO,CACdwG,eAAe,CAAC,IAAI,CAAC7D,aAAa,CAAC,CACnCzB,IAAI,CAACnI,oDAAG,CAAE0N,WAAW,IAAKA,WAAW,CAAC3D,IAAI,CAAC,CAAC;;IAEzD,CAAC,EAAC,CAAE,CAAC1B,SAAS,CAAE0B,IAAI,IAAI;MACpB,IAAI,IAAI,CAACpI,IAAI,CAACC,WAAW,EAAE;QACvB,IAAImI,IAAI,CAACf,MAAM,CAACC,OAAO,CAAC3I,mEAAa,CAAC4I,YAAY,CAAC,KAAK,CAAC,CAAC,EAAE;UACxD,IAAI,CAAChC,KAAK,CAACyG,KAAK,CAAC,IAAI,EAAE,sBAAsB,CAAC;UAC9C;;;MAGR,IAAI,CAAC7G,SAAS,CAACsG,KAAK,CAAC,CAACrD,IAAI,CAAC,CAAC;IAChC,CAAC,CAAC;EACN;EAEQ6D,UAAUA,CAAA;IACd,IAAI,IAAI,CAACjM,IAAI,CAACC,WAAW,EAAE;MACvB,IAAI,IAAI,CAACyF,aAAa,CAAC,CAAC,CAAC,CAAC2B,MAAM,CAACC,OAAO,CAAC3I,mEAAa,CAAC4I,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE;QACxE,IAAI,CAAChC,KAAK,CAACyG,KAAK,CAAC,IAAI,EAAE,sBAAsB,CAAC;QAC9C;;;IAGR,IAAI,CAAC7G,SAAS,CAACsG,KAAK,CAAC,IAAI,CAAC/F,aAAa,CAAC;EAC5C;EAEAkC,aAAaA,CAAA;IACT,MAAMsE,OAAO,GAAG,CACZ,IAAIxN,kEAAY,CAAC,IAAI,CAAC+G,SAAS,CAAC0G,OAAO,CAAC,QAAQ,CAAC,EAAE;MAAEC,KAAK,EAAE;IAAU,CAAE,EAAE,MACtE,IAAI,CAACZ,MAAM,EAAE,CAChB,CACJ;IACD,IAAIa,aAAa;IACjB,IAAI,IAAI,CAACrM,IAAI,CAACqI,aAAa,EAAE;MACzB,IAAI,IAAI,CAACnI,KAAK,CAACC,KAAK,CAACC,MAAM,EAAE;QACzB,IAAI,CAAC2E,eAAe,GAAG,IAAI,CAAC7E,KAAK,CAACC,KAAK,CAAC,IAAI,CAACD,KAAK,CAACC,KAAK,CAACC,MAAM,GAAG,CAAC,CAAC,CAAC8I,IAAI;OAC5E,MAAM;QACH,IAAI,CAACnE,eAAe,GAAG,IAAI,CAACU,SAAS,CAAC0G,OAAO,CAAC,kBAAkB,CAAC;;MAErEE,aAAa,GAAG,IAAI3N,kEAAY,CAC5B,IAAI,CAAC+G,SAAS,CAAC0G,OAAO,CAAC,OAAO,CAAC,EAC/B;QAAEC,KAAK,EAAE;MAAS,CAAE,EACpB,MAAM,IAAI,CAACR,eAAe,EAAE,CAC/B;MACDS,aAAa,CAACC,QAAQ,GACjB,CAAC,IAAI,CAACpM,KAAK,CAACC,KAAK,CAACC,MAAM,IAAI,CAAC,IAAI,CAACC,aAAa,IAAK,CAAC,IAAI,CAACC,gBAAgB,EAAE;KACpF,MAAM,IAAI,IAAI,CAACN,IAAI,CAACC,WAAW,IAAI,CAAC,IAAI,CAACyF,aAAa,CAACtF,MAAM,EAAE;MAC5D,IAAI,CAAC2E,eAAe,GAAG,IAAI;MAC3BsH,aAAa,GAAG,IAAI3N,kEAAY,CAC5B,sBAAsB,EACtB;QAAE0N,KAAK,EAAE;MAAS,CAAE,EACpB,MAAK,CAAE,CAAC,CACX;MACDC,aAAa,CAACC,QAAQ,GAAG,IAAI;KAChC,MAAM,IAAI,IAAI,CAAC5G,aAAa,CAACtF,MAAM,EAAE;MAClC,IAAI,CAAC2E,eAAe,GAAG,IAAI,CAACW,aAAa,CAAC,CAAC,CAAC,CAACwD,IAAI;MACjDmD,aAAa,GAAG,IAAI3N,kEAAY,CAC5B,IAAI,CAAC+G,SAAS,CAAC0G,OAAO,CAClB,IAAI,CAACnM,IAAI,CAACC,WAAW,GAAG,mBAAmB,GAAG,aAAa,EAC3D;QACIiJ,IAAI,EAAE,IAAI,CAACnE;OACd,CACJ,EACD;QAAEqH,KAAK,EAAE;MAAS,CAAE,EACpB,MAAM,IAAI,CAACH,UAAU,EAAE,CAC1B;MACDI,aAAa,CAACC,QAAQ,GAClB,IAAI,CAACtM,IAAI,CAACuM,aAAa,IACvB,IAAI,CAAC/C,mBAAmB,CAAC,IAAI,CAAC9D,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC+D,MAAM,IAAI,KAAK;;IAEvE,IAAI4C,aAAa,EAAE;MACfH,OAAO,CAACjG,IAAI,CAACoG,aAAa,CAAC;;IAE/B,IAAI,CAAClH,SAAS,CAACwB,WAAW,CAAC;MAAEuF;IAAO,CAAE,CAAC;EAC3C;EAEA3I,gBAAgBA,CAACsE,KAAiB;IAC9B,IAAIA,KAAK,CAACS,MAAM,CAAEU,CAAC,IAAKA,CAAC,CAACC,OAAO,CAAC,CAAC7I,MAAM,GAAG,CAAC,EAAE;MAC3C,IAAI,CAAC+E,SAAS,CAACwB,WAAW,CAAC;QAAEM,KAAK,EAAEpC;MAAkB,CAAE,CAAC;KAC5D,MAAM;MACH,IAAI,CAACM,SAAS,CAACwB,WAAW,CAAC;QAAEM,KAAK,EAAErC;MAAmB,CAAE,CAAC;;EAElE;EAAC,QAAA4H,CAAA;qBAraQ1H,0BAA0B,EAAA1F,+DAAA,CAkDvBN,6EAAgB,GAAAM,+DAAA,CAAAsN,uEAAA,GAAAtN,+DAAA,CAAAwN,0EAAA,GAAAxN,+DAAA,CAAAwN,2EAAA,GAAAxN,+DAAA,CAAAwN,qEAAA,GAAAxN,+DAAA,CAAA4N,kDAAA,GAAA5N,+DAAA,CAAA8N,kGAAA,GAAA9N,+DAAA,CAAA+N,kEAAA;EAAA;EAAA,QAAAE,EAAA;UAlDnBvI,0BAA0B;IAAAwI,SAAA;IAAAC,SAAA,WAAAC,iCAAAC,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;;;;;;;;gFAFxB,CAAC1O,kGAAkB,CAAC;IAAA4O,KAAA;IAAAC,IAAA;IAAAC,MAAA;IAAAC,QAAA,WAAAC,oCAAAN,EAAA,EAAAC,GAAA;MAAA,IAAAD,EAAA;QCrCnCrO,wDAAA,IAAA4O,iDAAA,gCAAA5O,oEAAA,CAUc;QAEdA,wDAAA,IAAA6O,mDAAA,2BAYgB;QAEhB7O,wDAAA,IAAA8O,iDAAA,iCAAA9O,oEAAA,CAqDc;;;;QAlEXA,uDAAA,GAAY;QAAZA,wDAAA,SAAAsO,GAAA,CAAA/L,IAAA,CAAY,aAAAZ,GAAA;;;;;;;;;;;;;;;;;;;;;;;;;ACZiD;AACT;AACsB;;AAEvC;AAMhC,MAAOsN,uBAAuB;EAAA,QAAA7B,CAAA;qBAAvB6B,uBAAuB;EAAA;EAAA,QAAAhB,EAAA;UAAvBgB;EAAuB;EAAA,QAAAC,EAAA;cAFtBH,+DAAY,EAAEC,iEAAiB;EAAA;;;sHAEhCC,uBAAuB;IAAAE,YAAA,GAHjBzJ,sFAA0B;IAAA0J,OAAA,GAC/BL,+DAAY,EAAEC,iEAAiB;EAAA;AAAA","sources":["./src/app/features/dialogs/dialog-modules/file-chooser-dialog/file-chooser-dialog.component.ts","./src/app/features/dialogs/dialog-modules/file-chooser-dialog/file-chooser-dialog.component.html","./src/app/features/dialogs/dialog-modules/file-chooser-dialog/file-chooser-dialog.module.ts"],"sourcesContent":["import { AfterViewInit, Component, Inject, OnInit, TemplateRef, ViewChild } from '@angular/core';\nimport { MatTabChangeEvent } from '@angular/material/tabs';\nimport { TranslateService } from '@ngx-translate/core';\nimport * as rxjs from 'rxjs';\nimport { BehaviorSubject, Observable, Subject } from 'rxjs';\nimport { distinctUntilChanged, map, skip, switchMap, takeUntil, tap } from 'rxjs/operators';\nimport {\n    DialogButton,\n    Node,\n    NodeList,\n    RestCollectionService,\n    RestConnectorService,\n    RestConstants,\n    RestNodeService,\n} from '../../../../core-module/core.module';\nimport { Toast } from '../../../../services/toast';\nimport { UIHelper } from '../../../../core-ui-module/ui-helper';\nimport { WorkspaceExplorerComponent } from '../../../../pages/workspace-page/explorer/explorer.component';\nimport { CARD_DIALOG_DATA, CardDialogConfig } from '../../card-dialog/card-dialog-config';\nimport { CardDialogRef } from '../../card-dialog/card-dialog-ref';\nimport { FileChooserDialogData, FileChooserDialogResult } from './file-chooser-dialog-data';\nimport { BreadcrumbsService } from '../../../../shared/components/breadcrumbs/breadcrumbs.service';\nimport {\n    InteractionType,\n    ListItem,\n    ListSortConfig,\n    NodeDataSource,\n    NodeEntriesDisplayType,\n} from 'ngx-edu-sharing-ui';\n\nconst SINGLE_COLUMN_WIDTH = 600;\nconst MULTI_COLUMN_WIDTH = 900;\n\n@Component({\n    selector: 'es-file-chooser-dialog',\n    templateUrl: './file-chooser-dialog.component.html',\n    styleUrls: ['./file-chooser-dialog.component.scss'],\n    providers: [BreadcrumbsService],\n})\nexport class FileChooserDialogComponent implements OnInit, AfterViewInit {\n    @ViewChild('bottomBarContent') bottomBarContent: TemplateRef<HTMLElement>;\n\n    readonly InteractionType = InteractionType;\n    /**\n     * Path to show as breadcrumbs, beginning with the first item after the current home directory.\n     */\n    readonly path$ = new BehaviorSubject<Node[]>([]);\n    isLoading: boolean;\n    columns: ListItem[] = [];\n    sort: ListSortConfig;\n    selectedFiles: Node[] = [];\n    displayType = NodeEntriesDisplayType.Table;\n    searchMode: boolean;\n    searchQuery: string;\n    private defaultSubtitleSubject = new BehaviorSubject<string>(null);\n    private get defaultSubtitle(): string {\n        return this.defaultSubtitleSubject.value;\n    }\n    private set defaultSubtitle(value: string) {\n        this.defaultSubtitleSubject.next(value);\n    }\n    list = new NodeDataSource<Node>();\n    cardIcon: string;\n    hasHeading = true;\n    tabs = [\n        {\n            label: 'WORKSPACE.MY_FILES',\n            homeIcon: 'person',\n            directory: RestConstants.USERHOME,\n            canSelectHome: true,\n        },\n        {\n            label: 'WORKSPACE.SHARED_FILES',\n            homeIcon: 'group',\n            directory: RestConstants.SHARED_FILES,\n            canSelectHome: false,\n        },\n    ];\n    /** Replace home icon and -label given by tabs. */\n    homeOverride: {\n        label: string;\n        icon: string;\n    } = null;\n    private homeDirectory: string;\n    private currentDirectory: string;\n    canSelectHome: boolean;\n    private loadDirectoryTrigger = new Subject<{ directory: string; reset: boolean }>();\n\n    constructor(\n        @Inject(CARD_DIALOG_DATA) public data: FileChooserDialogData,\n        private dialogRef: CardDialogRef<FileChooserDialogData, FileChooserDialogResult>,\n        private connector: RestConnectorService,\n        private collectionApi: RestCollectionService,\n        private nodeApi: RestNodeService,\n        private toast: Toast,\n        private breadcrumbsService: BreadcrumbsService,\n        private translate: TranslateService,\n    ) {\n        // http://plnkr.co/edit/btpW3l0jr5beJVjohy1Q?p=preview\n        this.columns.push(new ListItem('NODE', RestConstants.CM_NAME));\n    }\n\n    ngOnInit(): void {\n        this.processDialogData();\n        this.registerObservables();\n        this.initialize();\n        this.setDialogConfig();\n        this.defaultSubtitleSubject\n            .pipe(\n                map((defaultSubtitle) => this.data.subtitle ?? defaultSubtitle),\n                distinctUntilChanged(),\n            )\n            .subscribe((subtitle) => this.dialogRef.patchConfig({ subtitle }));\n    }\n\n    ngAfterViewInit(): void {\n        this.dialogRef.patchConfig({ customBottomBarContent: this.bottomBarContent });\n    }\n\n    private setDialogConfig(): void {\n        const config: Partial<CardDialogConfig<FileChooserDialogData>> = {\n            title: this.data.title,\n            width: SINGLE_COLUMN_WIDTH,\n        };\n        this.dialogRef.patchConfig(config);\n        if (this.cardIcon) {\n            config.avatar = { kind: 'icon', icon: this.cardIcon };\n        }\n    }\n\n    folderIsWritable() {\n        return (\n            this.path$?.value?.[this.path$?.value?.length - 1]?.access?.indexOf(\n                RestConstants.ACCESS_WRITE,\n            ) !== -1\n        );\n    }\n\n    private registerObservables(): void {\n        this.loadDirectoryTrigger\n            .pipe(switchMap(({ directory, reset }) => this.loadDirectory(directory, reset)))\n            .subscribe();\n        this.path$.subscribe((path) => {\n            this.breadcrumbsService.setNodePath(path);\n            this.updateButtons();\n        });\n    }\n\n    onTabChange(event: MatTabChangeEvent) {\n        const tab = this.tabs[event.index];\n        this.setHomeDirectory(tab.directory, { canSelectHome: tab.canSelectHome });\n    }\n\n    private setHomeDirectory(directory: string, { canSelectHome = false }): void {\n        this.homeDirectory = directory;\n        // FIXME: confusing naming: `canSelectHome` doesn't relate to `selectHome`.\n        this.canSelectHome = canSelectHome;\n        this.selectHome();\n    }\n\n    onSelection(node: Node[]) {\n        this.selectedFiles = node;\n    }\n\n    private processDialogData() {\n        if (this.data.pickDirectory) {\n            this.cardIcon = 'folder';\n            this.data.filter.push(RestConstants.FILTER_FOLDERS);\n        }\n        if (this.data.collections) {\n            this.displayType = NodeEntriesDisplayType.SmallGrid;\n            this.tabs = null;\n            this.setHomeDirectory(RestConstants.ROOT, { canSelectHome: false });\n            this.hasHeading = false;\n            this.searchMode = true;\n            this.searchQuery = '';\n            this.columns = UIHelper.getDefaultCollectionColumns();\n            this.sort = {\n                active: RestConstants.CM_MODIFIED_DATE,\n                direction: 'desc',\n                columns: [],\n            };\n        } else {\n            this.columns = WorkspaceExplorerComponent.getColumns(this.connector);\n            this.columns = this.columns.map((c, i) => {\n                c.visible = i === 0;\n                return c;\n            });\n            this.sort = {\n                active: this.columns[0].name,\n                direction: 'asc',\n                allowed: true,\n                columns: RestConstants.POSSIBLE_SORT_BY_FIELDS.filter((s) =>\n                    this.columns.some((c) => c.name === s.name),\n                ),\n            };\n        }\n    }\n\n    private initialize() {\n        if (this.homeDirectory) {\n            this.viewDirectory(this.homeDirectory);\n        } else {\n            this.setHomeDirectory(this.tabs[0].directory, {\n                canSelectHome: this.tabs[0].canSelectHome,\n            });\n        }\n    }\n\n    hasWritePermissions(node: any) {\n        if (node.access.indexOf(RestConstants.ACCESS_WRITE) == -1) {\n            return { status: false, message: 'NO_WRITE_PERMISSIONS' };\n        }\n        return { status: true };\n    }\n\n    selectBreadcrumb(position: number) {\n        if (position === 0) {\n            this.selectHome();\n        } else {\n            this.selectItem(this.path$.value[position - 1]);\n        }\n    }\n\n    selectHome() {\n        this.homeOverride = null;\n        this.path$.next([]);\n        this.viewDirectory(this.homeDirectory, true);\n    }\n\n    selectItem(event: Node) {\n        if (event.isDirectory || this.data.collections) {\n            if (this.searchMode) {\n                this.selectedFiles = [event];\n                this.updateButtons();\n                return;\n            }\n            this.selectedFiles = [];\n            if (this.path$.value?.[this.path$.value.length - 1]?.ref.id === event.parent.id) {\n                // We selected the direct child of our previous node. Can update the path in place.\n                this.path$.next([...this.path$.value, event]);\n            } else if (this.path$.value?.some((ancestor) => ancestor.ref.id === event.ref.id)) {\n                // We selected an ancestor of our previous node. Can update the path in place.\n                const index = this.path$.value.findIndex(\n                    (ancestor) => ancestor.ref.id === event.ref.id,\n                );\n                this.path$.next(this.path$.value.slice(0, index + 1));\n            } else {\n                // Couldn't update the path in place, load from backend.\n                if (this.path$.value.length === 0) {\n                    // We probably just selected a child of the home directory. Optimistically\n                    // update accordingly, but fetch the actual data below anyway.\n                    this.path$.next([event]);\n                }\n                this.updatePathFromBackend(event.ref.id)\n                    // Abort when new directory is loaded before we could update the path.\n                    .pipe(takeUntil(this.loadDirectoryTrigger.pipe(skip(1))))\n                    .subscribe();\n            }\n            this.viewDirectory(event.ref.id);\n        }\n    }\n\n    private updatePathFromBackend(id: string) {\n        return this.nodeApi.getNodeParents(id).pipe(\n            tap((data) => {\n                this.path$.next(data.nodes.reverse());\n                // When `scope` is not set, we didn't get the children of our home directory but\n                // instead a path relative to root. This happens for the admin user.\n                if (!data.scope) {\n                    this.homeOverride = {\n                        label: null,\n                        icon: data.scope === 'SHARED_FILES' ? 'group' : 'person',\n                    };\n                }\n            }),\n        );\n    }\n\n    onSelectionChanged(event: Node[]): void {\n        // Triggered in collection mode.\n        this.selectedFiles = event;\n        this.updateButtons();\n    }\n\n    search() {\n        this.viewDirectory(this.homeDirectory);\n    }\n\n    private viewDirectory(directory: string, reset = true) {\n        this.loadDirectoryTrigger.next({ directory, reset });\n    }\n\n    private loadDirectory(directory: string, reset = true): Observable<void> {\n        this.currentDirectory = directory;\n        if (reset) {\n            this.list.reset();\n            // this.hasMoreToLoad = true; // !this.data.collections; // Collections have no paging\n        }\n        this.isLoading = true;\n        if (this.data.collections) {\n            return this.collectionApi\n                .search(this.searchQuery, {\n                    offset: this.list.getData().length,\n                    sortBy: [this.sort.active],\n                    sortAscending: this.sort.direction === 'asc',\n                    propertyFilter: [RestConstants.ALL],\n                })\n                .pipe(\n                    tap((data) => {\n                        const list: Node[] = [];\n                        for (const c of data.collections) {\n                            const obj: any = c;\n                            // dummy for list-table so it recognizes a collection\n                            obj.collection = c;\n                            list.push(obj);\n                        }\n                        this.showList({\n                            pagination: data.pagination,\n                            nodes: list,\n                        });\n                    }),\n                    map(() => {}),\n                );\n        } else {\n            return this.nodeApi\n                .getChildren(directory, this.data.filter, {\n                    offset: this.list.getData().length,\n                    sortBy: [this.sort.active],\n                    sortAscending: this.sort.direction === 'asc',\n                    propertyFilter: [RestConstants.ALL],\n                })\n                .pipe(\n                    tap((list: NodeList) => {\n                        this.showList(list);\n                    }),\n                    map(() => {}),\n                );\n        }\n    }\n\n    loadMore() {\n        if (!this.list.hasMore()) {\n            return;\n        }\n        this.viewDirectory(this.currentDirectory, false);\n        this.isLoading = true;\n    }\n\n    setSorting(data: ListSortConfig) {\n        this.sort = data;\n        this.list.reset();\n        this.viewDirectory(this.currentDirectory);\n    }\n\n    private showList(list: NodeList) {\n        this.addToList(list);\n        this.updateButtons();\n        this.isLoading = false;\n    }\n\n    cancel() {\n        this.dialogRef.close(null);\n    }\n\n    private addToList(list: NodeList) {\n        this.isLoading = false;\n        if (!list.nodes.length) {\n            return;\n        }\n        this.list.setPagination(list.pagination);\n        this.list.appendData(list.nodes);\n    }\n\n    private chooseDirectory() {\n        (() => {\n            if (this.path$.value.length) {\n                return rxjs.of(this.path$.value[this.path$.value.length - 1]);\n            } else {\n                return this.nodeApi\n                    .getNodeMetadata(this.homeDirectory)\n                    .pipe(map((nodeWrapper) => nodeWrapper.node));\n            }\n        })().subscribe((node) => {\n            if (this.data.collections) {\n                if (node.access.indexOf(RestConstants.ACCESS_WRITE) === -1) {\n                    this.toast.error(null, 'NO_WRITE_PERMISSIONS');\n                    return;\n                }\n            }\n            this.dialogRef.close([node]);\n        });\n    }\n\n    private chooseFile() {\n        if (this.data.collections) {\n            if (this.selectedFiles[0].access.indexOf(RestConstants.ACCESS_WRITE) == -1) {\n                this.toast.error(null, 'NO_WRITE_PERMISSIONS');\n                return;\n            }\n        }\n        this.dialogRef.close(this.selectedFiles);\n    }\n\n    updateButtons() {\n        const buttons = [\n            new DialogButton(this.translate.instant('CANCEL'), { color: 'standard' }, () =>\n                this.cancel(),\n            ),\n        ];\n        let confirmButton;\n        if (this.data.pickDirectory) {\n            if (this.path$.value.length) {\n                this.defaultSubtitle = this.path$.value[this.path$.value.length - 1].name;\n            } else {\n                this.defaultSubtitle = this.translate.instant('SELECT_ROOT_NAME');\n            }\n            confirmButton = new DialogButton(\n                this.translate.instant('APPLY'),\n                { color: 'primary' },\n                () => this.chooseDirectory(),\n            );\n            confirmButton.disabled =\n                (!this.path$.value.length && !this.canSelectHome) || !this.folderIsWritable();\n        } else if (this.data.collections && !this.selectedFiles.length) {\n            this.defaultSubtitle = null;\n            confirmButton = new DialogButton(\n                'SELECT_ROOT_DISABLED',\n                { color: 'primary' },\n                () => {},\n            );\n            confirmButton.disabled = true;\n        } else if (this.selectedFiles.length) {\n            this.defaultSubtitle = this.selectedFiles[0].name;\n            confirmButton = new DialogButton(\n                this.translate.instant(\n                    this.data.collections ? 'SELECT_COLLECTION' : 'SELECT_FILE',\n                    {\n                        name: this.defaultSubtitle,\n                    },\n                ),\n                { color: 'primary' },\n                () => this.chooseFile(),\n            );\n            confirmButton.disabled =\n                this.data.writeRequired &&\n                this.hasWritePermissions(this.selectedFiles[0]).status == false;\n        }\n        if (confirmButton) {\n            buttons.push(confirmButton);\n        }\n        this.dialogRef.patchConfig({ buttons });\n    }\n\n    checkColumnState(event: ListItem[]) {\n        if (event.filter((i) => i.visible).length > 1) {\n            this.dialogRef.patchConfig({ width: MULTI_COLUMN_WIDTH });\n        } else {\n            this.dialogRef.patchConfig({ width: SINGLE_COLUMN_WIDTH });\n        }\n    }\n}\n","<ng-template #bottomBarContent>\n  <div\n    *ngIf=\"!data.collections && !this.path$.value.length && !this.canSelectHome\"\n    class=\"no-permissions\"\n  >\n    {{ 'WORKSPACE.FILE_CHOOSER.HOME_FOLDER_NO_PERMISSIONS' | translate }}\n  </div>\n  <div *ngIf=\"!folderIsWritable()\" class=\"no-permissions\">\n    {{ 'WORKSPACE.FILE_CHOOSER.NO_WRITE_PERMISSIONS' | translate }}\n  </div>\n</ng-template>\n\n<mat-tab-group\n  *ngIf=\"tabs; else tabContent\"\n  mat-stretch-tabs\n  (selectedTabChange)=\"onTabChange($event)\"\n>\n  <mat-tab *ngFor=\"let tab of tabs\">\n    <ng-template mat-tab-label>\n      <i [esIcon]=\"tab.homeIcon\" class=\"tab-icon\"></i>\n      <span class=\"tab-label\">{{ tab.label | translate }}</span>\n    </ng-template>\n    <ng-container *ngTemplateOutlet=\"tabContent; context: tab\"></ng-container>\n  </mat-tab>\n</mat-tab-group>\n\n<ng-template #tabContent let-homeIcon=\"homeIcon\" let-label=\"label\">\n  <div class=\"tab-content\">\n    <es-breadcrumbs\n      class=\"breadcrumbFrame\"\n      *ngIf=\"!searchMode\"\n      [createLink]=\"false\"\n      (onClick)=\"selectBreadcrumb($event)\"\n      [home]=\"homeOverride ? homeOverride.label : (label | translate)\"\n      [homeIcon]=\"homeOverride ? homeOverride.icon : homeIcon\"\n    ></es-breadcrumbs>\n    <div *ngIf=\"searchMode\" class=\"searchInputFrame\">\n      <form (ngSubmit)=\"search()\" autocomplete=\"off\">\n        <mat-form-field floatLabel=\"always\">\n          <mat-label></mat-label>\n          <i esIcon=\"search\" matPrefix></i>\n          <input\n            matInput\n            type=\"search\"\n            name=\"search\"\n            placeholder=\"{{ 'NODE_SEARCH' | translate }}\"\n            [(ngModel)]=\"searchQuery\"\n          />\n        </mat-form-field>\n      </form>\n    </div>\n\n    <es-node-entries-wrapper\n      class=\"fileChooserList\"\n      [dataSource]=\"list\"\n      [columns]=\"columns\"\n      [configureColumns]=\"true\"\n      [displayType]=\"displayType\"\n      [checkbox]=\"false\"\n      [sort]=\"sort\"\n      [elementInteractionType]=\"InteractionType.Emitter\"\n      (columnsChange)=\"checkColumnState($event)\"\n      (sortChange)=\"setSorting($event)\"\n      (clickItem)=\"selectItem($event.element)\"\n      (fetchData)=\"loadMore()\"\n      esInfiniteScroll\n      [scrollWindow]=\"false\"\n      (scrolled)=\"loadMore()\"\n    >\n      <ng-template #empty>\n        <h5 class=\"noElements\" *ngIf=\"!searchMode\">\n          {{ 'NO_MORE_ELEMENTS' | translate }}\n        </h5>\n        <h5 class=\"noElements\" *ngIf=\"searchMode\">\n          {{ 'NO_MATCHES' | translate }}\n        </h5>\n      </ng-template>\n    </es-node-entries-wrapper>\n  </div>\n</ng-template>\n","import { NgModule } from '@angular/core';\nimport { SharedModule } from '../../../../shared/shared.module';\nimport { NodeEntriesModule } from 'ngx-edu-sharing-ui';\nimport { FileChooserDialogComponent } from './file-chooser-dialog.component';\n\nexport { FileChooserDialogComponent };\n\n@NgModule({\n    declarations: [FileChooserDialogComponent],\n    imports: [SharedModule, NodeEntriesModule],\n})\nexport class FileChooserDialogModule {}\n"],"names":["rxjs","BehaviorSubject","Subject","distinctUntilChanged","map","skip","switchMap","takeUntil","tap","DialogButton","RestConstants","UIHelper","WorkspaceExplorerComponent","CARD_DIALOG_DATA","BreadcrumbsService","InteractionType","ListItem","NodeDataSource","NodeEntriesDisplayType","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ɵɵpipeBind1","ɵɵtemplate","FileChooserDialogComponent_ng_template_0_div_0_Template","FileChooserDialogComponent_ng_template_0_div_1_Template","ɵɵproperty","ctx_r1","data","collections","path$","value","length","canSelectHome","folderIsWritable","ɵɵelement","tab_r8","homeIcon","ɵɵtextInterpolate","label","ɵɵelementContainer","FileChooserDialogComponent_mat_tab_group_2_mat_tab_1_ng_template_1_Template","FileChooserDialogComponent_mat_tab_group_2_mat_tab_1_ng_container_2_Template","_r3","ɵɵlistener","FileChooserDialogComponent_mat_tab_group_2_Template_mat_tab_group_selectedTabChange_0_listener","$event","ɵɵrestoreView","_r13","ctx_r12","ɵɵnextContext","ɵɵresetView","onTabChange","FileChooserDialogComponent_mat_tab_group_2_mat_tab_1_Template","ctx_r2","tabs","FileChooserDialogComponent_ng_template_3_es_breadcrumbs_1_Template_es_breadcrumbs_onClick_0_listener","_r21","ctx_r20","selectBreadcrumb","ctx_r16","homeOverride","label_r15","icon","homeIcon_r14","FileChooserDialogComponent_ng_template_3_div_2_Template_form_ngSubmit_1_listener","_r24","ctx_r23","search","FileChooserDialogComponent_ng_template_3_div_2_Template_input_ngModelChange_5_listener","ctx_r25","searchQuery","ɵɵpropertyInterpolate","ctx_r17","FileChooserDialogComponent_ng_template_3_ng_template_4_h5_0_Template","FileChooserDialogComponent_ng_template_3_ng_template_4_h5_1_Template","ctx_r19","searchMode","FileChooserDialogComponent_ng_template_3_es_breadcrumbs_1_Template","FileChooserDialogComponent_ng_template_3_div_2_Template","FileChooserDialogComponent_ng_template_3_Template_es_node_entries_wrapper_columnsChange_3_listener","_r29","ctx_r28","checkColumnState","FileChooserDialogComponent_ng_template_3_Template_es_node_entries_wrapper_sortChange_3_listener","ctx_r30","setSorting","FileChooserDialogComponent_ng_template_3_Template_es_node_entries_wrapper_clickItem_3_listener","ctx_r31","selectItem","element","FileChooserDialogComponent_ng_template_3_Template_es_node_entries_wrapper_fetchData_3_listener","ctx_r32","loadMore","FileChooserDialogComponent_ng_template_3_Template_es_node_entries_wrapper_scrolled_3_listener","ctx_r33","FileChooserDialogComponent_ng_template_3_ng_template_4_Template","ɵɵtemplateRefExtractor","ctx_r4","list","columns","displayType","sort","Emitter","SINGLE_COLUMN_WIDTH","MULTI_COLUMN_WIDTH","FileChooserDialogComponent","defaultSubtitle","defaultSubtitleSubject","next","constructor","dialogRef","connector","collectionApi","nodeApi","toast","breadcrumbsService","translate","selectedFiles","Table","hasHeading","directory","USERHOME","SHARED_FILES","loadDirectoryTrigger","push","CM_NAME","ngOnInit","processDialogData","registerObservables","initialize","setDialogConfig","pipe","subtitle","subscribe","patchConfig","ngAfterViewInit","customBottomBarContent","bottomBarContent","config","title","width","cardIcon","avatar","kind","access","indexOf","ACCESS_WRITE","reset","loadDirectory","path","setNodePath","updateButtons","event","tab","index","setHomeDirectory","homeDirectory","selectHome","onSelection","node","pickDirectory","filter","FILTER_FOLDERS","SmallGrid","ROOT","getDefaultCollectionColumns","active","CM_MODIFIED_DATE","direction","getColumns","c","i","visible","name","allowed","POSSIBLE_SORT_BY_FIELDS","s","some","viewDirectory","hasWritePermissions","status","message","position","isDirectory","ref","id","parent","ancestor","findIndex","slice","updatePathFromBackend","getNodeParents","nodes","reverse","scope","onSelectionChanged","currentDirectory","isLoading","offset","getData","sortBy","sortAscending","propertyFilter","ALL","obj","collection","showList","pagination","getChildren","hasMore","addToList","cancel","close","setPagination","appendData","chooseDirectory","of","getNodeMetadata","nodeWrapper","error","chooseFile","buttons","instant","color","confirmButton","disabled","writeRequired","_","ɵɵdirectiveInject","i1","CardDialogRef","i2","RestConnectorService","RestCollectionService","RestNodeService","i3","Toast","i4","i5","TranslateService","_2","selectors","viewQuery","FileChooserDialogComponent_Query","rf","ctx","decls","vars","consts","template","FileChooserDialogComponent_Template","FileChooserDialogComponent_ng_template_0_Template","FileChooserDialogComponent_mat_tab_group_2_Template","FileChooserDialogComponent_ng_template_3_Template","SharedModule","NodeEntriesModule","FileChooserDialogModule","_3","declarations","imports"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}