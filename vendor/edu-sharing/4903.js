"use strict";(self.webpackChunkapp_as_web_component=self.webpackChunkapp_as_web_component||[]).push([[4903],{54903:(ne,L,a)=>{a.r(L),a.d(L,{CollectionsPageModule:()=>$n});var P=a(2962),N=a(50555),T=a(22941),C=a(15861),r=a(52081),l=a(81771),m=a(90721),Z=a(99994),X=a(54699),I=a(72079),e=a(65879),f=a(76754),g=a(96814),D=a(1189),k=a(34997),U=a(6593),v=a(48098),x=a(71365),oe=a(63030),$=a(5178),ie=a(36692),me=a(4300),Oe=a(13838),Y=a(56223),fe=a(94618),w=a(32296),ce=a(64170),Te=a(24516),le=a(82599),Ee=a(12883),se=a(19374),Pe=a(87548);const Ie=["mds"],ve=["organizations"],be=["file"],xe=["authorFreetextInput"];function Me(n,o){1&n&&e._UZ(0,"es-global-progress")}function Se(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",15),e.NdJ("click",function(){const c=e.CHM(t),s=c.index,u=c.$implicit,O=e.oxw(3);return e.KtG(s<O.currentStepPosition()?O.newCollectionStep=u:null)}),e._UZ(1,"div",13)(2,"i",16),e.TgZ(3,"div",14),e._uU(4),e.ALo(5,"translate"),e.qZA(),e._UZ(6,"div",17),e.qZA()}if(2&n){const t=o.$implicit,i=o.index,c=e.oxw(3);e.ekj("current",t===c.newCollectionStep)("finished",i<c.currentStepPosition()),e.xp6(2),e.Q6J("esIcon",c.STEP_ICONS[t]),e.xp6(2),e.Oqu(e.lcZ(5,6,"COLLECTIONS.STEP."+t))}}function Le(n,o){if(1&n&&(e.TgZ(0,"div",10),e.YNc(1,Se,7,8,"div",11),e.TgZ(2,"div",12),e._UZ(3,"div",13),e.TgZ(4,"div",14),e._uU(5),e.ALo(6,"translate"),e.qZA()()()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.availableSteps),e.xp6(4),e.Oqu(e.lcZ(6,2,"COLLECTIONS.STEP.DONE"))}}function Ne(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(3);return e.KtG(c.setCollectionType("CUSTOM"))}),e.TgZ(1,"div",21),e._UZ(2,"i",30),e.qZA(),e.TgZ(3,"div",23)(4,"div",24),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",25),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e._UZ(10,"i",26),e.qZA()}2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,2,"COLLECTIONS.CREATE.SHARED")),e.xp6(3),e.Oqu(e.lcZ(9,4,"COLLECTIONS.CREATE.SHARED_DESCRIPTION")))}function we(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(3);return e.KtG(c.setCollectionType("EDU_ALL"))}),e.TgZ(1,"div",21),e._UZ(2,"i",31),e.qZA(),e.TgZ(3,"div",23)(4,"div",24),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",25),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e._UZ(10,"i",26),e.qZA()}2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,2,"COLLECTIONS.CREATE.PUBLIC")),e.xp6(3),e.Oqu(e.lcZ(9,4,"COLLECTIONS.CREATE.PUBLIC_DESCRIPTION")))}function Ae(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(4);return e.KtG(c.setCollectionType("EDITORIAL"))}),e.TgZ(1,"div",21),e._UZ(2,"i",33),e.qZA(),e.TgZ(3,"div",23)(4,"div",24),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",25),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e._UZ(10,"i",26),e.qZA()}2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,2,"COLLECTIONS.CREATE.EDITORIAL")),e.xp6(3),e.hij(" ",e.lcZ(9,4,"COLLECTIONS.CREATE.EDITORIAL_DESCRIPTION")," "))}function Re(n,o){if(1&n&&(e.TgZ(0,"div",32),e.YNc(1,Ae,11,6,"button",27),e.qZA()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.createEditorial)}}function ye(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(3);return e.KtG(c.setCollectionType("MEDIA_CENTER"))}),e.TgZ(1,"div",21),e._UZ(2,"i",34),e.qZA(),e.TgZ(3,"div",23)(4,"div",24),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"div",25),e._uU(8),e.ALo(9,"translate"),e.qZA()(),e._UZ(10,"i",26),e.qZA()}2&n&&(e.xp6(5),e.Oqu(e.lcZ(6,2,"COLLECTIONS.CREATE.MEDIA_CENTER")),e.xp6(3),e.hij(" ",e.lcZ(9,4,"COLLECTIONS.CREATE.MEDIA_CENTER_DESCRIPTION")," "))}function Ze(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"es-card",18),e.NdJ("onCancel",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.newCollectionCancel())}),e.ALo(1,"translate"),e.TgZ(2,"div",19)(3,"button",20),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.setCollectionType("MY"))}),e.TgZ(4,"div",21),e._UZ(5,"i",22),e.qZA(),e.TgZ(6,"div",23)(7,"div",24),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"div",25),e._uU(11),e.ALo(12,"translate"),e.qZA()(),e._UZ(13,"i",26),e.qZA(),e.YNc(14,Ne,11,6,"button",27),e.YNc(15,we,11,6,"button",27),e.YNc(16,Re,2,1,"div",28),e.YNc(17,ye,11,6,"button",27),e.qZA()()}if(2&n){const t=e.oxw(2);e.s9C("title",e.lcZ(1,7,"COLLECTIONS.CREATE_TYPE")),e.xp6(8),e.Oqu(e.lcZ(9,9,"COLLECTIONS.CREATE.PRIVATE")),e.xp6(3),e.hij(" ",e.lcZ(12,11,"COLLECTIONS.CREATE.PRIVATE_DESCRIPTION")," "),e.xp6(3),e.Q6J("ngIf",t.canInvite),e.xp6(1),e.Q6J("ngIf",t.shareToAll&&t.canInvite),e.xp6(1),e.Q6J("ngIf",t.createEditorial&&t.shareToAll),e.xp6(1),e.Q6J("ngIf",t.createMediacenter)}}function De(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",55),e.NdJ("keyup.enter",function(){e.CHM(t),e.oxw();const c=e.MAs(6);return e.KtG(c.click())})("click",function(){e.CHM(t),e.oxw();const c=e.MAs(6);return e.KtG(c.click())}),e._UZ(1,"div",56),e.TgZ(2,"div",57),e._UZ(3,"i",58),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(2),e.Udp("background-color",t.currentCollection.collection.color)}}const re=function(){return{maxWidth:300,maxHeight:300,crop:!0}};function ke(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",55),e.NdJ("keyup.enter",function(){e.CHM(t),e.oxw();const c=e.MAs(6);return e.KtG(c.click())})("click",function(){e.CHM(t),e.oxw();const c=e.MAs(6);return e.KtG(c.click())}),e._UZ(1,"img",59),e.ALo(2,"async"),e.ALo(3,"esNodeImage"),e._UZ(4,"img",60),e.ALo(5,"async"),e.ALo(6,"esNodeImage"),e.qZA()}if(2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("src",e.lcZ(2,2,e.xi3(3,4,t.currentCollection,e.DdM(12,re))),e.LSH),e.xp6(3),e.Q6J("src",e.lcZ(5,7,e.xi3(6,9,t.currentCollection,e.DdM(13,re))),e.LSH)}}function Ue(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",61),e.NdJ("keyup.enter",function(){e.CHM(t),e.oxw();const c=e.MAs(6);return e.KtG(c.click())})("click",function(){e.CHM(t),e.oxw();const c=e.MAs(6);return e.KtG(c.click())}),e.TgZ(1,"div",62),e._UZ(2,"img",59)(3,"img",60),e.qZA()()}if(2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("src",t.imageData,e.LSH),e.xp6(1),e.Q6J("src",t.imageData,e.LSH)}}const Ye=function(n){return{thing:n}};function Ge(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",65),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(4);return e.KtG(c.switchToAuthorFreetext())}),e.ALo(1,"translate"),e.ALo(2,"translate"),e._UZ(3,"i",66),e.qZA()}2&n&&e.uIk("aria-label",e.xi3(1,1,"EDIT",e.VKq(6,Ye,e.lcZ(2,4,"COLLECTIONS.NEW.AUTHOR_FREETEXT"))))}function Je(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"i",63),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"authorityName"),e.qZA(),e.YNc(5,Ge,4,8,"button",64),e.BQk()),2&n){const t=e.oxw(3);e.xp6(3),e.Oqu(e.lcZ(4,2,t.user)),e.xp6(2),e.Q6J("ngIf",t.authorFreetextAllowed)}}function Fe(n,o){if(1&n){const t=e.EpF();e.ynx(0),e._UZ(1,"i",63),e.TgZ(2,"mat-form-field",67)(3,"mat-label",68),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"input",69,70),e.NdJ("ngModelChange",function(c){e.CHM(t);const s=e.oxw(3);return e.KtG(s.currentCollection.collection.authorFreetext=c)}),e.qZA()(),e.TgZ(8,"button",71),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(3);return e.KtG(c.cancelAuthorFreetext())}),e.ALo(9,"translate"),e._UZ(10,"i",72),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(3);e.xp6(2),e.ekj("mat-form-field-bright",!t.isBrightColor()),e.xp6(2),e.hij(" ",e.lcZ(5,6,"COLLECTIONS.NEW.AUTHOR_FREETEXT")," "),e.xp6(2),e.Q6J("disabled",!t.authorFreetextAllowed)("ngModel",t.currentCollection.collection.authorFreetext),e.xp6(2),e.uIk("aria-label",e.lcZ(9,8,"CANCEL"))}}const Qe=function(n){return{"color-selected":n}},He=function(n){return{index:n}};function Be(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"li",73),e.NdJ("click",function(){const s=e.CHM(t).$implicit,u=e.oxw(3);return e.KtG(u.setColor(s))}),e.TgZ(1,"span",74),e._uU(2),e.ALo(3,"translate"),e.qZA()()}if(2&n){const t=o.$implicit,i=o.index,c=e.oxw(3);e.Udp("background-color",t),e.MGl("id","collection-new-color-picker-option-",i,""),e.Q6J("ngClass",e.VKq(9,Qe,c.currentCollection.collection.color===t)),e.uIk("aria-selected",c.currentCollection.collection.color===t),e.xp6(2),e.hij(" ",e.xi3(3,6,"collectionNew_colorIndex",e.VKq(11,He,i+1))," ")}}function qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"es-card",35),e.NdJ("onCancel",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.newCollectionCancel())}),e.ALo(1,"translate"),e.TgZ(2,"div",36)(3,"div",37)(4,"div",38)(5,"input",39,40),e.NdJ("change",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.imageDataChanged(c))}),e.qZA()(),e.TgZ(7,"div",41),e._UZ(8,"es-actionbar",42),e.qZA(),e.YNc(9,De,4,2,"div",43),e.YNc(10,ke,7,14,"div",43),e.YNc(11,Ue,4,2,"div",44),e.qZA(),e.TgZ(12,"div",45),e._UZ(13,"div",46),e.TgZ(14,"div",47)(15,"mat-form-field")(16,"mat-label"),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"input",48),e.NdJ("ngModelChange",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.currentCollection.title=c)}),e.qZA()(),e.TgZ(20,"mat-form-field")(21,"mat-label"),e._uU(22),e.ALo(23,"translate"),e.qZA(),e.TgZ(24,"textarea",49),e.NdJ("ngModelChange",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.currentCollection.collection.description=c)}),e.qZA()()(),e.TgZ(25,"div",50),e.YNc(26,Je,6,4,"ng-container",1),e.YNc(27,Fe,11,10,"ng-container",1),e.qZA(),e.TgZ(28,"div",51)(29,"div",52),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"ul",53),e.NdJ("keydown.arrowright",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setColorByDirection(c))})("keydown.arrowup",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setColorByDirection(c))})("keydown.arrowleft",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setColorByDirection(c))})("keydown.arrowdown",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setColorByDirection(c))}),e.YNc(33,Be,4,13,"li",54),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.s9C("title",e.lcZ(1,31,"collectionNew_preview")),e.Q6J("buttons",t.buttons)("isCancelable",!0)("subtitle",t.currentCollection.title),e.xp6(8),e.Q6J("options",t.imageOptions)("numberOfAlwaysVisibleOptions",0)("numberOfAlwaysVisibleOptionsMobile",0),e.xp6(1),e.Q6J("ngIf",!(t.imageData||t.currentCollection.preview&&!t.currentCollection.preview.isIcon)),e.xp6(1),e.Q6J("ngIf",!t.imageData&&t.currentCollection.preview&&!t.currentCollection.preview.isIcon),e.xp6(1),e.Q6J("ngIf",t.imageData),e.xp6(1),e.Udp("background-color",t.currentCollection.collection.color),e.ekj("dark-color",t.isBrightColor()),e.xp6(3),e.ekj("mat-form-field-bright",!t.isBrightColor())("mat-form-field-dark",t.isBrightColor()),e.xp6(2),e.Oqu(e.lcZ(18,33,"collectionNew_placeholderTitle")),e.xp6(2),e.Q6J("ngModel",t.currentCollection.title),e.xp6(1),e.ekj("mat-form-field-bright",!t.isBrightColor())("mat-form-field-dark",t.isBrightColor()),e.xp6(2),e.Oqu(e.lcZ(23,35,"collectionNew_placeholderDescription")),e.xp6(2),e.Q6J("ngModel",t.currentCollection.collection.description),e.xp6(2),e.Q6J("ngIf",!t.authorFreetext),e.xp6(1),e.Q6J("ngIf",t.authorFreetext),e.xp6(3),e.hij(" ",e.lcZ(31,37,"collectionNew_setColor")," "),e.xp6(2),e.uIk("aria-activedescendant",-1!==t.COLORS.indexOf(t.currentCollection.collection.color)?"collection-new-color-picker-option-"+t.COLORS.indexOf(t.currentCollection.collection.color):null),e.xp6(1),e.Q6J("ngForOf",t.COLORS)}}function je(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"es-card",75),e.NdJ("onCancel",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.newCollectionCancel())}),e.ALo(1,"translate"),e.TgZ(2,"div",76),e._UZ(3,"es-mds-editor-wrapper",77,78),e.qZA()()}if(2&n){const t=e.oxw(2);e.s9C("title",e.lcZ(1,9,"COLLECTIONS.STEP.METADATA")),e.Q6J("subtitle",t.currentCollection.title)("isCancelable",!0)("buttons",t.buttons),e.xp6(3),e.Q6J("groupId","collection_"+t.newCollectionType.toLowerCase())("setId",t.mdsSet)("editorMode","form")("embedded",!0)("currentValues",t.properties)}}function Ke(n,o){1&n&&(e.TgZ(0,"div",90)(1,"h4"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"h5"),e._uU(5),e.ALo(6,"translate"),e.qZA()()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"TOOLPERMISSION_ERROR_HEADER")),e.xp6(3),e.Oqu(e.lcZ(6,4,"TOOLPERMISSION.TOOLPERMISSION_INVITE_ALLAUTHORITIES")))}function We(n,o){1&n&&(e.TgZ(0,"div",91),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"COLLECTIONS.NO_EDITORIAL_GROUPS")))}const Ve=function(){return[]},ze=function(n){return{active:null,direction:"asc",columns:n,allowed:!1}};function Xe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"es-card",79),e.NdJ("onCancel",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.newCollectionCancel())}),e.ALo(1,"translate"),e.TgZ(2,"div",80)(3,"div",81),e.YNc(4,Ke,7,6,"div",82),e.TgZ(5,"es-node-entries-wrapper",83,84),e.NdJ("clickItem",function(c){e.CHM(t);const s=e.MAs(6);return e.KtG(s.getSelection().toggle(c.element))}),e.YNc(7,We,3,3,"ng-template",null,85,e.W1O),e.qZA()(),e.TgZ(9,"div",86)(10,"mat-slide-toggle",87),e.NdJ("ngModelChange",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.editorialPublic=c)}),e.TgZ(11,"es-multi-line-label"),e.ynx(12,88),e._uU(13),e.ALo(14,"translate"),e.BQk(),e.ynx(15,89),e._uU(16),e.ALo(17,"translate"),e.BQk(),e.qZA()()()()()}if(2&n){const t=e.oxw(2);e.s9C("title",e.lcZ(1,13,"COLLECTIONS.STEP.EDITORIAL_GROUPS")),e.Q6J("subtitle",t.currentCollection.title)("isCancelable",!0)("buttons",t.buttons),e.xp6(4),e.Q6J("ngIf",!t.shareToAll),e.xp6(1),e.Q6J("dataSource",t.editorialGroups)("displayType",t.NodeEntriesDisplayType.Table)("columns",t.editorialColumns)("sort",e.VKq(20,ze,e.DdM(19,Ve)))("elementInteractionType",t.InteractionType.Emitter),e.xp6(5),e.Q6J("ngModel",t.editorialPublic),e.xp6(3),e.hij(" ",e.lcZ(14,15,"COLLECTIONS.EDITORIAL_PUBLIC")," "),e.xp6(3),e.hij(" ",e.lcZ(17,17,"COLLECTIONS.EDITORIAL_PUBLIC_INFO")," ")}}function $e(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"es-card",92),e.NdJ("onCancel",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.newCollectionCancel())}),e.ALo(1,"translate"),e.TgZ(2,"div",76)(3,"div",24),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",25),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",93)(10,"button",94),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.editPermissions())}),e._UZ(11,"i",95),e._uU(12),e.ALo(13,"translate"),e.qZA()(),e.TgZ(14,"div",96),e._uU(15),e.ALo(16,"translate"),e.qZA()()()}if(2&n){const t=e.oxw(2);e.s9C("title",e.lcZ(1,8,"COLLECTIONS.EDIT_PERMISSIONS")),e.Q6J("isCancelable",!0)("buttons",t.buttons)("subtitle",t.currentCollection.title),e.xp6(4),e.Oqu(e.lcZ(5,10,"COLLECTIONS.EDIT_PERMISSIONS_SUBTEXT")),e.xp6(3),e.Oqu(e.lcZ(8,12,"COLLECTIONS.EDIT_PERMISSIONS_DESCRIPTION")),e.xp6(5),e.hij("",e.lcZ(13,14,"COLLECTIONS.EXTENDED_PERMISSIONS_BUTTON")," "),e.xp6(3),e.hij(" ",e.lcZ(16,16,"COLLECTIONS.PERMISSIONS_STATUS_"+t.getShareStatus())," ")}}function et(n,o){if(1&n&&(e.TgZ(0,"div",3),e.YNc(1,Le,7,4,"div",4),e.YNc(2,Ze,18,13,"es-card",5),e.YNc(3,qe,34,39,"es-card",6),e.YNc(4,je,5,11,"es-card",7),e.YNc(5,Xe,18,22,"es-card",8),e.YNc(6,$e,17,18,"es-card",9),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.newCollectionStep!==t.STEP_NEW),e.xp6(1),e.Q6J("ngIf",t.newCollectionStep===t.STEP_NEW),e.xp6(1),e.Q6J("ngIf",t.newCollectionStep===t.STEP_GENERAL),e.xp6(1),e.Q6J("ngIf",t.newCollectionStep===t.STEP_METADATA),e.xp6(1),e.Q6J("ngIf",t.newCollectionStep===t.STEP_EDITORIAL_GROUPS),e.xp6(1),e.Q6J("ngIf",t.newCollectionStep===t.STEP_PERMISSIONS)}}let tt=(()=>{class n{handleKeyboardEvent(t){if("Escape"==t.code)return t.preventDefault(),t.stopPropagation(),void this.goBack()}setCollection(t){return new X.y(i=>{const c=t.ref.id;this.nodeService.getNodePermissions(c).subscribe(s=>{this.mdsSet=t.metadataset,this.canInvite=this.canInvite&&l.bv.hasAccessPermission(t,l.u6.ACCESS_CHANGE_PERMISSIONS),this.editorialPublic=s.permissions.localPermissions?.permissions?.some(u=>u.authority?.authorityName===l.u6.AUTHORITY_EVERYONE),this.editId=c,this.currentCollection=t,this.currentCollection.rating=null,this.authorFreetext=null!=this.currentCollection.collection.authorFreetext,this.originalPermissions=s.permissions.localPermissions,this.properties=t.properties,this.newCollectionType=this.getTypeForCollection(this.currentCollection),this.hasCustomScope=!1,this.newCollectionStep=this.STEP_GENERAL,this.currentCollection.collection.scope===l.u6.COLLECTIONSCOPE_CUSTOM_PUBLIC&&(this.currentCollection.collection.scope=l.u6.COLLECTIONSCOPE_CUSTOM),i.next(),i.complete()})})}onEvent(t,i){if(t===l.I_.EVENT_APPLY_NODE){const c=i.preview?.data;c?(this.imageData=this.sanitizer.bypassSecurityTrustUrl(c),this.updateImageOptions(),fetch(c).then(s=>s.blob()).then(s=>{this.imageFile=s}),this.ref.tick()):(console.info(i),this.toast.error(null,"COLLECTIONS.TOAST.ERROR_IMAGE_APPLY")),this.imageWindow?.close()}}constructor(t,i,c,s,u,O,b,G,J,F,Q,H,B,q,j,K,p,_,h,y,eo,to,no,oo,io){this.collectionService=t,this.nodeService=i,this.connector=c,this.nodeHelper=s,this.uiService=u,this.iamService=O,this.mediacenterService=b,this.route=G,this.mdsService=J,this.eventService=F,this.router=Q,this.platformLocation=H,this.toast=B,this.bridge=q,this.temporaryStorage=j,this.zone=K,this.sanitizer=p,this.configLegacy=_,this.configService=h,this.ref=y,this.translations=eo,this.translationService=to,this.loadingScreen=no,this.mainNav=oo,this.dialogs=io,this.InteractionType=r.s_,this.NodeEntriesDisplayType=r.P8,this.DEFAULT_COLORS=["#975B5D","#692426","#E6B247","#A89B39","#699761","#32662A","#60998F","#29685C","#759CB7","#537997","#976097","#692869"],this.isLoading=!0,this.properties={},this.mainnav=!0,this.permissions=null,this.createEditorial=!1,this.createCurriculum=!1,this.createMediacenter=!1,this.editorialGroups=new r.AL,this.editorialPublic=!0,this.editorialColumns=[new r.HC("GROUP",l.u6.AUTHORITY_DISPLAYNAME)],this.imageData=null,this.imageFile=null,this.STEP_NEW="NEW",this.STEP_GENERAL="GENERAL",this.STEP_METADATA="METADATA",this.STEP_PERMISSIONS="PERMISSIONS",this.STEP_SETTINGS="SETTINGS",this.STEP_EDITORIAL_GROUPS="EDITORIAL_GROUPS",this.STEP_ICONS={GENERAL:"edit",METADATA:"info_outline",PERMISSIONS:"group_add",SETTINGS:"settings",EDITORIAL_GROUPS:"star"},this.newCollectionStep=this.STEP_NEW,this.destroyed=new I.xQ,this.loadingTask=this.loadingScreen.addLoadingTask({until:this.destroyed}),this.authorFreetext=!1,this.authorFreetextAllowed=!1,this.editorialGroupsSelected=[],this.eventService.addListener(this,this.destroyed),this.translations.waitForInit().subscribe(()=>{this.connector.isLoggedIn().subscribe(he=>{this.mdsService.getSets().subscribe(co=>{const lo=l.qp.filterValidMds(l.u6.HOME_REPOSITORY,co.metadatasets,this.configService);if(this.mdsSet=lo[0]?.id,this.COLORS=this.configLegacy.instant("collections.colors",this.DEFAULT_COLORS),he.statusCode!=l.u6.STATUS_CODE_OK)return this.toast.error({message:"loginData.statusCode was not ok",data:he},"TOOLPERMISSION_ERROR"),void m.d.getCommonParameters(this.route).subscribe(E=>{this.router.navigate([r.ru.ROUTER_PREFIX+"collections"],{queryParams:E})});this.canInvite=this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_INVITE),this.shareToAll=this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_INVITE_ALLAUTHORITIES),this.createEditorial=this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_COLLECTION_EDITORIAL),this.createCurriculum=this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_COLLECTION_CURRICULUM),this.mediacenterService.getMediacenters().subscribe(E=>{this.createMediacenter=1===E.filter(z=>z.administrationAccess).length&&this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_INVITE),this.createMediacenter&&(this.mediacenter=E[0])}),this.authorFreetextAllowed=this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_COLLECTION_CHANGE_OWNER),this.iamService.getCurrentUserAsync().then(E=>this.user=E.person),this.route.queryParams.subscribe(E=>{this.mainnav="false"!==E.mainnav,this.route.params.subscribe(z=>{let so=z.mode,M=z.id;if(E.collection)this.setParent(M,null),this.setCollection(JSON.parse(E.collection)).subscribe(()=>{this.updateAvailableSteps(),this.isLoading=!1,this.loadingTask.isDone||this.loadingTask.done()});else if("edit"==so)this.collectionService.getCollection(M).subscribe(te=>{this.nodeService.getNodeMetadata(M,[l.u6.ALL]).subscribe(ro=>{this.setCollection(ro.node).subscribe(()=>{this.updateAvailableSteps(),this.updateImageOptions(),this.isLoading=!1,this.loadingTask.isDone||this.loadingTask.done()})})});else{if(M==l.u6.ROOT)return void this.setParent(M,null);this.collectionService.getCollection(M).subscribe(te=>{this.setParent(M,te.collection)},te=>{this.setParent(M,null)})}})}),(this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_GLOBAL_AUTHORITY_SEARCH)||this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_GLOBAL_AUTHORITY_SEARCH_SHARE))&&(this.editorialGroups.isLoading=!0,this.iamService.searchGroups("*",!0,l.u6.GROUP_TYPE_EDITORIAL,"",{count:l.u6.COUNT_UNLIMITED,sortBy:[l.u6.CM_PROP_AUTHORITY_DISPLAYNAME],sortAscending:[!0]}).subscribe(E=>{this.editorialGroups.setData(E.groups,E.pagination),this.editorialGroups.isLoading=!1}))})})})}ngOnInit(){this.mainNav.setMainNavConfig({title:"COLLECTIONS.TITLE",currentScope:"collections",additionalScope:"edit"})}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}getShareStatus(){if(this.permissions||this.originalPermissions){let t=this.permissions||this.originalPermissions,i=l.u6.COLLECTIONSCOPE_MY;if(t&&t.permissions)for(let c of t.permissions)if(c.authority.authorityName!=this.user.authorityName&&(i=l.u6.COLLECTIONSCOPE_CUSTOM),c.authority.authorityName==l.u6.AUTHORITY_EVERYONE){i=l.u6.COLLECTIONSCOPE_ALL;break}return i}return l.u6.COLLECTIONSCOPE_MY}saveCollection(){this.collectionService.updateCollection(this.currentCollection).subscribe(()=>{this.navigateToCollectionId(this.currentCollection.ref.id)},t=>{this.nodeHelper.handleNodeError(this.currentCollection.title,t)})}setPermissions(t){if(t&&(this.permissionsInfo=t,this.permissions=t.permissions,this.permissions.inherited=!1,this.permissions.permissions&&this.permissions.permissions.length)){this.currentCollection.collection.scope=l.u6.COLLECTIONSCOPE_CUSTOM;for(let i of this.permissions.permissions)i.hasOwnProperty("editable")||(i.editable=!0)}}editPermissions(){var t=this;return(0,C.Z)(function*(){let i;if(null==t.permissions&&!t.editId&&(t.permissions=new l.Ij),t.editId)i=[t.editId];else{const s=new l.NB;s.title=t.currentCollection.title,s.iconURL=t.connector.getThemeMimeIconSvg("collection.svg"),s.ref={},s.aspects=[l.u6.CCM_ASPECT_COLLECTION],s.properties={},s.isDirectory=!0,i=[s]}(yield t.dialogs.openShareDialog({nodes:i,sendMessages:!0,sendToApi:!1,currentPermissions:t.permissions})).afterClosed().subscribe(s=>t.setPermissions(s))})()}isNewCollection(){return null==this.editId}isEditCollection(){return!this.isNewCollection()}newCollectionCancel(){let t=this.parentId;null==t&&(t=this.editId),this.navigateToCollectionId(t)}setColor(t){this.currentCollection.collection.color=t}setColorByDirection(t){let c=this.COLORS.indexOf(this.currentCollection.collection.color);switch(t.key){case"ArrowUp":c-=6;break;case"ArrowDown":c+=6;break;case"ArrowLeft":c-=1;break;case"ArrowRight":c+=1}c>=0&&c<this.COLORS.length&&(this.setColor(this.COLORS[c]),t.preventDefault())}imageDataChanged(t){let i=t.target.files;if(typeof i>"u"||i.length<=0)return;let c=i[0],s=!1;c.type.startsWith("image")&&(s=!0),s&&(this.imageFile=c,this.imageData=this.sanitizer.bypassSecurityTrustUrl(URL.createObjectURL(c)),this.updateImageOptions())}handleError(t){t.status!=l.u6.DUPLICATE_NODE_RESPONSE?l.bv.errorMessageContains(t,"Invalid property value")?this.toast.error(null,"COLLECTIONS.TOAST.INVALID_NAME"):this.toast.error(t):this.toast.error(null,"COLLECTIONS.TOAST.DUPLICATE_NAME")}save(){this.currentCollection.collection.description||(this.currentCollection.collection.description=""),this.currentCollection.title=this.currentCollection.title.trim(),this.currentCollection.collection.description=this.currentCollection.collection.description.trim(),this.currentCollection.collection.type=this.newCollectionType===l.u6.COLLECTIONTYPE_EDITORIAL||this.newCollectionType===l.u6.COLLECTIONTYPE_MEDIA_CENTER?this.newCollectionType:l.u6.COLLECTIONTYPE_DEFAULT,this.isEditCollection()?(this.isLoading=!0,this.collectionService.updateCollection(this.currentCollection).subscribe(()=>{this.save2(this.currentCollection)},t=>{this.isLoading=!1,this.handleError(t)})):(this.isLoading=!0,this.collectionService.createCollection(this.currentCollection,this.parentId).subscribe(t=>{this.save2(t.collection)},t=>{this.isLoading=!1,this.handleError(t)}))}saveImage(t){null!=this.imageData?this.collectionService.uploadCollectionImage(t.ref.id,this.imageFile,"image/png").subscribe(()=>{this.navigateToCollectionId(t.ref.id)},i=>{this.toast.error(null,"COLLECTIONS.TOAST.ERROR_IMAGE_APPLY"),this.navigateToCollectionId(t.ref.id)}):null==t.preview?this.collectionService.deleteCollectionImage(t.ref.id).subscribe(()=>{this.navigateToCollectionId(t.ref.id)}):this.navigateToCollectionId(t.ref.id)}setCollectionType(t){this.newCollectionType=t,t===l.u6.COLLECTIONSCOPE_MY&&(this.currentCollection.collection.scope=l.u6.COLLECTIONSCOPE_MY),t===l.u6.COLLECTIONSCOPE_ALL&&(this.currentCollection.collection.scope=l.u6.COLLECTIONSCOPE_ALL),(t===l.u6.COLLECTIONSCOPE_CUSTOM||t===l.u6.COLLECTIONTYPE_EDITORIAL)&&(this.currentCollection.collection.scope=l.u6.COLLECTIONSCOPE_CUSTOM),t===l.u6.COLLECTIONTYPE_MEDIA_CENTER&&this.switchToAuthorFreetext(),this.updateAvailableSteps(),this.goToNextStep()}getAvailableSteps(){let t=[];return t.push(this.STEP_GENERAL),(this.newCollectionType==l.u6.COLLECTIONTYPE_EDITORIAL||this.newCollectionType==l.u6.COLLECTIONTYPE_MEDIA_CENTER)&&t.push(this.STEP_METADATA),this.newCollectionType==l.u6.COLLECTIONSCOPE_CUSTOM&&this.canInvite&&t.push(this.STEP_PERMISSIONS),this.newCollectionType==l.u6.COLLECTIONTYPE_EDITORIAL&&this.canInvite&&t.push(this.STEP_EDITORIAL_GROUPS),t}isLastStep(){return this.currentStepPosition()>=this.availableSteps.length-1}goToNextStep(){var t=this;return(0,C.Z)(function*(){if(t.newCollectionStep!=t.STEP_GENERAL||t.currentCollection.title){if(t.newCollectionStep==t.STEP_METADATA){const i=yield t.mds.getValues();if(null==i)return;t.properties=i}if(t.isLastStep())t.save();else{const i=t.currentStepPosition();t.newCollectionStep=t.availableSteps[i+1],setTimeout(()=>{t.mds?.loadMds(!0)}),t.newCollectionStep==t.STEP_EDITORIAL_GROUPS&&setTimeout(()=>{t.editorialGroupsSelected=t.getEditoralGroups(t.originalPermissions.permissions),t.organizationsRef.getSelection().select(...t.editorialGroupsSelected),t.organizationsRef.getSelection().changed.subscribe(c=>t.editorialGroupsSelected=c.source.selected)})}t.updateButtons()}else t.toast.error(null,"COLLECTIONS.ENTER_NAME")})()}setCollectionGeneral(){}currentStepPosition(){return this.availableSteps.indexOf(this.newCollectionStep)}goBack(){var t=this;return(0,C.Z)(function*(){if(t.newCollectionStep==t.STEP_METADATA){const c=yield t.mds.getValues();null!=c&&(t.properties=c)}let i=t.currentStepPosition();-1==i?t.navigateToCollectionId(t.parentId):0==i?t.editId?t.navigateToCollectionId(t.editId):t.parentCollection&&t.parentCollection.collection.type===l.u6.COLLECTIONTYPE_EDITORIAL?t.navigateToCollectionId(t.parentId):t.newCollectionStep=t.STEP_NEW:(t.newCollectionStep=t.availableSteps[i-1],setTimeout(()=>{t.mds?.loadMds(!0)})),t.updateButtons()})()}navigateToCollectionId(t){this.isLoading=!1,m.d.getCommonParameters(this.route).subscribe(i=>{t!==l.u6.ROOT&&(i.id=t),this.router.navigate([r.ru.ROUTER_PREFIX+"collections"],{queryParams:i})})}save2(t){this.newCollectionType===l.u6.COLLECTIONTYPE_EDITORIAL||this.newCollectionType===l.u6.COLLECTIONTYPE_MEDIA_CENTER?this.nodeService.AddNodeAspects(t.ref.id,[l.u6.CCM_ASPECT_LOMREPLICATION,l.u6.CCM_ASPECT_CCLOM_GENERAL]).subscribe(()=>{this.nodeService.editNodeMetadata(t.ref.id,this.properties).subscribe(()=>{this.save3(t)})}):this.save3(t)}isBrightColor(){return r.vH.getPreferredColor(this.currentCollection.collection.color)===r.Sv.White}save3(t){if(this.newCollectionType==l.u6.GROUP_TYPE_EDITORIAL){if(!this.canInvite)return void this.save4(t);this.permissions=this.getEditorialGroupPermissions()}if((this.newCollectionType==l.u6.COLLECTIONSCOPE_CUSTOM||this.newCollectionType==l.u6.GROUP_TYPE_EDITORIAL)&&this.permissions&&this.permissions.permissions){let i=l.bv.copyAndCleanPermissions(this.permissions.permissions,!!this.originalPermissions&&this.originalPermissions.inherited);this.nodeService.setNodePermissions(t.ref.id,i,!!this.permissionsInfo&&this.permissionsInfo.notify,this.permissionsInfo?this.permissionsInfo.notifyMessage:null).subscribe(()=>{this.save4(t)},c=>{this.toast.error(c),this.isLoading=!1})}else this.save4(t)}getTypeForCollection(t){return t.collection.type===l.u6.COLLECTIONTYPE_EDITORIAL||t.collection.type===l.u6.COLLECTIONTYPE_MEDIA_CENTER?t.collection.type:t.collection.scope!==l.u6.COLLECTIONSCOPE_MY||this.canInvite?t.collection.scope===l.u6.COLLECTIONSCOPE_MY||t.collection.scope===l.u6.COLLECTIONSCOPE_ORGA||t.collection.scope===l.u6.COLLECTIONSCOPE_ALL||t.collection.scope===l.u6.COLLECTIONSCOPE_CUSTOM_PUBLIC?l.u6.COLLECTIONSCOPE_CUSTOM:t.collection.scope:l.u6.COLLECTIONSCOPE_MY}updateAvailableSteps(){this.availableSteps=this.getAvailableSteps(),this.updateButtons()}getEditorialGroupPermissions(){const t=new l.Ij;if(t.permissions=[],this.editorialPublic){const i=l.bv.getAllAuthoritiesPermission();i.permissions=[l.u6.PERMISSION_CONSUMER],t.permissions.push(i)}for(const i of this.editorialGroupsSelected){const c=new l.y3;c.authority={authorityName:i.authorityName,authorityType:i.authorityType},c.permissions=[l.u6.PERMISSION_COORDINATOR],t.permissions.push(c)}return t}getEditoralGroups(t){let i=[];for(let c of t)for(let s of this.editorialGroups.getData())s.authorityName==c.authority.authorityName&&i.push(s);return i}setParent(t,i){if(this.parentId=t,this.parentCollection=i,this.currentCollection=new l.NB,this.currentCollection.title="",this.currentCollection.collection={description:"",color:this.COLORS[0]},this.parentCollection&&this.parentCollection.collection.type===l.u6.COLLECTIONTYPE_EDITORIAL){if(!this.createEditorial||!this.shareToAll)return this.toast.error(this.createEditorial?l.u6.TOOLPERMISSION_INVITE_ALLAUTHORITIES:l.u6.TOOLPERMISSION_COLLECTION_EDITORIAL,"TOOLPERMISSION_ERROR"),window.history.back(),void(this.isLoading=!1);this.setCollectionType(l.u6.COLLECTIONTYPE_EDITORIAL)}this.updateAvailableSteps(),this.updateImageOptions(),this.isLoading=!1,this.loadingTask.isDone||this.loadingTask.done()}save4(t){const i=this.temporaryStorage.pop(l.xU.COLLECTION_ADD_NODES);i?m.d.addToCollection(this.nodeHelper,this.collectionService,this.router,this.bridge,t,i.nodes,!1,c=>{this.saveImage(t),i.callback?.emit({collection:t,references:c})}):this.saveImage(t)}deleteImage(){this.imageData=null,this.imageFile=null,this.imageFileRef.nativeElement.value=null,this.currentCollection.preview=null,this.updateImageOptions()}updateButtons(){this.buttons=[new l.Qd("BACK",{color:"standard"},()=>this.goBack()),new l.Qd(this.isLastStep()?"SAVE":"NEXT",{color:"primary"},()=>this.goToNextStep())]}switchToAuthorFreetext(){this.authorFreetextAllowed=this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_COLLECTION_CHANGE_OWNER),this.authorFreetext=!0,this.currentCollection.collection.authorFreetext=new Z.F(this.translationService).transform(this.newCollectionType===l.u6.COLLECTIONTYPE_MEDIA_CENTER||this.currentCollection.collection.type===l.u6.COLLECTIONTYPE_MEDIA_CENTER?this.mediacenter:this.user,null),setTimeout(()=>{this.authorFreetextInput.nativeElement.focus()})}cancelAuthorFreetext(){this.authorFreetext=!1,this.currentCollection.collection.authorFreetext=null}updateImageOptions(){this.imageOptions=[new r.BA("COLLECTIONS.NEW.IMAGE.SEARCH","search",()=>{this.imageWindow=m.d.openSearchWithReurl(this.platformLocation,this.router,"WINDOW",{queryParams:{reurlCreate:!1,reurlTypes:["image"]}})}),new r.BA("COLLECTIONS.NEW.IMAGE.UPLOAD","file_upload",()=>this.imageFileRef.nativeElement.click())],this.imageOptions[0].group=r.EM.Edit,this.imageOptions[1].group=r.EM.Edit,(this.imageData||this.currentCollection.preview&&!this.currentCollection.preview.isIcon)&&(this.imageOptions.push(new r.BA("COLLECTIONS.NEW.IMAGE.DELETE","delete",()=>this.deleteImage())),this.imageOptions[2].group=r.EM.Delete)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(l.i6),e.Y36(l.xE),e.Y36(l.xD),e.Y36(f.G),e.Y36(l.VL),e.Y36(l.Du),e.Y36(l.Jh),e.Y36(T.gz),e.Y36(l.xW),e.Y36(l.I_),e.Y36(T.F0),e.Y36(g.lw),e.Y36(D.F),e.Y36(k.d),e.Y36(l.xU),e.Y36(e.R0b),e.Y36(U.H7),e.Y36(l.eB),e.Y36(v.E4),e.Y36(e.z2F),e.Y36(r.fA),e.Y36(x.sK),e.Y36(oe.O),e.Y36($.ZF),e.Y36(ie.H))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["es-collection-new"]],viewQuery:function(i,c){if(1&i&&(e.Gf(Ie,5),e.Gf(ve,5),e.Gf(be,5),e.Gf(xe,5)),2&i){let s;e.iGM(s=e.CRH())&&(c.mds=s.first),e.iGM(s=e.CRH())&&(c.organizationsRef=s.first),e.iGM(s=e.CRH())&&(c.imageFileRef=s.first),e.iGM(s=e.CRH())&&(c.authorFreetextInput=s.first)}},hostBindings:function(i,c){1&i&&e.NdJ("keydown",function(u){return c.handleKeyboardEvent(u)},!1,e.evT)},decls:3,vars:4,consts:[["role","main","esSkipTarget","MAIN_CONTENT",1,"collections-master-div"],[4,"ngIf"],["class","createContainer",4,"ngIf"],[1,"createContainer"],["class","createProgress",4,"ngIf"],["class","collection-new-container","width","normal","height","auto","modal","auto",3,"title","onCancel",4,"ngIf"],["modal","auto","width","xsmall","height","auto",3,"buttons","isCancelable","title","subtitle","onCancel",4,"ngIf"],["modal","auto","width","large","height","xlarge","class","collection-metadata",3,"title","subtitle","isCancelable","buttons","onCancel",4,"ngIf"],["modal","auto","width","large","height","xxlarge","class","collection-metadata",3,"title","subtitle","isCancelable","buttons","onCancel",4,"ngIf"],["modal","auto","width","normal","height","large","class","collection-permission-container",3,"title","isCancelable","buttons","subtitle","onCancel",4,"ngIf"],[1,"createProgress"],[3,"current","finished","click",4,"ngFor","ngForOf"],[1,"finish"],[1,"circle"],[1,"label"],[3,"click"],[3,"esIcon"],[1,"connection"],["width","normal","height","auto","modal","auto",1,"collection-new-container",3,"title","onCancel"],[1,"createCollection","collectionShadow"],["mat-button","","data-test","create-private-collection-button",1,"collection-item","clickable",3,"click"],[1,"iconLeft"],["esIcon","lock",2,"color","#995b5b"],[1,"content"],[1,"title"],[1,"description"],["esIcon","keyboard_arrow_right",1,"next"],["mat-button","","class","collection-item clickable",3,"click",4,"ngIf"],["class","group",4,"ngIf"],["mat-button","",1,"collection-item","clickable",3,"click"],["esIcon","group",2,"color","#4f7899"],["esIcon","public",2,"color","#5c998f"],[1,"group"],["esIcon","star",2,"color","#e9b42a"],["esIcon","business",2,"color","#4e4b99"],["modal","auto","width","xsmall","height","auto",3,"buttons","isCancelable","title","subtitle","onCancel"],[1,"collection-general"],[1,"collectionImage"],[1,"image-upload-field"],["type","file","accept","image/*","name","userFile",1,"image-upload-field-input",3,"change"],["file",""],[1,"button-icon"],["appearance","round",3,"options","numberOfAlwaysVisibleOptions","numberOfAlwaysVisibleOptionsMobile"],["class","card-collection-icon-container",3,"keyup.enter","click",4,"ngIf"],["class","card-collection-image-container",3,"keyup.enter","click",4,"ngIf"],[1,"collection-new-preview-infoarea"],[1,"collection-new-bg"],[1,"dialog-basic-area","dialog-input-area"],["matInput","","autofocus","","autocomplete","off","data-test","new-collection-name-input",1,"title",3,"ngModel","ngModelChange"],["matInput","",3,"ngModel","ngModelChange"],[1,"collection-new-owner"],[1,"dialog-basic-area","dialog-color-group"],["id","collection-new-color-picker-label",1,"collection-new-preview-infoline"],["aria-labelledby","collection-new-color-picker-label","tabindex","0","role","listbox","aria-orientation","horizontal","cdkMonitorElementFocus","",1,"color-group",3,"keydown.arrowright","keydown.arrowup","keydown.arrowleft","keydown.arrowdown"],["role","option","class","color-option",3,"id","ngClass","background-color","click",4,"ngFor","ngForOf"],[1,"card-collection-icon-container",3,"keyup.enter","click"],[1,"card-image-distance"],[1,"card-image-icon-container"],["esIcon","layers"],[1,"blurred-image",3,"src"],[1,"card-image-preview",3,"src"],[1,"card-collection-image-container",3,"keyup.enter","click"],[1,"card-image-container"],["esIcon","person"],["mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",3,"click"],["esIcon","edit"],[1,"mat-form-field-no-padding"],["id","collection-new-author-freetext-label"],["matInput","",3,"disabled","ngModel","ngModelChange"],["authorFreetextInput",""],["mat-icon-button","","aria-describedby","collection-new-author-freetext-label",3,"click"],["esIcon","close"],["role","option",1,"color-option",3,"id","ngClass","click"],[1,"cdk-visually-hidden"],["modal","auto","width","large","height","xlarge",1,"collection-metadata",3,"title","subtitle","isCancelable","buttons","onCancel"],[1,"card-content"],[3,"groupId","setId","editorMode","embedded","currentValues"],["mds",""],["modal","auto","width","large","height","xxlarge",1,"collection-metadata",3,"title","subtitle","isCancelable","buttons","onCancel"],[1,"editorial-group"],[1,"editorial-list"],["class","noPermission",4,"ngIf"],[3,"dataSource","displayType","columns","sort","elementInteractionType","clickItem"],["organizations",""],["empty",""],[1,"editorial-public"],["color","primary",3,"ngModel","ngModelChange"],["slot","label"],["slot","description"],[1,"noPermission"],[1,"noGroups"],["modal","auto","width","normal","height","large",1,"collection-permission-container",3,"title","isCancelable","buttons","subtitle","onCancel"],[1,"dialog-basic-area","permissionsBtn"],["mat-raised-button","",3,"click"],["esIcon","person_add"],[1,"status"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e.YNc(1,Me,1,0,"es-global-progress",1),e.YNc(2,et,7,6,"div",2),e.qZA()),2&i&&(e.ekj("collections-master-div-mainnav",c.mainnav),e.xp6(1),e.Q6J("ngIf",c.isLoading),e.xp6(1),e.Q6J("ngIf",!c.isLoading))},dependencies:[me.kH,Oe.A,g.mk,g.sg,g.O5,r.nv,r.ar,r.cE,Y.Fj,Y.JJ,Y.On,fe.d,w.lW,w.RK,ce.KE,ce.hX,Te.Nt,le.Rr,Ee.w,se.P,Pe.o,Z.F,g.Ov,x.X$,r.PW],styles:[".createContainer[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]{position:fixed;left:20px;top:20%;color:var(--textLight);cursor:default;-webkit-user-select:none;user-select:none}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;margin-bottom:20px;align-items:center}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .connection[_ngcontent-%COMP%]{height:25px;width:3px;background-image:url(vendor/edu-sharing/dashed-line.svg);position:absolute;left:9px;top:20px}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.finished[_ngcontent-%COMP%]{color:var(--primary);cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.finished[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{background-image:url(vendor/edu-sharing/checked-circle.svg)}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.finished[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:700}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.finished[_ngcontent-%COMP%]   .connection[_ngcontent-%COMP%]{background-image:url(vendor/edu-sharing/line.svg)}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.current[_ngcontent-%COMP%]{color:var(--palette-foreground-text)}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.current[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{background-image:url(vendor/edu-sharing/active-circle.svg)}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.current[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:700}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.finish[_ngcontent-%COMP%]{color:#40bf8e}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.finish[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{background-image:url(vendor/edu-sharing/finish.svg)}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div.finish[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:700;text-transform:uppercase}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%] > div[_ngcontent-%COMP%], .createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%], .createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:flex}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;position:relative}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{margin-right:10px;border-radius:50%;width:21px;height:21px;background-image:url(vendor/edu-sharing/dashed-circle.svg);background-position:50% 50%;background-repeat:no-repeat}.collections-master-div[_ngcontent-%COMP%]{min-height:100%;margin:auto;max-width:600px;display:flex;align-items:center;padding-top:var(--mainnavHeight)}[_nghost-%COMP%]     .createCollection .collection-item.cdk-keyboard-focused{outline-offset:-4px}[_nghost-%COMP%]     .createCollection .collection-item>.mdc-button__label{width:100%;justify-content:flex-start;text-transform:none;padding-right:15px}.createCollection[_ngcontent-%COMP%]{background-color:#fff}.createCollection[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{font-size:110%;padding:20px;margin:0 0 10px;cursor:default;-webkit-user-select:none;user-select:none;background-color:#eee}.createCollection[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{float:right}.createCollection[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{padding-top:5px;margin-top:5px;border-top:1px solid #ccc}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]:hover{background-color:#f7f7f7}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]{height:unset;padding:10px 5px;width:100%;border-radius:0;line-height:2em;white-space:normal}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{color:var(--primary);font-weight:700;margin-bottom:3px}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:var(--textLight)}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:10px 0;text-align:left;flex-grow:1}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]   .iconLeft[_ngcontent-%COMP%]{vertical-align:middle;padding-right:15px;padding-left:20px}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]   .iconLeft[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{display:flex;background-color:#fff;width:50px;height:50px;align-items:center;justify-content:center;border-radius:50%;box-shadow:0 3px 3px #0000001a}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]{color:var(--primary);vertical-align:middle;padding-right:15px}.createCollection[_ngcontent-%COMP%]   .collection-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;top:3px}.collection-permission-container[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:140%;font-weight:700;padding-bottom:20px}.collection-permission-container[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:var(--textLight);font-size:110%;padding-bottom:20px}.collection-permission-container[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{margin:20px -25px -25px;padding:6px 20px;background:#eee}.collection-general[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.collection-general[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:6rem;resize:none}.collection-general[_ngcontent-%COMP%]   .dialog-input-area[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0}.collection-general[_ngcontent-%COMP%]   .collection-new-owner[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 25px}.collection-general[_ngcontent-%COMP%]   .collection-new-owner[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{margin:5px}.collection-general[_ngcontent-%COMP%]   .collection-new-owner[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{flex-grow:1}.collection-general[_ngcontent-%COMP%]   .color-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:auto;justify-content:center}.collection-general[_ngcontent-%COMP%]   .color-group[_ngcontent-%COMP%]:focus{outline:unset}.collection-general[_ngcontent-%COMP%]   .color-group.cdk-keyboard-focused[_ngcontent-%COMP%]{outline:none;outline:var(--focusWidth) solid var(--palette-primary-300);outline-offset:2px}.collection-general[_ngcontent-%COMP%]   .color-group[_ngcontent-%COMP%]   .color-option[_ngcontent-%COMP%]{display:inline-block;border-radius:4pt;width:14%;height:30px;margin:4px 3px;cursor:pointer}.collection-general[_ngcontent-%COMP%]   .color-group[_ngcontent-%COMP%]   .color-selected[_ngcontent-%COMP%]{border:2px solid #333}.collection-metadata[_ngcontent-%COMP%]   .noGroups[_ngcontent-%COMP%]{padding-top:15px;font-size:120%;color:var(--textLight);text-align:center}.collection-metadata[_ngcontent-%COMP%]   .noPermission[_ngcontent-%COMP%]{color:var(--textLight);text-align:center}.collection-metadata[_ngcontent-%COMP%]   .noPermission[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:120%}.collection-metadata[_ngcontent-%COMP%]   .noPermission[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-size:100%}.groupLabel[_ngcontent-%COMP%]{margin-bottom:5px}.collection1[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .collection1[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:focus{color:#eee!important}.permissionsBtn[_ngcontent-%COMP%]{margin-left:32px}.permissionsBtn[_ngcontent-%COMP%]   .btn-flat[_ngcontent-%COMP%]{float:none}.title[_ngcontent-%COMP%]{font-size:120%}.collectionShadow[_ngcontent-%COMP%]{box-shadow:0 10px 70px #00000026}.collectionImage[_ngcontent-%COMP%]{position:relative;height:240px;background-color:#fff;overflow:hidden}.collection-new-preview-infoarea[_ngcontent-%COMP%]{position:relative;min-height:120px;padding:16px;color:#fff;transition:var(--transitionNormal) all}.collection-new-preview-infoarea[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-input-placeholder{color:#ccc}.collection-new-preview-infoarea[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-moz-placeholder{color:#ccc}.collection-new-preview-infoarea[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-placeholder{color:#ccc}.collection-new-preview-infoarea[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-ms-input-placeholder{color:#ccc}.collection-new-preview-infoarea[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .collection-new-preview-infoarea[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{background-color:transparent}.collection-new-bg[_ngcontent-%COMP%]{position:absolute;width:100%;height:calc(100% - 150px);left:0;top:0;background-color:#00000026}.dark-color[_ngcontent-%COMP%]{color:#000}.dark-color[_ngcontent-%COMP%]   .collection-new-bg[_ngcontent-%COMP%]{background-color:#ffffff26}.dark-color[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-webkit-input-placeholder{color:#333}.dark-color[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-moz-placeholder{color:#333}.dark-color[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::-moz-placeholder{color:#333}.dark-color[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:-ms-input-placeholder{color:#333}.collection-new-preview-headline[_ngcontent-%COMP%]{font-size:200%}.collection-new-preview-subline[_ngcontent-%COMP%]{font-size:120%;margin-bottom:16px;opacity:.85}.collection-new-preview-infoline[_ngcontent-%COMP%]{opacity:.75;margin-bottom:10px}.collection-nocontent-big[_ngcontent-%COMP%]{font-size:200%;padding:8px 16px 16px 0}.collection-nocontent-small[_ngcontent-%COMP%]{padding:0 16px 16px 0}.collections-loading-div[_ngcontent-%COMP%]{position:absolute;top:20%;text-align:center}.icon-bottom[_ngcontent-%COMP%]{vertical-align:bottom}.dialog-basic-area[_ngcontent-%COMP%]{padding:25px 25px 15px}.dialog-dark-area[_ngcontent-%COMP%]{padding:16px 16px 8px;background:#efefef}.button-area[_ngcontent-%COMP%]{text-align:right;height:74px}.button-area[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{float:right;margin:5px}.dialog-input[_ngcontent-%COMP%]{width:90%;height:25px;padding:4px 4px 4px 10px;margin-top:5px;font-size:14px}.dialog-input-textarea[_ngcontent-%COMP%]{width:90%;border-color:#d3d3d3;padding:4px 4px 4px 10px;font-size:14px;resize:vertical;height:70px;max-height:200px;margin-top:5px}.card-content[_ngcontent-%COMP%]{padding:25px}.card-collection-icon-container[_ngcontent-%COMP%]{text-align:center;vertical-align:middle;width:100%;height:240px;background-color:#fff;color:#fff;cursor:pointer}.card-image-distance[_ngcontent-%COMP%]{height:35px}.card-image-icon-container[_ngcontent-%COMP%]{height:160px;width:160px;border-radius:160px;background-color:#a9a9a9;margin:auto;display:flex;align-items:center;justify-content:center}.card-image-icon-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:75px}.card-collection-image-container[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;text-align:center;background-color:#fff;vertical-align:middle}.card-image-container[_ngcontent-%COMP%]{display:inline-flex;margin-top:auto;margin-bottom:auto;vertical-align:middle}.card-image-preview[_ngcontent-%COMP%]{width:100%;height:240px;object-fit:contain;position:relative;z-index:1}.image-upload-field[_ngcontent-%COMP%]{width:100%;background-color:transparent;height:0px;position:relative;top:0;left:0;opacity:0;cursor:pointer;z-index:999}.image-upload-field-input[_ngcontent-%COMP%]{display:none}.button-icon[_ngcontent-%COMP%]{position:absolute;bottom:15px;right:10px;z-index:2}.button-icon[_ngcontent-%COMP%]   .mat-fab[_ngcontent-%COMP%]{margin:0 5px}input[type=radio][_ngcontent-%COMP%]{margin:0 4px 8px 13px;cursor:pointer}.dialog-color-group[_ngcontent-%COMP%]{min-height:140px}.dialog-header-field[_ngcontent-%COMP%]{background-color:#383838;padding:8px 0 8px 20px;color:#fff}.editorial-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.editorial-group[_ngcontent-%COMP%]   .editorial-list[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto}.editorial-group[_ngcontent-%COMP%]   .editorial-public[_ngcontent-%COMP%]{padding:25px 25px 20px;background-color:#f9f9f9}.editorial-group[_ngcontent-%COMP%]   .editorial-public[_ngcontent-%COMP%]     .mat-slide-toggle{height:auto}@media screen and (max-width: 1000px){.card-high[_ngcontent-%COMP%]{top:15%}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]{position:fixed;display:flex;top:calc(var(--mainnavHeight) + 40px);width:100vw;left:0;justify-content:center}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .circle[_ngcontent-%COMP%]{background-size:60%}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .connection[_ngcontent-%COMP%]{height:20px;left:25px;top:1px;transform:rotate(90deg)}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{display:none}.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]   .current[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{display:flex;position:fixed;left:0;top:calc(var(--mainnavHeight) + 20px);width:100vw;justify-content:center}}@media screen and (max-height: 950px){.card[_ngcontent-%COMP%], .card-high[_ngcontent-%COMP%], .card-low[_ngcontent-%COMP%]{top:calc(var(--mainnavHeight) + 15px)}.collectionImage[_ngcontent-%COMP%], .card-collection-icon-container[_ngcontent-%COMP%]{height:120px}.card-image-icon-container[_ngcontent-%COMP%]{margin-top:10px;height:100px;width:100px;border-radius:100px}.card-image-icon-container[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:60px}.card-image-distance[_ngcontent-%COMP%]{height:0}.blurred-image[_ngcontent-%COMP%]{display:block;filter:blur(8px)}.card-image-preview[_ngcontent-%COMP%]{height:120px;width:auto;margin:auto;z-index:1;position:relative;box-shadow:0 10px 70px #00000026}}@media screen and (max-width: 1000px) and (max-height: 950px){.createContainer[_ngcontent-%COMP%]   .createProgress[_ngcontent-%COMP%]{display:none}}"]})}return n})();var nt=a(12994),W=a(19352),ot=a(97734),V=a(64634),it=a(19445),ct=a(98617),lt=a(34423),st=a(68014),rt=a(77988),ee=a(74104),ae=a(66848),at=a(5693),dt=a(77504),_t=a(81955),d=a(46680),S=a(27661),de=a(54560),_e=a(43785),pt=a(68484),gt=a(98465),Ct=a(86825);const ut=["buttonElements"];function ht(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.click(c))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.Q6J("color","white"),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.label)," ")}}function mt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const c=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.click(c))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&n){const t=e.oxw().$implicit;e.Q6J("color","white"),e.xp6(1),e.hij(" ",e.lcZ(2,2,t.label)," ")}}function Ot(n,o){if(1&n&&(e.TgZ(0,"div",null,8),e.YNc(2,ht,3,4,"button",9),e.YNc(3,mt,3,4,"button",10),e.qZA()),2&n){const t=o.$implicit;e.xp6(2),e.Q6J("ngIf","primary"===t.color),e.xp6(1),e.Q6J("ngIf","standard"===t.color)}}function ft(n,o){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,Ot,4,2,"div",7),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t._buttons)}}function Tt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",13),e.NdJ("click",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.cancel())}),e.TgZ(1,"i",14),e._uU(2,"close"),e.qZA()()}}function Et(n,o){if(1&n&&(e.TgZ(0,"div")(1,"div",1)(2,"div",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div",3),e._uU(6),e.ALo(7,"translate"),e.qZA()(),e.YNc(8,ft,2,1,"div",4),e.YNc(9,Tt,3,0,"div",5),e.qZA()),2&n){const t=e.oxw();e.Gre("infobar infobar-",t.position,""),e.Q6J("@infobarBottom",t.title),e.xp6(3),e.Oqu(e.lcZ(4,8,t.title)),e.xp6(3),e.Oqu(e.xi3(7,10,t.message,t.messageParameters)),e.xp6(2),e.Q6J("ngIf",t._buttons),e.xp6(1),e.Q6J("ngIf",t.isCancelable)}}let Pt=(()=>{class n{constructor(){this.isCancelable=!1,this.position="bottom",this.onCancel=new e.vpe}set buttons(t){t?(this._buttons=t.reverse(),setTimeout(()=>{this.buttonElements&&this.buttonElements.nativeElement.focus()},10)):this._buttons=null}click(t){t.callback()}cancel(){this.onCancel.emit()}static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["es-infobar"]],viewQuery:function(i,c){if(1&i&&e.Gf(ut,5),2&i){let s;e.iGM(s=e.CRH())&&(c.buttonElements=s.first)}},inputs:{isCancelable:"isCancelable",position:"position",title:"title",message:"message",messageParameters:"messageParameters",buttons:"buttons"},outputs:{onCancel:"onCancel"},decls:1,vars:1,consts:[[3,"class",4,"ngIf"],[1,"infobar-message"],[1,"title"],[1,"message"],["class","infobar-buttons",4,"ngIf"],["class","infobar-cancel clickable",3,"click",4,"ngIf"],[1,"infobar-buttons"],[4,"ngFor","ngForOf"],["buttonElements",""],["mat-raised-button","",3,"color","click",4,"ngIf"],["mat-button","",3,"color","click",4,"ngIf"],["mat-raised-button","",3,"color","click"],["mat-button","",3,"color","click"],[1,"infobar-cancel","clickable",3,"click"],[1,"material-icons"]],template:function(i,c){1&i&&e.YNc(0,Et,10,13,"div",0),2&i&&e.Q6J("ngIf",c.title)},dependencies:[g.sg,g.O5,r.ar,w.lW,x.X$],styles:[".infobar[_ngcontent-%COMP%]{background:var(--primary);color:var(--light-primary-text);width:100%;position:fixed;left:0;height:70px;z-index:30;display:flex}.infobar[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center}.infobar[_ngcontent-%COMP%]   .infobar-message[_ngcontent-%COMP%]{flex-grow:1;padding-left:20px;flex-direction:column;align-items:flex-end;justify-content:center}.infobar[_ngcontent-%COMP%]   .infobar-message[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;margin-left:auto}.infobar[_ngcontent-%COMP%]   .infobar-message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:120%;font-weight:700}.infobar[_ngcontent-%COMP%]   .infobar-message[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{color:rgba(var(--light-primary-text),.75)}.infobar[_ngcontent-%COMP%]   .infobar-cancel[_ngcontent-%COMP%]{padding-right:20px}.infobar[_ngcontent-%COMP%]   .infobar-buttons[_ngcontent-%COMP%]{padding:0 20px}.infobar[_ngcontent-%COMP%]   .infobar-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{color:var(--primary)!important;background:#fff!important}.infobar[_ngcontent-%COMP%]   .infobar-buttons[_ngcontent-%COMP%]   .btn-flat[_ngcontent-%COMP%]{color:var(--light-primary-text)!important}.infobar-bottom[_ngcontent-%COMP%]{bottom:0}"],data:{animation:[(0,Ct.X$)("infobarBottom",r.Le.infobarBottom(r.Le.ANIMATION_TIME_SLOW))]}})}return n})();var It=a(69594);let vt=(()=>{class n{constructor(t){this.overlay=t}open({title:t,message:i,buttons:c}){return new Promise(s=>{this.overlayRef&&this.overlayRef.dispose(),this.overlayRef=this.overlay.create();const u=new pt.C5(Pt),O=this.overlayRef.attach(u);O.instance.title=t,O.instance.message=i,O.instance.buttons=c.map(b=>new gt.Q(b.label,b.config,()=>{s(b.label),this.overlayRef.dispose()})),O.instance.isCancelable=!0,O.instance.onCancel.subscribe(()=>this.overlayRef.dispose()),O.onDestroy(()=>{this.overlayRef=null,s(null)})})}close(){this.overlayRef?.dispose()}static#e=this.\u0275fac=function(i){return new(i||n)(e.LFG(It.aV))};static#t=this.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var bt=a(57857),xt=a(80723);const Mt=["listProposals"];function St(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"section",1)(1,"div",2)(2,"h2",3),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"es-actionbar"),e.qZA(),e.TgZ(6,"es-node-entries-wrapper",4,5),e.NdJ("clickItem",function(c){e.CHM(t);const s=e.oxw();return e.KtG(s.onContentClick.emit(c.element))}),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.hij(" ",e.lcZ(4,6,"COLLECTIONS.PROPOSALS.TITLE")," "),e.xp6(3),e.Q6J("elementInteractionType",t.InteractionType.DefaultActionLink)("dataSource",t.dataSourceCollectionProposals)("scope",t.Scope.CollectionsProposals)("displayType",t.NodeEntriesDisplayType.Grid)("columns",t.proposalColumns)}}let Lt=(()=>{class n{constructor(t,i,c){this.collectionService=t,this.mainNavService=i,this.optionsHelperService=c,this.NodeEntriesDisplayType=r.P8,this.InteractionType=r.s_,this.Scope=r.sX,this.proposalColumns=[new r.HC("NODE",d.u.CM_PROP_TITLE),new r.HC("NODE_PROPOSAL",d.u.CM_CREATOR,{showLabel:!1}),new r.HC("NODE_PROPOSAL",d.u.CM_PROP_C_CREATED,{showLabel:!1})],this.dataSourceCollectionProposals=new r.AL,this.onContentClick=new e.vpe,this.mainNavService.getDialogs().onEvent.subscribe(s=>{s.event===de.m$.AddCollectionNodes&&this.refreshProposals()})}refreshProposals(){this.dataSourceCollectionProposals.reset(),this.dataSourceCollectionProposals.isLoading=!0,this.canEdit&&this.collectionService.getCollectionProposals(this.collection.ref.id).subscribe(t=>{t.nodes=t.nodes.map(i=>(i.proposalCollection=this.collection,i)),this.dataSourceCollectionProposals.setData(t.nodes,t.pagination),this.dataSourceCollectionProposals.isLoading=!1,setTimeout(()=>{this.listProposals?.initOptionsGenerator({actionbar:this.actionbar})})})}ngOnChanges(t){null!==t.collection?.currentValue&&null!==t.canEdit?.currentValue&&this.refreshProposals()}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(_e.i),e.Y36($.ZF),e.Y36(r.CI))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["es-collection-proposals"]],viewQuery:function(i,c){if(1&i&&(e.Gf(Mt,5),e.Gf(r.nv,5)),2&i){let s;e.iGM(s=e.CRH())&&(c.listProposals=s.first),e.iGM(s=e.CRH())&&(c.actionbar=s.first)}},inputs:{collection:"collection",canEdit:"canEdit"},outputs:{onContentClick:"onContentClick"},features:[e._Bn([r.tC]),e.TTD],decls:1,vars:1,consts:[["class","collections-cards-div",4,"ngIf"],[1,"collections-cards-div"],[1,"content-header","heading-group"],[1,"mat-heading-3"],[1,"no-padding",3,"elementInteractionType","dataSource","scope","displayType","columns","globalOptions","clickItem"],["listProposals",""]],template:function(i,c){1&i&&e.YNc(0,St,8,8,"section",0),2&i&&e.Q6J("ngIf",!(null!=c.dataSourceCollectionProposals&&c.dataSourceCollectionProposals.isEmpty()))},dependencies:[g.O5,r.nv,r.cE,x.X$],styles:[".content-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.content-header[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{flex-grow:1}"]})}return n})();const Nt=["empty"],wt=["actionbarReferences"],At=["listReferences"];function Rt(n,o){if(1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Oqu(e.lcZ(2,1,"COLLECTIONS.TAB."+t.scope+"_LONG"))}}function yt(n,o){1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"COLLECTION.INFO_REFERENCES_MULTI")))}function Zt(n,o){if(1&n&&(e.TgZ(0,"h2",9),e.YNc(1,Rt,3,3,"ng-container",6),e.YNc(2,yt,3,3,"ng-container",6),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.isRootLevel),e.xp6(1),e.Q6J("ngIf",!t.isRootLevel)}}function Dt(n,o){if(1&n&&(e.TgZ(0,"div",7),e.YNc(1,Zt,3,2,"h2",8),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.isAllowedToEditCollection()||!t.dataSourceCollections.isEmpty())}}function kt(n,o){1&n&&e.GkF(0)}function Ut(n,o){if(1&n&&(e.TgZ(0,"div",11),e.YNc(1,kt,1,0,"ng-container",12),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngTemplateOutlet",t.emptyRef)}}function Yt(n,o){if(1&n&&e.YNc(0,Ut,2,1,"div",10),2&n){const t=e.oxw();e.Q6J("ngIf",!t.createAllowed())}}function Gt(n,o){1&n&&(e.TgZ(0,"div")(1,"div",13),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",14)(5,"div",15),e._uU(6),e.ALo(7,"translate"),e.qZA()()()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,2,"COLLECTIONS.NO_SUBCOLLECTIONS")," "),e.xp6(4),e.hij(" ",e.lcZ(7,4,"COLLECTIONS.NO_SUBCOLLECTIONS_HINT")," "))}function Jt(n,o){1&n&&(e.TgZ(0,"div",25)(1,"h2",9),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&n&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"collections_content")," "))}function Ft(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(c){e.CHM(t);const s=e.oxw(2).element;return e.oxw(3).deleteReference(s),c.stopPropagation(),e.KtG(c.preventDefault())}),e._uU(1),e.ALo(2,"translate"),e.qZA()}2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ORIGINAL_DELETE")," "))}function Qt(n,o){if(1&n&&(e.TgZ(0,"div",27)(1,"div"),e._UZ(2,"i",28),e.TgZ(3,"div",29),e._uU(4),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",30),e._uU(7),e.ALo(8,"translate"),e.qZA(),e.YNc(9,Ft,3,3,"button",31),e.qZA()()),2&n){const t=e.oxw().element,i=e.oxw(3);e.xp6(4),e.Oqu(e.lcZ(5,3,"ORIGINAL_DELETED")),e.xp6(3),e.Oqu(e.lcZ(8,5,"ORIGINAL_DELETED_INFO")),e.xp6(2),e.Q6J("ngIf",i.canDelete(t))}}function Ht(n,o){if(1&n&&e.YNc(0,Qt,10,7,"div",26),2&n){const t=o.element,i=e.oxw(3);e.Q6J("ngIf",i.isDeleted(t))}}function Bt(n,o){1&n&&(e.TgZ(0,"div",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"collections_howToAddContent")," "))}function qt(n,o){if(1&n&&(e.TgZ(0,"div",14)(1,"div",13),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.YNc(4,Bt,3,3,"div",33),e.qZA()),2&n){const t=e.oxw(3);e.xp6(2),e.hij(" ",e.lcZ(3,2,"collections_noContentAvailable")," "),e.xp6(2),e.Q6J("ngIf",t.isUserAllowedToEdit(t.collection))}}const pe=function(n,o,t){return{dragAllowed:n,dropAllowed:o,dropped:t}},ge=function(n,o,t,i,c){return{active:n,direction:o,customSortingInProgress:t,columns:i,allowed:c}},jt=function(n,o){return[n,o]},Ce=function(){return[]};function Kt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"section",1),e._UZ(1,"es-actionbar",18,19),e.TgZ(3,"div",20)(4,"es-node-entries-wrapper",21,22),e.NdJ("displayTypeChange",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.referencesDisplayType=c)})("clickItem",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.onContentClick(c))})("sortChange",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.setReferenceSort(c))})("fetchData",function(c){e.CHM(t);const s=e.oxw(2);return e.KtG(s.loadMoreReferences(c))}),e.YNc(6,Jt,4,3,"ng-template",null,4,e.W1O),e.YNc(8,Ht,1,1,"ng-template",null,23,e.W1O),e.qZA(),e.YNc(10,qt,5,4,"div",24),e.qZA()()}if(2&n){const t=e.oxw(2);let i;e.xp6(1),e.Q6J("numberOfAlwaysVisibleOptions",1),e.xp6(2),e.ekj("wrapper-table",t.referencesDisplayType===t.NodeEntriesDisplayType.Table)("wrapper-empty",t.dataSourceReferences.isEmpty())("wrapper-edit",t.isUserAllowedToEdit(t.collection)),e.xp6(1),e.Q6J("elementInteractionType",t.InteractionType.Emitter)("dataSource",t.dataSourceReferences)("scope",t.Scope.CollectionsReferences)("primaryInstance",!0)("columns",t.referencesColumns)("displayType",t.referencesDisplayType)("dragDrop",e.kEZ(17,pe,t.isAllowedToEditCollection(),t.canDropOnRef,t.dropOnRef))("sort",e.qbA(21,ge,t.sortReferences.active,t.sortReferences.direction,t.sortReferences.customSortingInProgress,t.sortReferences.columns,!t.isMobile()&&(null==(i=t.dataSourceReferences.getData())?null:i.length)>1&&t.isUserAllowedToEdit(t.collection)&&!(null!=t.sortCollections&&t.sortCollections.customSortingInProgress)))("globalOptions",t.isUserAllowedToEdit(t.collection)?e.WLB(27,jt,t.addMaterialSearchOptionItem,t.addMaterialBinaryOptionItem):e.DdM(30,Ce)),e.xp6(6),e.Q6J("ngIf",!t.dataSourceReferences.isLoading&&t.dataSourceReferences.isEmpty())}}function Wt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"es-collection-proposals",16),e.NdJ("onContentClick",function(c){e.CHM(t);const s=e.oxw();return e.KtG(s.onContentClick(c))}),e.qZA(),e.YNc(2,Kt,11,31,"section",17),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("collection",t.collection)("canEdit",t.isAllowedToEditCollection()),e.xp6(1),e.Q6J("ngIf",!t.isRootLevel)}}const Vt=function(n){return[n]};class A{static#e=this.DEFAULT_REQUEST={sortBy:[d.u.CCM_PROP_COLLECTION_PINNED_STATUS,d.u.CCM_PROP_COLLECTION_PINNED_ORDER,d.u.CM_MODIFIED_DATE],sortAscending:[!1,!0,!1]};constructor(o,t,i,c,s,u,O,b,G,J,F,Q,H,B,q,j,K){this.authenticationService=o,this.bridge=t,this.collectionService=i,this.configurationService=c,this.dialogs=s,this.infobar=u,this.loadingScreen=O,this.mainNavService=b,this.mdsService=G,this.nodeHelper=J,this.nodeService=F,this.optionsService=Q,this.route=H,this.router=B,this.toast=q,this.translation=j,this.uiService=K,this.referencesDisplayType=r.P8.Grid,this.destroyed$=new I.xQ,this.ROUTER_PREFIX=r.ru.ROUTER_PREFIX,this.NodeEntriesDisplayType=r.P8,this.InteractionType=r.s_,this.Scope=r.sX,this.interactionType=r.s_.DefaultActionLink,this.clickItem=new e.vpe,this.mainNavUpdateTrigger=new I.xQ,this.sortCollectionColumns=[new r.Sw("NODE",d.u.CM_PROP_TITLE),new r.Sw("NODE",d.u.CM_MODIFIED_DATE),new r.Sw("NODE",d.u.CCM_PROP_COLLECTION_ORDERED_POSITION,"ascending")],this.createSubCollectionOptionItem=new r.BA("OPTIONS.NEW_COLLECTION","layers",()=>this.onCreateCollection()),this.sortReferences={active:null,direction:"asc",columns:[new r.Sw("NODE",d.u.CM_MODIFIED_DATE),new r.Sw("NODE",d.u.CM_PROP_C_CREATED),new r.Sw("NODE",d.u.CCM_PROP_COLLECTION_ORDERED_POSITION,"ascending")]},this.sortCollections={active:null,direction:"asc",columns:[new r.Sw("NODE",d.u.CM_PROP_TITLE),new r.Sw("NODE",d.u.CM_PROP_C_CREATED),new r.Sw("NODE",d.u.CM_MODIFIED_DATE),new r.Sw("NODE",d.u.CCM_PROP_COLLECTION_ORDERED_POSITION,"ascending")]},this.addMaterialSearchOptionItem=new r.BA("OPTIONS.SEARCH_OBJECT","redo",()=>{m.d.getCommonParameters(this.route).subscribe(p=>{p.addToCollection=this.collection.ref.id,this.router.navigate([r.ru.ROUTER_PREFIX+"search"],{queryParams:p})})}),this.addMaterialBinaryOptionItem=new r.BA("OPTIONS.ADD_OBJECT","cloud_upload",()=>{this.mainNavService.getMainNav().topBar.createMenu.openUploadSelect()}),this.dataSourceCollections=new r.AL,this.dataSourceReferences=new r.AL,this.collectionsColumns=[],this.referencesColumns=[],this.loadingTask=this.loadingScreen.addLoadingTask({until:this.destroyed$}),this.canDropOnCollectionBreadcrumbs=p=>{const _=p.draggedNodes,h=p.target;if("HOME"===h){const y="move"===p.action&&-1!==_[0].aspects.indexOf(d.u.CCM_ASPECT_COLLECTION)&&this.nodeHelper.getNodesRight(_,d.u.ACCESS_WRITE);return{accept:y,denyExplicit:!y}}return _[0].ref.id===h.ref.id||h.ref.id===this.collection.ref.id||_[0].collection&&"copy"===p.action||_[0].collection?.hasOwnProperty("childCollectionsCount")&&(_[0].collection.type===d.u.COLLECTIONTYPE_EDITORIAL&&h.collection.type!==d.u.COLLECTIONTYPE_EDITORIAL||_[0].collection.type!==d.u.COLLECTIONTYPE_EDITORIAL&&h.collection.type===d.u.COLLECTIONTYPE_EDITORIAL)||"copy"===p.action&&!this.nodeHelper.getNodesRight(_,d.u.ACCESS_CC_PUBLISH,r.jj.Effective)||"move"===p.action&&!this.nodeHelper.getNodesRight(_,d.u.ACCESS_WRITE,r.jj.Local)?{accept:!1}:{accept:this.nodeHelper.getNodesRight([h],d.u.ACCESS_WRITE,r.jj.Local)}},this.canDropOnCollection=p=>this.canDropOnCollectionBreadcrumbs(p),this.canDropOnRef=p=>({accept:!1}),this.dropOnRef=(p,_)=>{},this.dropOnCollection=(p,_)=>{if(_.element[0]!==p)if(this.toast.showProgressSpinner(),"collection"===_.element[0].mediatype){if("copy"===_.mode)return this.toast.error(null,"INVALID_OPERATION"),void this.toast.closeProgressSpinner();this.nodeService.moveNode(p?.ref?.id||d.u.COLLECTIONHOME,_.element[0].ref.id).subscribe(()=>{this.toast.closeProgressSpinner(),this.refreshContent()},h=>{this.handleError(h),this.toast.closeProgressSpinner()})}else"copy"===_.mode?m.d.addToCollection(this.nodeHelper,this.collectionService,this.router,this.bridge,p,_.element,!1,h=>{this.toast.closeProgressSpinner(),this.refreshContent()}):"move"===_.mode?(0,dt.D)(_.element.map(h=>this.nodeService.moveNode(p?.ref?.id||d.u.COLLECTIONHOME,h.ref.id))).subscribe(()=>{this.toast.closeProgressSpinner(),this.refreshContent()},h=>{this.handleError(h),this.toast.closeProgressSpinner()}):this.toast.error(null,"INVALID_OPERATION")},this.sortCollectionColumns[this.sortCollectionColumns.length-1].mode="ascending",this.collectionsColumns.push(new r.HC("COLLECTION","title")),this.collectionsColumns.push(new r.HC("COLLECTION","info")),this.collectionsColumns.push(new r.HC("COLLECTION","scope")),this.mainNavService.getDialogs().onEvent.subscribe(p=>{p.event===de.m$.AddCollectionNodes&&p.data.collection.ref.id===this.collection.ref.id&&this.listReferences.addVirtualNodes(p.data.references)}),this.authenticationService.observeLoginInfo().pipe((0,W.R)(this.destroyed$)).subscribe(p=>{this.login=p,this.addMaterialBinaryOptionItem.isEnabled=p.toolPermissions.includes(d.u.TOOLPERMISSION_CREATE_ELEMENTS_FILES),this.createSubCollectionOptionItem.isEnabled=p.toolPermissions.includes(d.u.TOOLPERMISSION_CREATE_ELEMENTS_COLLECTIONS)})}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}ngOnInit(){var o=this;return(0,C.Z)(function*(){const t=yield l.qp.getAvailableMds(d.u.HOME_REPOSITORY,o.mdsService,o.configurationService),i=yield o.mdsService.getMetadataSet({metadataSet:t[0].id}).toPromise();o.referencesColumns=_t.h.getColumns(o.translation,i,"collectionReferences"),o.optionsService.clearComponents(o.actionbarReferences),o.registerMainNav(),o.mainNavUpdateTrigger.next()})()}ngOnChanges(o){if(o.collection.currentValue)if(this.dataSourceCollections.reset(),this.dataSourceReferences.reset(),this.createSubCollectionOptionItem.name="OPTIONS."+(this.isRootLevel?"NEW_COLLECTION":"NEW_SUB_COLLECTION"),this.isRootLevel)this.sortCollections.active=d.u.CM_MODIFIED_DATE,this.sortCollections.direction="desc",this.refreshContent();else{this.dataSourceCollections.isLoading=!0,this.dataSourceReferences.isLoading=!0;const t=this.collection.properties[d.u.CCM_PROP_COLLECTION_SUBCOLLECTION_ORDER_MODE];this.sortCollections.active=t?.[0]||d.u.CM_MODIFIED_DATE,this.sortCollections.direction=t?.[0]===d.u.CCM_PROP_COLLECTION_ORDERED_POSITION||"true"===t?.[1]?"asc":"desc";const i=this.collection.collection.orderMode,c=this.collection.collection.orderAscending;this.sortReferences.active=(i===d.u.COLLECTION_ORDER_MODE_CUSTOM?d.u.CCM_PROP_COLLECTION_ORDERED_POSITION:i)||d.u.CM_MODIFIED_DATE,this.sortReferences.direction=this.sortReferences.active===d.u.COLLECTION_ORDER_MODE_CUSTOM||c?"asc":"desc",this.mainNavUpdateTrigger.next(),this.dataSourceCollections.isLoading=!1,this.setOptionsCollection(),this.refreshContent(),-1!==this.collection.access.indexOf(d.u.ACCESS_CHANGE_PERMISSIONS)&&this.nodeService.getNodePermissions(this.collection.ref.id).subscribe(s=>{this.permissions=s.permissions.localPermissions.permissions.concat(s.permissions.inheritedPermissions)})}}isUserAllowedToEdit(o){return S.b.isUserAllowedToEdit(o)}isAllowedToEditCollection(){return this.isRootLevel?!this.login?.isGuest:S.b.hasAccessPermission(this.collection,d.u.PERMISSION_WRITE)}onCreateCollection(){m.d.getCommonParameters(this.route).subscribe(o=>{this.router.navigate([r.ru.ROUTER_PREFIX+"collections/collection","new",this.collection.ref.id],{queryParams:o})})}handleError(o){o.status===d.u.DUPLICATE_NODE_RESPONSE?this.toast.error(null,"COLLECTIONS.ERROR_NODE_EXISTS"):this.toast.error(o)}onContentClick(o){var t=this;return(0,C.Z)(function*(){t.contentNode=o.element,o.element.type===d.u.CCM_TYPE_COLLECTION_PROPOSAL?t.clickElementEvent(o):null==o.element.originalId?(yield t.dialogs.openGenericDialog({title:"COLLECTIONS.ORIGINAL_MISSING",message:"COLLECTIONS.ORIGINAL_MISSING_INFO",buttons:[...t.isAllowedToDeleteNodes([o.element])?[{label:"OPTIONS.REMOVE_REF",config:{color:"standard"}}]:[],{label:"COLLECTIONS.OPEN_MISSING",config:{color:"primary"}}]})).afterClosed().subscribe(c=>{"OPTIONS.REMOVE_REF"===c?t.deleteFromCollection():"COLLECTIONS.OPEN_MISSING"===c&&t.clickElementEvent(o)}):t.clickElementEvent(o)})()}clickElementEvent(o){this.interactionType===r.s_.DefaultActionLink?this.nodeService.getNodeMetadata(o.element.ref.id).subscribe(t=>{this.contentNode=t.node,this.router.navigate([r.ru.ROUTER_PREFIX+"render",o.element.ref.id])}):this.clickItem.emit(o)}isAllowedToDeleteNodes(o){return this.isAllowedToDeleteCollection()||this.nodeHelper.getNodesRight(o,d.u.ACCESS_DELETE)}isAllowedToDeleteCollection(){return!this.isRootLevel&&S.b.hasAccessPermission(this.collection,d.u.PERMISSION_DELETE)}deleteFromCollection(o=null){this.toast.showProgressSpinner(),this.collectionService.removeFromCollection(this.contentNode.ref.id,this.collection.ref.id).subscribe(()=>{"proposal"in this.collection||this.toast.toast("COLLECTIONS.REMOVED_FROM_COLLECTION"),this.toast.closeProgressSpinner(),this.refreshContent(),o&&o()},t=>{this.toast.closeProgressSpinner(),this.toast.error(t)})}registerMainNav(){var o=this;this.mainNavService.setMainNavConfig({title:"COLLECTIONS.TITLE",currentScope:"collections",onCreate:t=>this.addNodesToCollection(t)}),this.mainNavService.onConnectorCreated.pipe((0,W.R)(this.destroyed$)).subscribe(t=>this.addNodesToCollection([t])),this.mainNavUpdateTrigger.pipe((0,W.R)(this.destroyed$)).subscribe((0,C.Z)(function*(){o.mainNavService.patchMainNavConfig({create:{allowed:o.createAllowed(),allowBinary:!o.isRootLevel&&(yield o.isAllowedToEditCollection()),parent:o.collection??null}})}))}refreshContent(){this.dataSourceCollections.reset(),this.dataSourceReferences.reset(),this.listReferences?.getSelection().clear(),this.dataSourceCollections.isLoading=!0,this.dataSourceReferences.isLoading=!0;const o=V.W.deepCopy(A.DEFAULT_REQUEST);this.sortCollections?.active?(o.sortBy=[this.sortCollections.active],o.sortAscending=["asc"===this.sortCollections.direction]):console.warn("Sort for collections is not defined in the mds!"),this.isRootLevel?(o.sortBy=[d.u.CCM_PROP_COLLECTION_PINNED_STATUS,d.u.CCM_PROP_COLLECTION_PINNED_ORDER,...o.sortBy],o.sortAscending=[!1,!0,...o.sortAscending]):o.count=d.u.COUNT_UNLIMITED,this.collectionService.getCollectionSubcollections(this.collection.ref.id,this.scope,[],o,this.collection.ref.repo).subscribe(t=>{if(this.dataSourceCollections.setData(t.collections,t.pagination),this.dataSourceCollections.isLoading=!1,this.isRootLevel)return void this.finishCollectionLoading();const i=this.getReferencesRequest();i.count=null,this.collectionService.getCollectionReferences(this.collection.ref.id,[d.u.ALL],i,this.collection.ref.repo).subscribe(c=>{this.dataSourceReferences.setData(c.references,c.pagination),this.dataSourceReferences.isLoading=!1,this.finishCollectionLoading()})},t=>{this.toast.error(t)})}isMobile(){return this.uiService.isMobile()}setReferenceSort(o){var t=this;return(0,C.Z)(function*(){const i=V.W.getKeysWithDifferentValues(t.sortReferences,o);if(t.sortReferences=o,i.includes("active")&&(t.sortReferences.customSortingInProgress=t.sortReferences.active===d.u.CCM_PROP_COLLECTION_ORDERED_POSITION),t.toggleReferencesOrder(),t.sortReferences.customSortingInProgress&&(yield t.loadMoreReferences({reset:!0,amount:d.u.COUNT_UNLIMITED,offset:0})),!i.includes("customSortingInProgress")||!o.customSortingInProgress){try{yield t.nodeService.editNodeProperty(t.collection.ref.id,d.u.CCM_PROP_COLLECTION_ORDER_MODE,[o.active,("asc"===o.direction)+""]).toPromise(),o.active!==d.u.CCM_PROP_COLLECTION_ORDERED_POSITION&&t.toast.toast("COLLECTIONS.TOAST.SORT_SAVED_TYPE",{type:t.translation.instant("NODE."+o.active)})}catch(c){t.toast.error(c)}t.refreshContent()}})()}getReferencesRequest(){return{sortBy:[this.sortReferences.active],sortAscending:["asc"===this.sortReferences.direction]}}loadMoreReferences(o){var t=this;return(0,C.Z)(function*(){if(!(yield t.dataSourceReferences.hasMore())||t.dataSourceReferences.isLoading)return;const i=t.getReferencesRequest();i.offset=o.offset??(yield t.dataSourceReferences.getData()).length,null!=o.amount&&(i.count=o.amount),o.reset&&t.dataSourceReferences.reset(),t.dataSourceReferences.isLoading=!0,t.collectionService.getCollectionReferences(t.collection.ref.id,[d.u.ALL],i,t.collection.ref.repo).subscribe(c=>{t.dataSourceReferences.appendData(c.references),t.dataSourceReferences.isLoading=!1})})()}loadMoreCollections(){var o=this;return(0,C.Z)(function*(){if(!(yield o.dataSourceCollections.hasMore())||o.dataSourceCollections.isLoading)return;const t=V.W.deepCopy(A.DEFAULT_REQUEST);t.offset=(yield o.dataSourceCollections.getData()).length,o.dataSourceCollections.isLoading=!0,o.collectionService.getCollectionSubcollections(o.collection.ref.id,o.scope,[],t,o.collection.ref.repo).subscribe(i=>{o.dataSourceCollections.appendData(i.collections),o.dataSourceCollections.isLoading=!1})})()}finishCollectionLoading(o){this.mainNavService.getMainNav()?.refreshBanner(),o&&o(),setTimeout(()=>{this.setOptionsCollection(),this.listReferences?.initOptionsGenerator({actionbar:this.actionbarReferences,parent:this.collection}),this.loadingTask.isDone||this.loadingTask.done()})}deleteReference(o){this.contentNode=o,this.deleteFromCollection()}setCollectionSort(o){var t=this;return(0,C.Z)(function*(){t.sortCollections=o;try{yield t.nodeService.editNodeProperty(t.collection.ref.id,d.u.CCM_PROP_COLLECTION_SUBCOLLECTION_ORDER_MODE,[t.sortCollections.active,("asc"===t.sortCollections.direction)+""]).toPromise()}catch(i){t.toast.error(i)}t.refreshContent(),o.active!==d.u.CCM_PROP_COLLECTION_ORDERED_POSITION&&t.toast.toast("COLLECTIONS.TOAST.SORT_SAVED_TYPE",{type:t.translation.instant("NODE."+o.active)}),t.sortCollections.active===d.u.CCM_PROP_COLLECTION_ORDERED_POSITION?t.toggleCollectionsOrder():t.infobar.close()})()}setOptionsCollection(){this.optionsService.setData({scope:r.sX.CollectionsCollection,activeObjects:[this.collection]}),this.optionsService.initComponents(this.getInfobar()?.actionbar,this.listReferences),this.optionsService.refreshComponents()}toggleCollectionsOrder(){var o=this;return(0,C.Z)(function*(){if(o.sortCollections.customSortingInProgress){const t=yield o.infobar.open({title:"COLLECTIONS.ORDER_COLLECTIONS",message:"COLLECTIONS.ORDER_COLLECTIONS_INFO",buttons:[{label:"SAVE",config:{color:"primary"}}]});if(console.log("response",t),"SAVE"===t)return o.changeCollectionsOrder();o.sortCollections.customSortingInProgress=!1}else o.infobar.close();o.refreshContent()})()}toggleReferencesOrder(){var o=this;return(0,C.Z)(function*(){if(o.sortReferences.customSortingInProgress){const t=yield o.infobar.open({title:"COLLECTIONS.ORDER_ELEMENTS",message:"COLLECTIONS.ORDER_ELEMENTS_INFO",buttons:[{label:"SAVE",config:{color:"primary"}}]});o.sortReferences.customSortingInProgress=!1,"SAVE"===t?(o.changeReferencesOrder(),o.listReferences.getSelection().clear()):o.refreshContent()}else o.infobar.close()})()}addNodesToCollection(o,t=!1){this.toast.showProgressSpinner(),m.d.addToCollection(this.nodeHelper,this.collectionService,this.router,this.bridge,this.collection,o,!1,()=>{this.refreshContent(),this.toast.closeProgressSpinner()},t)}changeReferencesOrder(){var o=this;return(0,C.Z)(function*(){o.toast.showProgressSpinner(),o.collectionService.setOrder(o.collection.ref.id,S.b.getNodeIds(yield o.dataSourceReferences.getData())).subscribe(()=>{o.toast.toast("COLLECTIONS.TOAST.SORT_SAVED_CUSTOM"),o.toast.closeProgressSpinner()},t=>{o.toast.closeProgressSpinner(),o.toast.error(t)})})()}changeCollectionsOrder(){var o=this;return(0,C.Z)(function*(){o.toast.showProgressSpinner(),o.collectionService.setOrder(o.collection.ref.id,S.b.getNodeIds(yield o.dataSourceCollections.getData())).subscribe(()=>{o.sortCollections.customSortingInProgress=!1,o.toast.toast("COLLECTIONS.TOAST.SORT_SAVED_CUSTOM"),o.toast.closeProgressSpinner()},t=>{o.toast.closeProgressSpinner(),o.toast.error(t)})})()}canDelete(o){return S.b.hasAccessPermission(o,"Delete")}isDeleted(o){return o.aspects.includes(d.u.CCM_ASPECT_IO_REFERENCE)&&!o.aspects.includes(d.u.CCM_ASPECT_REMOTEREPOSITORY)&&!o.originalId}static#t=this.\u0275fac=function(t){return new(t||A)(e.Y36(v.$h),e.Y36(k.d),e.Y36(_e.i),e.Y36(v.E4),e.Y36(ie.H),e.Y36(vt),e.Y36(oe.O),e.Y36($.ZF),e.Y36(v.Pf),e.Y36(f.G),e.Y36(bt.x),e.Y36(r.tC),e.Y36(T.gz),e.Y36(T.F0),e.Y36(D.F),e.Y36(x.sK),e.Y36(xt.V))};static#n=this.\u0275cmp=e.Xpm({type:A,selectors:[["es-collection-content"]],contentQueries:function(t,i,c){if(1&t&&e.Suo(c,Nt,5),2&t){let s;e.iGM(s=e.CRH())&&(i.emptyRef=s.first)}},viewQuery:function(t,i){if(1&t&&(e.Gf(wt,5),e.Gf(At,5)),2&t){let c;e.iGM(c=e.CRH())&&(i.actionbarReferences=c.first),e.iGM(c=e.CRH())&&(i.listReferences=c.first)}},inputs:{collection:"collection",interactionType:"interactionType",scope:"scope",getInfobar:"getInfobar",isRootLevel:"isRootLevel",createAllowed:"createAllowed"},outputs:{clickItem:"clickItem"},features:[e.TTD],decls:10,vars:26,consts:[["role","main","esSkipTarget","MAIN_CONTENT",1,"collections-master-div"],[1,"collections-cards-div"],[1,"collections-wrapper"],[3,"dataSource","elementInteractionType","columns","displayType","globalOptions","dragDrop","sort","clickItem","fetchData","sortChange"],["title",""],["empty",""],[4,"ngIf"],[1,"heading-group"],["class","mat-heading-3",4,"ngIf"],[1,"mat-heading-3"],["class","collection-nocontent-container collection-nocontent-big",4,"ngIf"],[1,"collection-nocontent-container","collection-nocontent-big"],[4,"ngTemplateOutlet"],[1,"collection-nocontent-big"],[1,"section-headline","collection-nocontent-container"],[1,"collection-nocontent-small"],[3,"collection","canEdit","onContentClick"],["class","collections-cards-div",4,"ngIf"],[1,"actionbarMaterials",3,"numberOfAlwaysVisibleOptions"],["actionbarReferences",""],[1,"references-wrapper"],[3,"elementInteractionType","dataSource","scope","primaryInstance","columns","displayType","dragDrop","sort","globalOptions","displayTypeChange","clickItem","sortChange","fetchData"],["listReferences",""],["overlay",""],["class","section-headline collection-nocontent-container",4,"ngIf"],[1,"content-header","heading-group"],["class","node-deleted",4,"ngIf"],[1,"node-deleted"],["esIcon","delete"],[1,"headline"],[1,"subline"],["mat-button","","color","primary",3,"click",4,"ngIf"],["mat-button","","color","primary",3,"click"],["class","collection-nocontent-small",4,"ngIf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"section",1)(2,"div",2)(3,"es-node-entries-wrapper",3),e.NdJ("clickItem",function(s){return i.clickItem.emit(s)})("fetchData",function(){return i.loadMoreCollections()})("sortChange",function(s){return i.setCollectionSort(s)}),e.YNc(4,Dt,2,1,"ng-template",null,4,e.W1O),e.YNc(6,Yt,1,1,"ng-template",null,5,e.W1O),e.qZA(),e.YNc(8,Gt,8,6,"div",6),e.qZA()(),e.YNc(9,Wt,3,3,"ng-container",6),e.qZA()),2&t){let c;e.xp6(2),e.ekj("wrapper-empty",i.dataSourceCollections.isEmpty())("wrapper-edit",i.isUserAllowedToEdit(i.collection)),e.xp6(1),e.Q6J("dataSource",i.dataSourceCollections)("elementInteractionType",i.interactionType)("columns",i.collectionsColumns)("displayType",i.NodeEntriesDisplayType.SmallGrid)("globalOptions",i.createAllowed()?e.VKq(13,Vt,i.createSubCollectionOptionItem):e.DdM(15,Ce))("dragDrop",e.kEZ(16,pe,i.isAllowedToEditCollection(),i.canDropOnCollection,i.dropOnCollection))("sort",e.qbA(20,ge,i.sortCollections.active,i.sortCollections.direction,i.sortCollections.customSortingInProgress,i.sortCollections.columns,!i.isMobile()&&(null==(c=i.dataSourceCollections.getData())?null:c.length)>1&&i.isUserAllowedToEdit(i.collection)&&!(null!=i.sortReferences&&i.sortReferences.customSortingInProgress))),e.xp6(5),e.Q6J("ngIf",!i.isRootLevel&&i.dataSourceCollections.isEmpty()&&!i.dataSourceCollections.isLoading&&i.isUserAllowedToEdit(i.collection)),e.xp6(1),e.Q6J("ngIf",!i.isRootLevel)}},dependencies:[g.O5,g.tP,r.nv,r.ar,r.cE,w.lW,se.P,Lt,x.X$],styles:[".collections-cards-div[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:30px}.collections-cards-div[_ngcontent-%COMP%]   .heading-group[_ngcontent-%COMP%]{display:flex;align-items:center}.collections-cards-div[_ngcontent-%COMP%]   .heading-group[_ngcontent-%COMP%] > h2[_ngcontent-%COMP%]{flex-grow:1;margin:5px 10px 0 0}.collections-cards-div[_ngcontent-%COMP%]   .heading-group[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin-right:20px}.collection-nocontent-container[_ngcontent-%COMP%]{text-align:left;float:left;width:100%}es-collection-proposals[_ngcontent-%COMP%]{display:block;width:100%;padding-bottom:10px}.collection-nocontent-big[_ngcontent-%COMP%]{font-size:110%;color:#383838;margin:20px 0;width:100%}.collection-nocontent-small[_ngcontent-%COMP%]{padding:0 16px 16px 0;color:var(--textLight)}.actionbarMaterials[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:20px 30px;margin:-20px -20px 0}.node-deleted[_ngcontent-%COMP%]{height:100%;background-color:#ffffffb3;-webkit-backdrop-filter:blur(3px);backdrop-filter:blur(3px);display:flex;justify-content:center;text-align:center;align-items:center}.node-deleted[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{opacity:1;padding-bottom:7px}.node-deleted[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:26pt;color:var(--palette-foreground-text)}.node-deleted[_ngcontent-%COMP%]   .headline[_ngcontent-%COMP%]{color:var(--palette-foreground-text);font-size:120%}.node-deleted[_ngcontent-%COMP%]   .subline[_ngcontent-%COMP%]{color:var(--textLight);font-size:90%}.node-deleted[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-transform:uppercase;font-weight:700}.node-deleted[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;top:7px}.references-wrapper.wrapper-empty.wrapper-edit[_ngcontent-%COMP%], .collections-wrapper.wrapper-empty.wrapper-edit[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content auto;grid-gap:50px;align-items:center}.references-wrapper.wrapper-empty.wrapper-edit.wrapper-table[_ngcontent-%COMP%]   es-node-entries-wrapper[_ngcontent-%COMP%], .collections-wrapper.wrapper-empty.wrapper-edit.wrapper-table[_ngcontent-%COMP%]   es-node-entries-wrapper[_ngcontent-%COMP%]{display:none}@media only screen and (max-width: 800px){.references-wrapper.wrapper-empty.wrapper-edit[_ngcontent-%COMP%], .collections-wrapper.wrapper-empty.wrapper-edit[_ngcontent-%COMP%]{grid-gap:0;grid-template-columns:auto}.references-wrapper.wrapper-empty.wrapper-edit[_ngcontent-%COMP%]   .collection-nocontent-container[_ngcontent-%COMP%], .collections-wrapper.wrapper-empty.wrapper-edit[_ngcontent-%COMP%]   .collection-nocontent-container[_ngcontent-%COMP%]{padding:0 20px}}"]})}var zt=a(98588),Xt=a(2361);const $t=["actionbar"],en=["mds"];function tn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"div",19)(2,"div",20),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.edit.emit())}),e._UZ(3,"i",21),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Udp("cursor",t.isAllowedToEditCollection()?"pointer":"auto")}}const ue=function(){return{maxWidth:300,maxHeight:300,crop:!0}};function nn(n,o){if(1&n&&(e._UZ(0,"img",24),e.ALo(1,"async"),e.ALo(2,"esNodeImage")),2&n){const t=e.oxw(2);e.Q6J("src",e.lcZ(1,1,e.xi3(2,3,t.collection,e.DdM(6,ue))),e.LSH)}}function on(n,o){if(1&n&&(e.TgZ(0,"div",19),e._UZ(1,"img",22),e.ALo(2,"async"),e.ALo(3,"esNodeImage"),e.YNc(4,nn,3,7,"img",23),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("src",e.lcZ(2,2,e.xi3(3,4,t.collection,e.DdM(7,ue))),e.LSH),e.xp6(3),e.Q6J("ngIf",null==t.collection||null==t.collection.preview?null:t.collection.preview.url)}}function cn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",25),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.edit.emit())}),e.qZA()}}function ln(n,o){if(1&n&&(e.TgZ(0,"div",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.AsE(" ",t.collection.collection.childCollectionsCount," ",e.lcZ(2,2,"COLLECTION.INFO_REFERENCES_MULTI")," ")}}function sn(n,o){if(1&n&&(e.TgZ(0,"div",26),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.AsE(" ",t.collection.collection.childReferencesCount," ",e.lcZ(2,2,"COLLECTION.INFO_CHILDS_MULTI")," ")}}function rn(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.ALo(2,"authorityName"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.collection.owner))}}function an(n,o){if(1&n&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(t.collection.collection.authorFreetext)}}function dn(n,o){if(1&n&&e._UZ(0,"es-mds-viewer",27,28),2&n){const t=e.oxw();e.Q6J("data",t.collection.properties)("headingLevel",2)}}function _n(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"es-user-avatar",31),e.TgZ(2,"span"),e._uU(3),e.ALo(4,"authorityName"),e.qZA(),e.BQk()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("user",t),e.xp6(2),e.Oqu(e.lcZ(4,2,"GROUP"===t.authority.authorityType?t.group:t.user))}}function pn(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,_n,5,4,"ng-container",13),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf","EVERYONE"!==t.authority.authorityType)}}function gn(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",15),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",32),e._uU(5),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",e.lcZ(3,2,"COLLECTIONS.STATS.TOTAL")," "),e.xp6(3),e.hij(" ",t.stats.total.VIEW_COLLECTION," ")}}function Cn(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"h2",15),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",29),e.YNc(5,pn,2,1,"div",30),e.qZA(),e.YNc(6,gn,6,4,"ng-container",13),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.hij(" ",e.lcZ(3,3,"COLLECTIONS.PERMISSIONS")," "),e.xp6(3),e.Q6J("ngForOf",t.permissions),e.xp6(1),e.Q6J("ngIf",t.stats)}}let un=(()=>{class n{constructor(t,i){this.nodeHelper=t,this.nodeService=i,this.edit=new e.vpe}ngOnChanges(t){var i=this;return(0,C.Z)(function*(){t.collection?.currentValue&&i.collection.access.includes(d.u.ACCESS_CHANGE_PERMISSIONS)&&(i.stats=yield i.nodeService.getStats(i.collection.ref.id).toPromise())})()}isBrightColor(){return r.vH.getPreferredColor(this.collection?.collection?.color)===r.Sv.White}hasNonIconPreview(){const t=this.collection?.preview;return t&&!t.isIcon}isAllowedToEditCollection(){return S.b.hasAccessPermission(this.collection,d.u.PERMISSION_WRITE)}getScopeInfo(){return this.nodeHelper.getCollectionScopeInfo(this.collection)}static#e=this.\u0275fac=function(i){return new(i||n)(e.Y36(f.G),e.Y36(v.sX))};static#t=this.\u0275cmp=e.Xpm({type:n,selectors:[["es-collection-info-bar"]],viewQuery:function(i,c){if(1&i&&(e.Gf($t,5),e.Gf(en,5)),2&i){let s;e.iGM(s=e.CRH())&&(c.actionbar=s.first),e.iGM(s=e.CRH())&&(c.mds=s.first)}},inputs:{collection:"collection",permissions:"permissions"},outputs:{edit:"edit"},features:[e.TTD],decls:29,vars:36,consts:[["role","complementary",1,"collections-header"],[1,"card-collection-image-container",2,"width","100%"],["style","width: 250px; height: 200px; margin-left: auto; margin-right: auto",4,"ngIf"],["class","card-image-icon-container",4,"ngIf"],["role","presentation","class","big-edit-button",3,"click",4,"ngIf"],[1,"collections-header-textarea"],[1,"collection-option"],["appearance","round",3,"numberOfAlwaysVisibleOptions","numberOfAlwaysVisibleOptionsMobile","dropdownPosition"],["actionbar",""],["esTitle","",1,"collection-new-preview-headline","collections-header-texttop",2,"overflow","hidden"],["class","collection-new-preview-subline collections-header-texttop",4,"ngIf"],[1,"collection-new-preview-infoline"],["esIcon","person",1,"icon-bottom",3,"altText"],[4,"ngIf"],[1,"icon-bottom",3,"esIcon","altText"],[1,"collection-permissions","collection-label"],[1,"collections-metadata"],["groupId","collection_sidebar",3,"data","headingLevel",4,"ngIf"],[2,"width","250px","height","200px","margin-left","auto","margin-right","auto"],[1,"card-image-icon-container"],[1,"card-image-icon-circle",3,"click"],["esIcon","layers"],["role","presentation",1,"blurred-image",3,"src"],["class","collection-header-image","role","presentation",3,"src",4,"ngIf"],["role","presentation",1,"collection-header-image",3,"src"],["role","presentation",1,"big-edit-button",3,"click"],[1,"collection-new-preview-subline","collections-header-texttop"],["groupId","collection_sidebar",3,"data","headingLevel"],["mds",""],[1,"collection-permissions","collection-content"],[4,"ngFor","ngForOf"],["size","xsmall",3,"user"],[1,"collection-stats","collection-content"]],template:function(i,c){1&i&&(e.TgZ(0,"div",0),e.ALo(1,"translate"),e.TgZ(2,"div",1),e.YNc(3,tn,4,2,"div",2),e.YNc(4,on,5,8,"div",3),e.YNc(5,cn,1,0,"div",4),e.qZA(),e.TgZ(6,"div",5)(7,"div",6),e._UZ(8,"es-actionbar",7,8),e.qZA(),e.TgZ(10,"h1",9),e._uU(11),e.qZA(),e.YNc(12,ln,3,4,"div",10),e.YNc(13,sn,3,4,"div",10),e.TgZ(14,"div",11),e._UZ(15,"i",12),e.ALo(16,"translate"),e._uU(17," \xa0 "),e.YNc(18,rn,3,3,"span",13),e.YNc(19,an,2,1,"span",13),e.qZA(),e.TgZ(20,"div",11),e._UZ(21,"i",14),e.ALo(22,"translate"),e._uU(23),e.ALo(24,"translate"),e.qZA(),e._UZ(25,"div",15),e.TgZ(26,"div",16),e.YNc(27,dn,2,2,"es-mds-viewer",17),e.qZA(),e.YNc(28,Cn,7,5,"ng-container",13),e.qZA()()),2&i&&(e.Udp("background-color",null==c.collection||null==c.collection.collection?null:c.collection.collection.color),e.ekj("dark-color",c.isBrightColor()),e.uIk("aria-label",e.lcZ(1,28,"COLLECTIONS.DETAILS")),e.xp6(2),e.ekj("card-collection-icon-container",!c.hasNonIconPreview()),e.xp6(1),e.Q6J("ngIf",!c.hasNonIconPreview()),e.xp6(1),e.Q6J("ngIf",c.hasNonIconPreview()),e.xp6(1),e.Q6J("ngIf",c.isAllowedToEditCollection()),e.xp6(1),e.ekj("collections-header-textarea-bright",c.isBrightColor()),e.xp6(2),e.Akn("flat"),e.Q6J("numberOfAlwaysVisibleOptions",1)("numberOfAlwaysVisibleOptionsMobile",1)("dropdownPosition","right"),e.xp6(3),e.hij(" ",null==c.collection?null:c.collection.title," "),e.xp6(1),e.Q6J("ngIf",null==c.collection||null==c.collection.collection?null:c.collection.collection.childCollectionsCount),e.xp6(1),e.Q6J("ngIf",null==c.collection||null==c.collection.collection?null:c.collection.collection.childReferencesCount),e.xp6(2),e.Q6J("altText",e.lcZ(16,30,"COLLECTIONS.CREATOR")+": "),e.xp6(3),e.Q6J("ngIf",!(null!=c.collection&&null!=c.collection.collection&&c.collection.collection.authorFreetext)),e.xp6(1),e.Q6J("ngIf",null==c.collection||null==c.collection.collection?null:c.collection.collection.authorFreetext),e.xp6(2),e.Q6J("esIcon",c.getScopeInfo().icon)("altText",e.lcZ(22,32,"COLLECTIONS.SHARING_STATE")+": "),e.xp6(2),e.hij(" \xa0",e.lcZ(24,34,"COLLECTION.SCOPE."+c.getScopeInfo().scopeName)," "),e.xp6(4),e.Q6J("ngIf",null==c.collection?null:c.collection.properties),e.xp6(1),e.Q6J("ngIf",-1!==(null==c.collection||null==c.collection.access?null:c.collection.access.indexOf("ChangePermissions"))&&c.permissions))},dependencies:[g.sg,g.O5,r.nv,r.ar,ae.M,zt.k,Xt.i,Z.F,g.Ov,x.X$,r.PW],styles:[".collections-header-textarea[_ngcontent-%COMP%]{position:relative;padding:50px 20px 30px}.collections-header-texttop[_ngcontent-%COMP%]{text-align:left}.collections-header[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff;left:0;width:100%;height:100%;position:relative;z-index:1}.collections-header[_ngcontent-%COMP%]   .collection-loading[_ngcontent-%COMP%]{position:absolute;z-index:10;display:flex;width:100%;height:100%;align-items:center;justify-content:center;background-color:#ffffffbf;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.dark-color[_ngcontent-%COMP%]{color:#000}.collection-new-preview-headline[_ngcontent-%COMP%]{word-break:normal;overflow-wrap:break-word;line-height:normal;margin:0}.collection-new-preview-infoarea[_ngcontent-%COMP%]{min-height:120px;padding:16px;color:#fff}.card-image-icon-circle[_ngcontent-%COMP%]{width:90px;height:90px;border-radius:50%;background-color:#0000001a;display:flex;align-items:center;justify-content:center;cursor:default;-webkit-user-select:none;user-select:none}.card-image-icon-circle[_ngcontent-%COMP%] > i[_ngcontent-%COMP%]{color:#fff;font-size:45px}.collection-new-preview-headline[_ngcontent-%COMP%]{font-size:150%;padding-bottom:15px}.collection-new-preview-subline[_ngcontent-%COMP%]{opacity:.85}.collection-new-preview-infoline[_ngcontent-%COMP%]{display:flex;align-items:center;opacity:.85;margin-top:16px;margin-left:-2px;margin-bottom:4px}.card-collection-image-container[_ngcontent-%COMP%]{position:relative;text-align:center;vertical-align:middle;height:200px}.card-image-icon-container[_ngcontent-%COMP%]{position:relative;height:220px;width:100%;overflow:hidden;margin:auto;text-align:center;display:flex;align-items:center;justify-content:center}.card-image-icon-container[_ngcontent-%COMP%]   .blurred-image[_ngcontent-%COMP%]{display:block;filter:blur(15px)}.card-image-icon-container[_ngcontent-%COMP%]   .collection-header-image[_ngcontent-%COMP%]{height:100%;width:100%;object-fit:contain;margin:auto;z-index:1;position:relative;box-shadow:0 10px 70px #00000026}.big-edit-button[_ngcontent-%COMP%]{position:absolute;top:0;left:0;height:100%;width:100%;cursor:pointer;border-radius:50%;opacity:0}.collection-option[_ngcontent-%COMP%]{position:absolute;top:-23px;left:0;right:0;display:flex;justify-content:center;z-index:1}.collection-option[_ngcontent-%COMP%]     .actionbar>button.mat-button.cdk-keyboard-focused{outline-color:#fff}.collections-header-textarea[_ngcontent-%COMP%]{background-color:#00000026}.collections-header-textarea.collections-header-textarea-bright[_ngcontent-%COMP%]{background-color:#ffffff26}.collections-header-textarea[_ngcontent-%COMP%]   .collection-label[_ngcontent-%COMP%], .collections-header-textarea[_ngcontent-%COMP%]   .collection-metadata[_ngcontent-%COMP%]{margin:18px 0 0;padding-top:18px;border-top:1px solid rgba(0,0,0,.25);opacity:.8;font-size:90%}.collections-header-textarea[_ngcontent-%COMP%]   .collection-content[_ngcontent-%COMP%]{margin-top:5px}.collections-header-textarea[_ngcontent-%COMP%]   .collection-permissions.collection-content[_ngcontent-%COMP%]{display:flex;flex-direction:column}.collections-header-textarea[_ngcontent-%COMP%]   .collection-permissions.collection-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;padding:3px 0}.collections-header-textarea[_ngcontent-%COMP%]   .collection-permissions.collection-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > es-user-avatar[_ngcontent-%COMP%]{height:24px;margin-right:9px}.collections-header-textarea[_ngcontent-%COMP%]   .collection-permissions.collection-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;line-height:1.25em;max-height:2.5em;-webkit-line-clamp:2;-webkit-box-orient:vertical}"]})}return n})();const hn=["collectionContentTemplate"],mn=["infobar"],On=["collectionContentComponent"];function fn(n,o){1&n&&(e._UZ(0,"i",24),e.TgZ(1,"span",25),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"COLLECTIONS.TAB.MY")))}function Tn(n,o){1&n&&(e.TgZ(0,"mat-tab",23),e.YNc(1,fn,4,3,"ng-template",22),e.qZA())}function En(n,o){1&n&&(e._UZ(0,"i",27),e.TgZ(1,"span",25),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"COLLECTIONS.TAB.EDU_GROUPS")))}function Pn(n,o){1&n&&(e.TgZ(0,"mat-tab",26),e.YNc(1,En,4,3,"ng-template",22),e.qZA())}function In(n,o){1&n&&(e._UZ(0,"i",29),e.TgZ(1,"span",25),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"COLLECTIONS.TAB.TYPE_EDITORIAL")))}function vn(n,o){1&n&&(e.TgZ(0,"mat-tab",28),e.YNc(1,In,4,3,"ng-template",22),e.qZA())}function bn(n,o){1&n&&(e._UZ(0,"i",31),e.TgZ(1,"span",25),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"COLLECTIONS.TAB.TYPE_MEDIA_CENTER")))}function xn(n,o){1&n&&(e.TgZ(0,"mat-tab",30),e.YNc(1,bn,4,3,"ng-template",22),e.qZA())}function Mn(n,o){1&n&&(e._UZ(0,"i",32),e.TgZ(1,"span",25),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"COLLECTIONS.TAB.EDU_ALL")))}function Sn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-tab-group",16),e.NdJ("selectedIndexChange",function(c){e.CHM(t);const s=e.oxw();return e.KtG(s.tabSelectedIndex=c)}),e.ALo(1,"translate"),e.YNc(2,Tn,2,0,"mat-tab",17),e.YNc(3,Pn,2,0,"mat-tab",18),e.YNc(4,vn,2,0,"mat-tab",19),e.YNc(5,xn,2,0,"mat-tab",20),e.TgZ(6,"mat-tab",21),e.YNc(7,Mn,4,3,"ng-template",22),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("color","dark")("selectedIndex",t.tabSelectedIndex),e.uIk("aria-label",e.lcZ(1,7,"NAV.COLLECTIONS")),e.xp6(2),e.Q6J("ngIf",!t.isGuest),e.xp6(1),e.Q6J("ngIf",!t.isGuest),e.xp6(1),e.Q6J("ngIf",t.hasEditorial),e.xp6(1),e.Q6J("ngIf",t.hasMediacenter)}}function Ln(n,o){1&n&&e._UZ(0,"es-actionbar",33,34),2&n&&(e.Akn("flat"),e.Q6J("numberOfAlwaysVisibleOptions",1)("numberOfAlwaysVisibleOptionsMobile",1)("dropdownPosition","right"))}function Nn(n,o){}function wn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"es-collection-info-bar",35,36),e.NdJ("edit",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.collectionEdit())}),e.qZA()}if(2&n){const t=e.oxw();let i;e.Q6J("collection",t.collection)("permissions",null!==(i=null==t.collectionContentRef?null:t.collectionContentRef.permissions)&&void 0!==i?i:null)}}function An(n,o){1&n&&(e.TgZ(0,"section",37),e._UZ(1,"es-spinner"),e.qZA())}function Rn(n,o){1&n&&(e.TgZ(0,"h1",38),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"COLLECTIONS.TITLE")," "))}const yn=function(n){return[n]};function Zn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",39),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.navigateToSearch())}),e.ALo(1,"translate"),e._uU(2),e.ALo(3,"translate"),e._UZ(4,"i",40),e.qZA()}if(2&n){const t=e.oxw();e.s9C("title",e.lcZ(1,3,"COLLECTIONS.TO_SEARCH")),e.Q6J("routerLink",e.VKq(7,yn,"/"+t.ROUTER_PREFIX+"search")),e.xp6(2),e.hij(" ",e.lcZ(3,5,"COLLECTIONS.TO_SEARCH")," ")}}const Dn=function(){return["."]},kn=function(n){return{scope:n}},Un=function(n,o){return{routerLink:n,queryParams:o}};function Yn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",45),e.ALo(1,"translate"),e.TgZ(2,"es-breadcrumbs",46),e.NdJ("onDrop",function(c){e.CHM(t),e.oxw();const s=e.MAs(3);return e.KtG(s.dropOnCollection(c.target,c.source))}),e.qZA()()}if(2&n){e.oxw();const t=e.MAs(3),i=e.oxw();e.uIk("aria-label",e.lcZ(1,5,"NAV.COLLECTIONS")),e.xp6(2),e.Q6J("home","COLLECTIONS.TAB."+i.tabSelected)("homeRouterLink",e.WLB(10,Un,e.DdM(7,Dn),e.VKq(8,kn,i.tabSelected)))("invisibleDescription",!0)("canDropNodes",t.canDropOnCollectionBreadcrumbs)}}function Gn(n,o){1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"COLLECTIONS.EMPTY.SHARED")," "))}function Jn(n,o){1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"COLLECTIONS.EMPTY.PUBLIC")," "))}function Fn(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Gn,3,3,"ng-container",13),e.YNc(2,Jn,3,3,"ng-container",13),e.BQk()),2&n){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf","EDU_GROUPS"===t.tabSelected),e.xp6(1),e.Q6J("ngIf","EDU_ALL"===t.tabSelected)}}function Qn(n,o){1&n&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&n&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"COLLECTIONS.EMPTY.SUBCOLLECTIONS")," "))}function Hn(n,o){if(1&n&&(e.YNc(0,Fn,3,2,"ng-container",13),e.YNc(1,Qn,3,3,"ng-container",13)),2&n){const t=e.oxw(2);e.Q6J("ngIf",t.isRootLevelCollection()),e.xp6(1),e.Q6J("ngIf",!t.isRootLevelCollection())}}function Bn(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Yn,3,13,"div",41),e.TgZ(2,"es-collection-content",42,43),e.YNc(4,Hn,2,2,"ng-template",null,44,e.W1O),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.isRootLevelCollection()&&!t.isLoading),e.xp6(1),e.ekj("collections-master-div-notabs",!t.showTabs()),e.Q6J("collection",t.collection)("getInfobar",t.getInfobar)("scope",t.getScope())("isRootLevel",t.isRootLevelCollection())("createAllowed",t.createAllowed)}}function qn(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"mat-slide-toggle",51),e.NdJ("ngModelChange",function(c){e.CHM(t);const s=e.oxw().sortInfo;return e.KtG(s.customActive=c)})("ngModelChange",function(c){e.CHM(t);const s=e.oxw().toggleCallback;return e.KtG(s.emit(c))}),e._uU(1),e.ALo(2,"translate"),e.qZA()}if(2&n){const t=e.oxw().sortInfo;e.Q6J("ngModel",t.customActive),e.xp6(1),e.hij(" ",e.lcZ(2,2,"COLLECTIONS.SORT_SLIDER")," ")}}function jn(n,o){if(1&n&&e._UZ(0,"i",54),2&n){const t=e.oxw(2).sortInfo;e.Q6J("esIcon","arrow_"+(t.ascending?"upward":"downward"))}}function Kn(n,o){if(1&n&&(e.TgZ(0,"button",52),e._uU(1),e.ALo(2,"translate"),e.YNc(3,jn,1,1,"i",53),e.qZA()),2&n){const t=e.oxw().sortInfo,i=e.MAs(3);e.Q6J("matMenuTriggerFor",i.menu),e.xp6(1),e.hij(" ",e.lcZ(2,3,"NODE."+t.name)," "),e.xp6(2),e.Q6J("ngIf","ccm:collection_ordered_position"!==t.name)}}function Wn(n,o){if(1&n){const t=e.EpF();e.YNc(0,qn,3,4,"mat-slide-toggle",47),e.YNc(1,Kn,4,5,"button",48),e.TgZ(2,"es-sort-dropdown",49,50),e.NdJ("onSort",function(c){const u=e.CHM(t).callback;return e.KtG(u.emit(c))}),e.qZA()}if(2&n){const t=o.columns,i=o.sortInfo,c=e.MAs(3);e.Q6J("ngIf","ccm:collection_ordered_position"===i.name),e.xp6(1),e.Q6J("ngIf",c.menu),e.xp6(1),e.Q6J("columns",t)("sortBy",i.name)("sortAscending",i.ascending)}}const Vn=function(n,o,t,i){return{$implicit:null,collection:n,permissions:o,isLoading:t,tabSelected:i}};class R{static#e=this.INDEX_MAPPING=[l.u6.COLLECTIONSCOPE_MY,l.u6.COLLECTIONSCOPE_ORGA,l.u6.COLLECTIONSCOPE_TYPE_EDITORIAL,l.u6.COLLECTIONSCOPE_TYPE_MEDIA_CENTER,l.u6.COLLECTIONSCOPE_ALL];set collectionShare(o){this._collectionShare=o,this.refreshAll()}get collectionShare(){return this._collectionShare}set tabSelectedIndex(o){this.isGuest&&(o+=2),!this.hasEditorial&&o>1&&o++,!this.hasMediacenter&&o>2&&o++,this.selectTab(R.INDEX_MAPPING[o])}get tabSelectedIndex(){let o=R.INDEX_MAPPING.indexOf(this.tabSelected);return this.isGuest&&(o-=2),!this.hasEditorial&&o>1&&o--,!this.hasMediacenter&&o>2&&o--,o}constructor(o,t,i,c,s,u,O,b,G,J,F,Q,H,B,q,j,K,p){this.breadcrumbsService=o,this.collectionService=t,this.config=i,this.connector=c,this.iamService=s,this.localEvents=u,this.mediacenterService=O,this.nodeHelper=b,this.nodeService=G,this.route=J,this.router=F,this.tempStorage=Q,this.optionsService=H,this.networkService=B,this.temporaryStorageService=q,this.toast=j,this.translations=K,this.uiService=p,this.SCOPES=r.sX,this.NodeEntriesDisplayType=r.P8,this.ROUTER_PREFIX=r.ru.ROUTER_PREFIX,this.getInfobar=()=>this.infobar,this.dialogCancelable=!1,this.tabSelected=l.u6.COLLECTIONSCOPE_MY,this.isLoading=!0,this.isReady=!1,this.collectionSortEmitter=new e.vpe,this.collectionCustomSortEmitter=new e.vpe,this.referenceSortEmitter=new e.vpe,this.referenceCustomSortEmitter=new e.vpe,this.mainnav=!0,this.isGuest=!0,this.contentDetailObject=null,this.parentCollectionId=new l.s3(l.u6.HOME_REPOSITORY,l.u6.ROOT),this.hasEditorial=!1,this.hasMediacenter=!1,this.destroyed=new I.xQ,this.createAllowed=()=>{if(this.isGuest)return!1;if(this.isRootLevelCollection()){let _=this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_CREATE_ELEMENTS_COLLECTIONS);return this.tabSelected===l.u6.COLLECTIONSCOPE_MY||(_=_&&this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_INVITE_ALLAUTHORITIES),this.tabSelected===l.u6.COLLECTIONSCOPE_ORGA?_=!1:this.tabSelected===l.u6.COLLECTIONSCOPE_TYPE_EDITORIAL?_=_&&1===this.adminMediacenters?.length:this.tabSelected===l.u6.COLLECTIONSCOPE_TYPE_EDITORIAL&&(_=_&&this.connector.hasToolPermissionInstant(l.u6.TOOLPERMISSION_COLLECTION_EDITORIAL))),_}return this.isAllowedToEditCollection()},this.translations.waitForInit().subscribe(()=>{(0,nt.aj)([this.connector.isLoggedIn(),this.networkService.getRepositories()]).subscribe(([_])=>{_.isValidLogin&&null==_.currentScope?(this.isGuest=_.isGuest,this.mediacenterService.getMediacenters().subscribe(h=>{this.adminMediacenters=h.filter(y=>y.administrationAccess)}),this.collectionService.getCollectionSubcollections(l.u6.ROOT,l.u6.COLLECTIONSCOPE_TYPE_EDITORIAL).subscribe(h=>{this.hasEditorial=h.collections.length>0}),this.collectionService.getCollectionSubcollections(l.u6.ROOT,l.u6.COLLECTIONSCOPE_TYPE_MEDIA_CENTER).subscribe(h=>{this.hasMediacenter=h.collections.length>0}),this.initialize()):l.bv.goToLogin(this.router,this.config)},()=>l.bv.goToLogin(this.router,this.config))}),this.localEvents.nodesDeleted.pipe((0,W.R)(this.destroyed),(0,ot.h)(_=>_.some(h=>h.ref.id===this.collection.ref.id))).subscribe(()=>this.navigate(this.parentCollectionId.id))}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete(),this.tempStorage.set(l.xU.NODE_RENDER_PARAMETER_DATA_SOURCE,this.collectionContentRef?.dataSourceReferences)}isMobile(){return this.uiService.isMobile()}isMobileWidth(){return window.innerWidth<r.ru.MOBILE_WIDTH}navigate(o="",t="",i=!1){m.d.getCommonParameters(this.route).subscribe(c=>{c.scope=this.tabSelected,o&&"-root-"!==o&&(c.id=o),i&&(c.feedback=i),t&&(c.addToOther=t),this.router.navigate([r.ru.ROUTER_PREFIX+"collections"],{queryParams:c})})}closeAddToOther(){this.navigate(this.collection.ref.id)}selectTab(o){(this.tabSelected!==o||this.getCollectionId()!==l.u6.ROOT)&&(this.tabSelected=o,this.parentCollectionId=new l.s3(l.u6.HOME_REPOSITORY,l.u6.ROOT),this.contentDetailObject=null,this.navigate())}isRootLevelCollection(){return this.isRootLevel}isAllowedToEditCollection(){return this.isRootLevelCollection()?!this.isGuest:l.bv.hasAccessPermission(this.collection,l.u6.PERMISSION_WRITE)}feedbackAllowed(){return!this.isGuest&&l.bv.hasAccessPermission(this.collection,l.u6.PERMISSION_FEEDBACK)}isUserAllowedToEdit(o){return l.bv.isUserAllowedToEdit(o,this.person)}pinCollection(){this.addPinning=this.collection.ref.id}getPrivacyScope(o){return o.scope}navigateToSearch(){m.d.getCommonParameters(this.route).subscribe(o=>{this.router.navigate([r.ru.ROUTER_PREFIX+"search"],{queryParams:o})})}isBrightColor(){return r.vH.getPreferredColor(this.collection?.collection?.color)===r.Sv.White}getScopeInfo(){return this.nodeHelper.getCollectionScopeInfo(this.collection)}collectionEdit(){this.isAllowedToEditCollection()&&this.router.navigate([r.ru.ROUTER_PREFIX+"collections/collection","edit",this.collection.ref.id],{queryParams:{mainnav:this.mainnav}})}getScope(){return this.tabSelected?this.tabSelected:l.u6.COLLECTIONSCOPE_ALL}onCreateCollection(){m.d.getCommonParameters(this.route).subscribe(o=>{this.router.navigate([r.ru.ROUTER_PREFIX+"collections/collection","new",this.collection.ref.id],{queryParams:o})})}onCollectionsClick(o){this.isRootLevelCollection()||(this.parentCollectionId=this.collection.ref),this.navigate(o.ref.id)}refreshAll(){this.displayCollectionById(this.collection.ref.id)}displayCollectionById(o){var t=this;return(0,C.Z)(function*(){if(o)try{t.collection=(yield t.collectionService.getCollection(o).toPromise()).collection}catch(i){i.status===l.u6.HTTP_FORBIDDEN&&((yield t.connector.isLoggedIn().toPromise()).statusCode===l.u6.STATUS_CODE_OK?t.toast.error(i):l.bv.goToLogin(t.router,t.config,null))}else t.setCollectionId(l.u6.ROOT);t.isLoading=!1,t.renderBreadcrumbs(),t.isRootLevel=!o})()}closeDialog(){this.dialogTitle=null}showTabs(){return this.isRootLevelCollection()&&(!this.isGuest||this.hasEditorial)}hasNonIconPreview(){const o=this.collection?.preview;return o&&!o.isIcon}renderBreadcrumbs(){this.breadcrumbsService.setNodePath([]),this.collection.ref.id!==l.u6.ROOT&&this.nodeService.getNodeParents(this.collection.ref.id,!1).subscribe(o=>{const t=o.nodes.reverse();t.length>1&&(this.parentCollectionId=new l.s3(t[t.length-2].ref.repo,t[t.length-2].ref.id)),this.breadcrumbsService.setNodePath(t)})}initialize(){var o=this;this.iamService.getCurrentUserAsync().then(t=>{this.person=t.person,this.isReady=!0,this.route.queryParams.subscribe(function(){var i=(0,C.Z)(function*(c){const s=V.W.getDifferentKeys(o.params,c);if(1===Object.keys(s).length&&s.viewType)return void(o.params=c);o.params=c,o.tabSelected=c.scope?c.scope:o.isGuest?l.u6.COLLECTIONSCOPE_ALL:l.u6.COLLECTIONSCOPE_MY,o.reurl=c.reurl,c.mainnav&&(o.mainnav="false"!==c.mainnav);const u=c.id;c.addToOther&&o.nodeService.getNodeMetadata(c.addToOther).subscribe(O=>{o.addToOther=[O.node]}),yield o.displayCollectionById(u)});return function(c){return i.apply(this,arguments)}}())},t=>{this.toast.error(t),this.isReady=!0})}setCollectionId(o){this.collection=new l.NB,this.collection.ref={id:o},this.collection.aspects=[l.u6.CCM_ASPECT_COLLECTION]}getCollectionId(){const o=this.collection;return null!=o&&null!=o.ref?o.ref.id:null}static#t=this.\u0275fac=function(t){return new(t||R)(e.Y36(it.d),e.Y36(l.i6),e.Y36(l.eB),e.Y36(l.xD),e.Y36(l.Du),e.Y36(r.Xn),e.Y36(l.Jh),e.Y36(f.G),e.Y36(l.xE),e.Y36(T.gz),e.Y36(T.F0),e.Y36(l.xU),e.Y36(r.tC),e.Y36(l.Eb),e.Y36(l.xU),e.Y36(D.F),e.Y36(r.fA),e.Y36(l.VL))};static#n=this.\u0275cmp=e.Xpm({type:R,selectors:[["es-collections-page"]],contentQueries:function(t,i,c){if(1&t&&e.Suo(c,hn,5),2&t){let s;e.iGM(s=e.CRH())&&(i.collectionContentTemplateRef=s.first)}},viewQuery:function(t,i){if(1&t&&(e.Gf(mn,5),e.Gf(On,5)),2&t){let c;e.iGM(c=e.CRH())&&(i.infobar=c.first),e.iGM(c=e.CRH())&&(i.collectionContentRef=c.first)}},features:[e._Bn([r.tC])],decls:18,vars:24,consts:[[3,"element","heading","description","showSkip"],["role","navigation","mat-stretch-tabs","",3,"color","selectedIndex","selectedIndexChange",4,"ngIf"],[1,"collections-header-group"],["appearance","round",3,"numberOfAlwaysVisibleOptions","numberOfAlwaysVisibleOptionsMobile","style","dropdownPosition",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["collectionContentTemplateRefDefault",""],["cdkDropList","",3,"cdkDropListSortingDisabled"],[1,"collectionsContainer"],[3,"collection","permissions","edit",4,"ngIf"],[1,"collections-right"],["class","collections-loading-div","style","padding-top: 24px; text-align: center",4,"ngIf"],["esTitle","","class","cdk-visually-hidden",4,"ngIf"],["mat-button","","color","primary","class","switchToSearch","tabindex","0",3,"title","routerLink","click",4,"ngIf"],[4,"ngIf"],[3,"scope"],["sortTool",""],["role","navigation","mat-stretch-tabs","",3,"color","selectedIndex","selectedIndexChange"],["labelClass","mat-tab-my",4,"ngIf"],["labelClass","mat-tab-groups",4,"ngIf"],["labelClass","mat-tab-editorial",4,"ngIf"],["labelClass","mat-tab-media-center",4,"ngIf"],["labelClass","mat-tab-edu-all"],["mat-tab-label",""],["labelClass","mat-tab-my"],["esIcon","person",1,"tab-icon"],[1,"tab-label"],["labelClass","mat-tab-groups"],["esIcon","group",1,"tab-icon"],["labelClass","mat-tab-editorial"],["esIcon","star",1,"tab-icon"],["labelClass","mat-tab-media-center"],["esIcon","business",1,"tab-icon"],["esIcon","language",1,"tab-icon"],["appearance","round",3,"numberOfAlwaysVisibleOptions","numberOfAlwaysVisibleOptionsMobile","dropdownPosition"],["actionbarCollection",""],[3,"collection","permissions","edit"],["infobar",""],[1,"collections-loading-div",2,"padding-top","24px","text-align","center"],["esTitle","",1,"cdk-visually-hidden"],["mat-button","","color","primary","tabindex","0",1,"switchToSearch",3,"title","routerLink","click"],["esIcon","arrow_forward"],["role","navigation","class","breadcrumb-space",4,"ngIf"],[3,"collection","getInfobar","scope","isRootLevel","createAllowed"],["collectionContentComponent",""],["empty",""],["role","navigation",1,"breadcrumb-space"],[1,"collections-breadcrumb",3,"home","homeRouterLink","invisibleDescription","canDropNodes","onDrop"],[3,"ngModel","ngModelChange",4,"ngIf"],["mat-button","","color","primary",3,"matMenuTriggerFor",4,"ngIf"],[3,"columns","sortBy","sortAscending","onSort"],["sortDropdown",""],[3,"ngModel","ngModelChange"],["mat-button","","color","primary",3,"matMenuTriggerFor"],[3,"esIcon",4,"ngIf"],[3,"esIcon"]],template:function(t,i){if(1&t&&(e._UZ(0,"es-tutorial",0),e.YNc(1,Sn,8,9,"mat-tab-group",1),e.TgZ(2,"div",2),e.YNc(3,Ln,2,5,"es-actionbar",3),e.GkF(4,4),e.YNc(5,Nn,0,0,"ng-template",null,5,e.W1O),e.qZA(),e.TgZ(7,"div",6)(8,"div",7),e.YNc(9,wn,2,2,"es-collection-info-bar",8),e.TgZ(10,"div",9),e.YNc(11,An,2,0,"section",10),e.YNc(12,Rn,3,3,"h1",11),e.YNc(13,Zn,5,9,"a",12),e.YNc(14,Bn,6,8,"ng-container",13),e.qZA()(),e._UZ(15,"es-footer",14),e.qZA(),e.YNc(16,Wn,4,5,"ng-template",null,15,e.W1O)),2&t){const c=e.MAs(6);let s,u;e.Q6J("element",i.tutorialElement)("heading","COLLECTIONS.TUTORIAL_HEADING")("description","COLLECTIONS.TUTORIAL_DESCRIPTION")("showSkip",!1),e.xp6(1),e.Q6J("ngIf",i.showTabs()),e.xp6(2),e.Q6J("ngIf",i.collectionContentTemplateRef&&!i.isRootLevelCollection()),e.xp6(1),e.Q6J("ngTemplateOutlet",null!==(s=i.collectionContentTemplateRef)&&void 0!==s?s:c)("ngTemplateOutletContext",e.l5B(19,Vn,i.collection,null!==(u=null==i.collectionContentRef?null:i.collectionContentRef.permissions)&&void 0!==u?u:null,i.isLoading,i.tabSelected)),e.xp6(3),e.Q6J("cdkDropListSortingDisabled",!0),e.xp6(1),e.ekj("collectionsContainerTabs",i.showTabs())("collectionsContainerNoSidebar",i.isRootLevelCollection()||i.isLoading),e.xp6(1),e.Q6J("ngIf",!i.isLoading&&!i.isRootLevelCollection()&&i.collection),e.xp6(2),e.Q6J("ngIf",i.isLoading||!i.isReady),e.xp6(1),e.Q6J("ngIf",i.isRootLevelCollection()),e.xp6(1),e.Q6J("ngIf",!i.isLoading&&i.isGuest),e.xp6(1),e.Q6J("ngIf",i.collection),e.xp6(1),e.Q6J("scope","collections")}},dependencies:[ct.n,g.O5,g.tP,lt.Wj,r.nv,r.ar,r.UQ,r.OR,st.c,Y.JJ,Y.On,w.zs,w.lW,rt.p6,le.Rr,ee.uD,ee.uX,ee.SP,T.rH,ae.M,at.g,A,un,x.X$],styles:["mat-tab-group[_ngcontent-%COMP%]{margin-bottom:0;position:sticky;top:var(--mainnavHeight);width:100%;z-index:15}.collectionsContainer[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:250px auto;position:relative;min-height:calc(100vh - var(--mainnavHeight))}.collectionsContainer.collectionsContainerTabs[_ngcontent-%COMP%]{min-height:calc(100vh - (var(--mainnavHeight) + 48px))}.collectionsContainer[_ngcontent-%COMP%]   es-collection-content[_ngcontent-%COMP%]{display:block;padding-top:30px}.collectionsContainer.collectionsContainerNoSidebar[_ngcontent-%COMP%]{padding:0 10%;grid-template-columns:auto}.switchToSearch[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;font-weight:700;margin-top:15px}.table-tab[_ngcontent-%COMP%]{vertical-align:bottom;text-align:center;padding:10px 10px 3px;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--primary);color:var(--primary);cursor:pointer}.table-tab-selected[_ngcontent-%COMP%]{vertical-align:bottom;padding:10px 10px 3px;background-color:#fff;border-bottom-width:3px;border-bottom-style:solid;border-bottom-color:var(--primary)}section[_ngcontent-%COMP%]{padding:20px 0}.coll-breadcrumb[_ngcontent-%COMP%]{display:inline;color:#000;margin-left:2px}.coll-breadcrumb-clickable[_ngcontent-%COMP%]{color:var(--primary);cursor:pointer}.collections-master-div[_ngcontent-%COMP%]{width:100%}.noAddPermissions[_ngcontent-%COMP%]{color:var(--textLight);padding-top:10px}.collection-header-image[_ngcontent-%COMP%]{position:relative;width:100%;height:100%;object-fit:cover}.icon-bottom[_ngcontent-%COMP%]{vertical-align:bottom}.dialog-basic-area[_ngcontent-%COMP%]{padding:16px 16px 8px}.dialog-dark-area[_ngcontent-%COMP%]{padding:16px 16px 8px;background:#efefef}.button-area[_ngcontent-%COMP%]{text-align:right}.dialog-input[_ngcontent-%COMP%]{width:90%;height:25px;padding:4px}.collections-master-div-notabs[_ngcontent-%COMP%]{padding:0 35px}.table-tab-title-short[_ngcontent-%COMP%]{display:none}.content-header[_ngcontent-%COMP%]{display:flex;width:100%}.content-header[_ngcontent-%COMP%] > .actionbarMaterials[_ngcontent-%COMP%]{margin-right:20px}[_nghost-%COMP%]     footer{float:left;width:100%}[_nghost-%COMP%]     es-collection-content .actionbarMaterials{position:sticky;top:var(--mainnavHeight);z-index:2;background-color:#fff}.breadcrumb-space[_ngcontent-%COMP%]{padding:15px 30px;background:#fff;box-shadow:0 0 5px #0000004d}@media only screen and (max-width: 1000px){[_nghost-%COMP%]     .tab-label{display:none}[_nghost-%COMP%]     .mat-tab-label-active .tab-label{display:flex}}@media all and (max-width: calc(var(--cardWidth) * 3)){[_nghost-%COMP%]     .cardSmallList{width:calc(100% - 10px)!important}}@media screen and (max-width: 900px){.switchToSearch[_ngcontent-%COMP%]{display:none}}@media only screen and (max-width: 700px){.collection-new-preview-headline[_ngcontent-%COMP%]{overflow-wrap:break-word;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;text-align:center;overflow:hidden}.collectionsContainer[_ngcontent-%COMP%]{grid-template-columns:auto}.card-image-icon-container[_ngcontent-%COMP%]{margin-top:20px}.breadcrumb-space[_ngcontent-%COMP%]{background:transparent;padding:0;margin-top:0}.collections-breadcrumb[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;z-index:1;background:rgba(255,255,255,.9);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);box-shadow:0 0 5px #0000004d;height:65px;padding-top:22px;padding-bottom:20px;padding-right:50px;margin:0}.collection-new-preview-infoline[_ngcontent-%COMP%], .collection-description[_ngcontent-%COMP%], .collection-permissions[_ngcontent-%COMP%]{display:none!important}.collections-master-div-notabs[_ngcontent-%COMP%]{margin-top:0}.collections-header[_ngcontent-%COMP%]{margin-top:0;width:100%;overflow:hidden}.collections-header-texttop[_ngcontent-%COMP%]{display:flex;justify-content:center}.table-tab-middle[_ngcontent-%COMP%]{width:unset}.collections-master-div[_ngcontent-%COMP%]{padding-left:20px;padding-right:20px}.collections-master-div-notabs[_ngcontent-%COMP%]{min-width:unset}.card-collection-image-container[_ngcontent-%COMP%]{height:200px}.collections-header-detailview[_ngcontent-%COMP%]{display:none}.tab-group[_ngcontent-%COMP%]{max-width:1000px}}@media only screen and (max-width: 900px){.collectionsContainer[_ngcontent-%COMP%]{margin-bottom:62px}}"]})}const zn=[{path:"",component:R},{path:"collection/:mode/:id",component:tt}];let Xn=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[T.Bz.forChild(zn),T.Bz]})}return n})(),$n=(()=>{class n{static#e=this.\u0275fac=function(i){return new(i||n)};static#t=this.\u0275mod=e.oAB({type:n});static#n=this.\u0275inj=e.cJS({imports:[N.m,P.x,Xn]})}return n})()},19374:(ne,L,a)=>{a.d(L,{P:()=>T});var P=a(65879),N=a(79826);let T=(()=>{class C{constructor(l,m){this.elementRef=l,this.skipNav=m}ngOnInit(){this.skipNav.register(this.target,this.elementRef.nativeElement)}ngOnDestroy(){this.skipNav.unregister(this.target)}static#e=this.\u0275fac=function(m){return new(m||C)(P.Y36(P.SBq),P.Y36(N.g))};static#t=this.\u0275dir=P.lG2({type:C,selectors:[["","esSkipTarget",""]],inputs:{target:["esSkipTarget","target"]}})}return C})()},66848:(ne,L,a)=>{a.d(L,{M:()=>X});var P=a(72079),N=a(12994),T=a(77504),C=a(96124),r=a(65879),l=a(6593),m=a(52081),Z=a(81771);let X=(()=>{class I{constructor(f,g,D,k){this.elementRef=f,this.documentTitle=g,this.translations=D,this.pageHeading=new P.xQ,this.titleOverride=new P.xQ,this.pageTitle=new P.xQ,this.mutationObserver=new MutationObserver(()=>this.updatePageHeading()),this.mutationObserver.observe(this.elementRef.nativeElement,{characterData:!0,subtree:!0}),(0,N.aj)([this.pageHeading,this.titleOverride]).pipe((0,C.U)(([U,v])=>v??U)).subscribe(this.pageTitle),(0,N.aj)([(0,T.D)({branding:k.get("branding"),siteTitle:k.get("siteTitle","edu-sharing")}),this.pageTitle,this.translations.waitForInit()]).subscribe(([U,v])=>this.updateTitle(U,v))}ngOnChanges(f){if(f.esTitle){const g=f.esTitle.currentValue;this.titleOverride.next(""===g?null:g??"")}}ngOnInit(){this.updatePageHeading()}ngOnDestroy(){this.mutationObserver.disconnect()}updatePageHeading(){this.pageHeading.next(this.elementRef.nativeElement.textContent)}updateTitle(f,g){this.documentTitle.setTitle(g?f.branding?g+" - "+f.siteTitle:g:f.siteTitle)}static#e=this.\u0275fac=function(g){return new(g||I)(r.Y36(r.SBq),r.Y36(l.Dx),r.Y36(m.fA),r.Y36(Z.eB))};static#t=this.\u0275dir=r.lG2({type:I,selectors:[["","esTitle",""]],inputs:{esTitle:"esTitle"},features:[r.TTD]})}return I})()}}]);