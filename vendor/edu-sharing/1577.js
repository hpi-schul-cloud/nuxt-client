"use strict";(self.webpackChunkapp_as_web_component=self.webpackChunkapp_as_web_component||[]).push([[1577],{71577:(W,g,n)=>{n.r(g),n.d(g,{NodeEmbedDialogComponent:()=>Y,NodeEmbedDialogModule:()=>B});var x=n(50555),f=n(15861),s=n(56223),v=n(72079),E=n(53075),b=n(51418),l=n(81771),h=n(1189),O=n(90721),u=n(53461),t=n(65879),T=n(91486),I=n(36692),p=n(96814),N=n(5178),Z=n(22941),y=n(52081),M=n(17162),A=n(32296),m=n(64170),D=n(24516),R=n(56263),C=n(87466),w=n(71365),P=n(6593);let z=(()=>{class i{constructor(o){this.sanitizer=o}transform(o){return this.sanitizer.bypassSecurityTrustHtml(o)}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(P.H7,16))};static#e=this.\u0275pipe=t.Yjl({name:"safeHtml",type:i,pure:!0})}return i})();const L=["textarea"];function S(i,F){if(1&i){const o=t.EpF();t.TgZ(0,"es-info-message",15)(1,"p",16),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.TgZ(4,"div")(5,"button",17),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.openInviteDialog())}),t._UZ(6,"i",18),t._uU(7),t.ALo(8,"translate"),t.qZA()()()}2&i&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"EMBED.NOT_PUBLIC_WARNING")),t.xp6(5),t.hij(" ",t.lcZ(8,4,"OPTIONS.INVITE")," "))}function U(i,F){1&i&&(t.TgZ(0,"mat-radio-group",19),t.ALo(1,"translate"),t.TgZ(2,"mat-radio-button",20),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"mat-radio-button",21),t._uU(6),t.ALo(7,"translate"),t.qZA()()),2&i&&(t.uIk("aria-label",t.lcZ(1,3,"EMBED.VERSION")),t.xp6(3),t.Oqu(t.lcZ(4,5,"EMBED.VERSION_OPTION.FIXED")),t.xp6(3),t.Oqu(t.lcZ(7,7,"EMBED.VERSION_OPTION.NEWEST")))}let Y=(()=>{class i{constructor(o,a,e,r,d,c,H,J,Q){this.data=o,this.dialogRef=a,this.dialogs=e,this.changeDetectorRef=r,this.location=d,this.mainNav=c,this.ngZone=H,this.router=J,this.toast=Q,this.buttons=[new l.Qd("OPTIONS.COPY",{color:"primary"},()=>this.copy())],this.sizeConstraints={width:{min:300,max:1200},height:{min:200,max:1200}},this.form=new s.nJ({width:new s.p4(400,[s.kI.min(this.sizeConstraints.width.min),s.kI.max(this.sizeConstraints.width.max)]),height:new s.p4(300,[s.kI.min(this.sizeConstraints.height.min),s.kI.max(this.sizeConstraints.height.max)]),version:new s.p4("fixed")}),this.embedCode="",this.showNotPublicWarning=!1,this.destroyed$=new v.xQ}ngOnInit(){this.dialogRef.patchConfig({buttons:this.buttons}),this.registerFormChanges(),this.registerNotPublicWarning()}ngOnDestroy(){this.destroyed$.next(),this.destroyed$.complete()}openInviteDialog(){var o=this;return(0,f.Z)(function*(){(yield o.dialogs.openShareDialog({nodes:[o.data.node]})).afterClosed().subscribe(()=>{})})()}registerFormChanges(){this.form.valueChanges.pipe((0,E.O)(this.form.value)).subscribe(o=>{this.form.valid&&(this.embedCode=this.getEmbedCode(o),this.ngZone.runOutsideAngular(()=>setTimeout(()=>this.changeDetectorRef.detectChanges()))),this.buttons[0].disabled=!this.form.valid}),this.form.valueChanges.pipe((0,b.q)(1)).subscribe(()=>{this.dialogRef.patchConfig({closable:u.IA.Standard})})}registerNotPublicWarning(){}copy(){var o=this;return(0,f.Z)(function*(){O.d.copyElementToClipboard(o.textareaRef.nativeElement),o.toast.show({message:"EMBED.COPIED_TO_CLIPBOARD_NOTICE",type:"info",subtype:h.p.InfoSimple})})()}getEmbedCode(o){const a=this.data.node,e=document.createElement("iframe");return e.src=this.getEmbedLink(a,o.version),e.title=l.bv.getTitle(a),e.width=o.width,e.height=o.height,e.frameBorder="0",e.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",e.outerHTML}getEmbedLink(o,a){const r={node_id:o.ref.id,version:"fixed"!==a||this.isCollectionReference()?null:o.content.version},d=this.router.createUrlTree(["eduservlet/render"],{queryParams:r});return location.origin+this.location.prepareExternalUrl(d.toString())}isCollectionReference(){return this.data.node.aspects.includes(l.u6.CCM_ASPECT_IO_REFERENCE)}static#t=this.\u0275fac=function(a){return new(a||i)(t.Y36(u.W9),t.Y36(T.Y),t.Y36(I.H),t.Y36(t.sBO),t.Y36(p.Ye),t.Y36(N.ZF),t.Y36(t.R0b),t.Y36(Z.F0),t.Y36(h.F))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["es-node-embed-dialog"]],viewQuery:function(a,e){if(1&a&&t.Gf(L,5),2&a){let r;t.iGM(r=t.CRH())&&(e.textareaRef=r.first)}},decls:31,vars:30,consts:[[1,"content-container"],[1,"preview-container"],[1,"preview",3,"innerHTML"],[1,"preferences-container"],["mode","warning",4,"ngIf"],[1,"not-public-warning-container"],["appearance","fill",1,"embed-code-field"],["matInput","","cdkTextareaAutosize","","cdkAutosizeMinRows","2","cdkAutosizeMaxRows","10",3,"readonly","disabled","focus"],["textarea",""],[1,"preferences-form",3,"formGroup"],["class","version-radio-group","formControlName","version",4,"ngIf"],[1,"size-fields-container"],[1,"size-field"],["matInput","","type","number","formControlName","width",3,"min","max"],["matInput","","type","number","formControlName","height",3,"min","max"],["mode","warning"],[1,"not-public-warning-message"],["mat-button","",3,"click"],["esIcon","arrow_forward"],["formControlName","version",1,"version-radio-group"],["value","fixed"],["value","newest"]],template:function(a,e){if(1&a){const r=t.EpF();t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"div",2),t.ALo(3,"safeHtml"),t.qZA(),t.TgZ(4,"div",3),t.YNc(5,S,9,6,"es-info-message",4),t._UZ(6,"div",5),t.TgZ(7,"mat-form-field",6)(8,"textarea",7,8),t.NdJ("focus",function(){t.CHM(r);const c=t.MAs(9);return t.KtG(c.select())}),t.ALo(10,"translate"),t._uU(11),t.qZA()(),t.TgZ(12,"form",9),t.YNc(13,U,8,9,"mat-radio-group",10),t.TgZ(14,"div",11)(15,"mat-form-field",12)(16,"mat-label"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t._UZ(19,"input",13),t.TgZ(20,"mat-error"),t._uU(21),t.ALo(22,"translate"),t.qZA()(),t.TgZ(23,"mat-form-field",12)(24,"mat-label"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t._UZ(27,"input",14),t.TgZ(28,"mat-error"),t._uU(29),t.ALo(30,"translate"),t.qZA()()()()()()}2&a&&(t.xp6(2),t.Q6J("innerHTML",t.lcZ(3,16,e.embedCode),t.oJD),t.xp6(3),t.Q6J("ngIf",e.showNotPublicWarning),t.xp6(3),t.Q6J("readonly",!0)("disabled",!e.form.valid),t.uIk("aria-label",t.lcZ(10,18,"EMBED.CODE_LABEL")),t.xp6(3),t.Oqu(e.embedCode),t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("ngIf",!e.isCollectionReference()),t.xp6(4),t.Oqu(t.lcZ(18,20,"EMBED.WIDTH")),t.xp6(2),t.Q6J("min",e.sizeConstraints.width.min)("max",e.sizeConstraints.width.max),t.xp6(2),t.hij(" ",t.xi3(22,22,"EMBED.SIZE_CONSTRAINTS_ERROR_NOTICE",e.sizeConstraints.width)," "),t.xp6(4),t.Oqu(t.lcZ(26,25,"EMBED.HEIGHT")),t.xp6(2),t.Q6J("min",e.sizeConstraints.height.min)("max",e.sizeConstraints.height.max),t.xp6(2),t.hij(" ",t.xi3(30,27,"EMBED.SIZE_CONSTRAINTS_ERROR_NOTICE",e.sizeConstraints.height)," "))},dependencies:[p.O5,y.ar,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.qQ,s.Fd,M.u,A.lW,m.KE,m.hX,m.TO,D.Nt,R.IC,C.VQ,C.U0,s.sg,s.u,w.X$,z],styles:["@media (min-width: 700px){[_nghost-%COMP%]{width:1200px;max-width:100%;height:500px}[_nghost-%COMP%]   .content-container[_ngcontent-%COMP%]{display:flex;height:100%}}.preview-container[_ngcontent-%COMP%]{flex-grow:1;display:grid;overflow:auto;box-shadow:inset 0 1px 10px #0000007a;background-color:#f5f5f5;background-image:linear-gradient(45deg,rgba(0,0,0,.2) 25%,transparent 25%,transparent 75%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.2)),linear-gradient(45deg,rgba(0,0,0,.2) 25%,transparent 25%,transparent 75%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.2));background-size:50px 50px;background-position:0 0,25px 25px}.preview[_ngcontent-%COMP%]{margin:auto;line-height:0;background:white;box-shadow:0 1px 10px #0000007a}.preferences-container[_ngcontent-%COMP%]{flex-shrink:0;flex-basis:350px;display:flex;flex-direction:column;overflow:auto}.not-public-warning-message[_ngcontent-%COMP%]{margin-top:0}.preferences-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0 15px}.size-fields-container[_ngcontent-%COMP%]{display:flex;gap:10px}.size-field[_ngcontent-%COMP%]{flex-grow:1}.size-field[_ngcontent-%COMP%]     .mat-form-field-infix{width:unset}.version-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:1.4375em}.version-radio-group[_ngcontent-%COMP%] > mat-radio-button[_ngcontent-%COMP%]{height:2.75em}.embed-code-field[_ngcontent-%COMP%]{font-family:monospace}"],changeDetection:0})}return i})(),B=(()=>{class i{static#t=this.\u0275fac=function(a){return new(a||i)};static#e=this.\u0275mod=t.oAB({type:i});static#n=this.\u0275inj=t.cJS({imports:[x.m]})}return i})()}}]);