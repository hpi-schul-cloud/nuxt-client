"use strict";(self.webpackChunkapp_as_web_component=self.webpackChunkapp_as_web_component||[]).push([[5910],{75910:(I,d,o)=>{o.r(d),o.d(d,{NodeStoreDialogModule:()=>L,SearchNodeStoreComponent:()=>D});var p=o(50555),n=o(52081),u=o(45125),g=o(72079),S=o(19352),m=o(75222),c=o(46680),t=o(65879),E=o(1846),f=o(91486),O=o(48098),y=o(22941),T=o(1189),h=o(96814),v=o(71365);function N(a,R){1&a&&(t.TgZ(0,"div",3),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&a&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SEARCH.NODE_STORE.LIST_EMPTY"),"\n"))}let D=(()=>{class a{constructor(e,i,s,r,l,C){this.cardDialogUtils=e,this.dialogRef=i,this.nodeList=s,this.router=r,this.toast=l,this.ui=C,this.NodeEntriesDisplayType=n.P8,this.InteractionType=n.s_,this.columns=[],this.list=new n.AL,this.sortPolicySubject=new u.X({allowed:!0,active:c.u.LOM_PROP_TITLE,direction:"asc",columns:[new n.Sw("NODE",c.u.LOM_PROP_TITLE)]}),this.options={useDefaultOptions:!0,supportedOptions:["OPTIONS.DOWNLOAD"],addOptions:this.getAdditionalOptions()},this.selected=[],this.destroyed=new g.xQ,this.columns.push(new n.HC("NODE",c.u.LOM_PROP_TITLE))}ngOnInit(){this.dialogRef.patchState({isLoading:!0}),this.registerNodeList()}ngAfterViewInit(){this.nodeEntries.initOptionsGenerator({actionbar:this.actionBar,customOptions:this.options}),this.nodeEntries.getSelection().changed.pipe((0,S.R)(this.destroyed)).subscribe(e=>this.onSelection(e.source.selected))}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}setSelection(e){const i=this.nodeEntries.getSelection();i.clear(),i.select(e)}onClick(e){this.ui.isMobile()?this.openNode(e):this.setSelection(e)}openNode(e){this.router.navigate([n.ru.ROUTER_PREFIX+"render",e.ref.id],{state:{nodes:this.list.getData(),scope:"node-store"}})}onSelection(e){this.selected=e}changeSort(e){this.sortPolicySubject.next({...e,direction:e.direction||"asc"})}getAdditionalOptions(){const e=new n.BA("SEARCH.NODE_STORE.REMOVE_ITEM","delete",()=>{this.deleteSelection()});return e.group=n.EM.FileOperations,[e]}deleteSelection(){this.dialogRef.patchState({isLoading:!0}),this.nodeList.removeFromNodeList(c.u.NODE_STORE_LIST,this.selected.map(e=>e.ref.id)).subscribe(()=>{this.toast.toast("SEARCH.NODE_STORE.REMOVED_ITEMS",{count:this.selected.length}),this.nodeEntries.getSelection().clear()})}registerNodeList(){this.sortPolicySubject.pipe((0,m.w)(e=>this.nodeList.observeNodeList(c.u.NODE_STORE_LIST,{propertyFilter:[c.u.ALL],sortPolicies:[e]}))).subscribe({next:e=>{this.list.setData(e.nodes),this.cardDialogUtils.configForNodes(e.nodes).then(i=>this.dialogRef.patchConfig(i)),this.dialogRef.patchState({isLoading:!1})},error:()=>{this.dialogRef.patchState({isLoading:!1})}})}static#t=this.\u0275fac=function(i){return new(i||a)(t.Y36(E.Z),t.Y36(f.Y),t.Y36(O.Ft),t.Y36(y.F0),t.Y36(T.F),t.Y36(n.VL))};static#e=this.\u0275cmp=t.Xpm({type:a,selectors:[["es-search-node-store-dialog"]],viewQuery:function(i,s){if(1&i&&(t.Gf(n.cE,5),t.Gf(n.nv,5)),2&i){let r;t.iGM(r=t.CRH())&&(s.nodeEntries=r.first),t.iGM(r=t.CRH())&&(s.actionBar=r.first)}},decls:5,vars:10,consts:[[1,"actions"],["class","noElementsInfo noElements",4,"ngIf"],[3,"dataSource","columns","displayType","elementInteractionType","sort","clickItem","dblClickItem","sortChange"],[1,"noElementsInfo","noElements"]],template:function(i,s){1&i&&(t.TgZ(0,"div",0),t._UZ(1,"es-actionbar"),t.qZA(),t.YNc(2,N,3,3,"div",1),t.TgZ(3,"es-node-entries-wrapper",2),t.NdJ("clickItem",function(l){return s.onClick(l.element)})("dblClickItem",function(l){return s.openNode(l.element)})("sortChange",function(l){return s.changeSort(l)}),t.ALo(4,"async"),t.qZA()),2&i&&(t.xp6(2),t.Q6J("ngIf",s.list.isEmpty()),t.xp6(1),t.ekj("display-none",s.list.isEmpty()),t.Q6J("dataSource",s.list)("columns",s.columns)("displayType",s.NodeEntriesDisplayType.Table)("elementInteractionType",s.InteractionType.Emitter)("sort",t.lcZ(4,8,s.sortPolicySubject)))},dependencies:[h.O5,n.nv,n.cE,h.Ov,v.X$],styles:[".actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;width:100%;height:50px;margin-top:10px}"]})}return a})(),L=(()=>{class a{static#t=this.\u0275fac=function(i){return new(i||a)};static#e=this.\u0275mod=t.oAB({type:a});static#o=this.\u0275inj=t.cJS({imports:[p.m,n.yF]})}return a})()}}]);