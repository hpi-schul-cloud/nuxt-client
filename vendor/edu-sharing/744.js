"use strict";(self.webpackChunkapp_as_web_component=self.webpackChunkapp_as_web_component||[]).push([[744],{70744:(W,S,a)=>{a.r(S),a.d(S,{SavedSearchesDialogComponent:()=>j,SavedSearchesDialogModule:()=>Q});var f=a(50555),h=a(15861),c=a(56223),p=a(45125),E=a(72079),A=a(19352),y=a(88419),x=a(96124),g=a(53075),T=a(96776),R=a(97734),D=a(75222),m=a(81771),H=a(53461),r=a(52081),u=a(26523),e=a(65879),Z=a(91486),b=a(36692),M=a(48098),O=a(76754),N=a(32296),v=a(64170),U=a(24516),d=a(74104),I=a(71365);const _=["saveCurrentSearch"];function V(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"button",3),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openSaveSearchDialog())}),e._UZ(1,"i",4),e._uU(2),e.ALo(3,"translate"),e.qZA()}2&s&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"SEARCH.SAVED_SEARCHES.SAVED_CURRENT_SEARCH")," "))}function P(s,l){1&s&&(e.TgZ(0,"p",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SEARCH.SAVED_SEARCHES.NO_SAVED_SEARCH")))}const C=function(s){return{actionbar:s}};function Y(s,l){if(1&s){const t=e.EpF();e._UZ(0,"es-actionbar",5,6),e.TgZ(2,"es-node-entries-wrapper",7),e.NdJ("clickItem",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.onClick(o.element))}),e.YNc(3,P,3,3,"ng-template",null,8,e.W1O),e.qZA()}if(2&s){const t=e.MAs(1),n=e.oxw();e.xp6(2),e.Q6J("dataSource",n.mySavedSearchesSource)("columns",n.columns)("displayType",n.displayType)("scope",n.scope)("initConfig",e.VKq(7,C,t))("elementInteractionType",n.interactionType)("singleClickHint",n.data.reUrl?"static":"dynamic")}}function B(s,l){if(1&s&&(e.TgZ(0,"p",9),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&s){const t=e.oxw(2);e.xp6(1),e.hij(" ",e.lcZ(2,1,t.searchInputControl.value?"SEARCH.SAVED_SEARCHES.NO_SAVED_SEARCH_FOUND":"SEARCH.SAVED_SEARCHES.NO_SAVED_SEARCH")," ")}}function J(s,l){if(1&s){const t=e.EpF();e.TgZ(0,"form",10)(1,"mat-form-field",11)(2,"mat-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"input",12),e.qZA()(),e._UZ(6,"es-actionbar",5,6),e.TgZ(8,"es-node-entries-wrapper",7),e.NdJ("clickItem",function(o){e.CHM(t);const i=e.oxw();return e.KtG(i.onClick(o.element))}),e.YNc(9,B,3,3,"ng-template",null,8,e.W1O),e.qZA()}if(2&s){const t=e.MAs(7),n=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,9,"SEARCH.SAVED_SEARCHES.SEARCH_INPUT")),e.xp6(2),e.Q6J("formControl",n.searchInputControl),e.xp6(3),e.Q6J("dataSource",n.sharedSavedSearchesSource)("columns",n.columns)("displayType",n.displayType)("scope",n.scope)("initConfig",e.VKq(11,C,t))("elementInteractionType",n.interactionType)("singleClickHint",n.data.reUrl?"static":"dynamic")}}let j=(()=>{class s{get nodeEntries(){return this._nodeEntries.value}set nodeEntries(t){this._nodeEntries.next(t)}constructor(t,n,o,i,G,L){this.data=t,this.dialogRef=n,this.dialogs=o,this.savedSearchesService=i,this.nodeHelper=G,this.injector=L,this._nodeEntries=new p.X(null),this.mySavedSearchesSource=new u.hB(this.injector),this.sharedSavedSearchesSource=new u.hB(this.injector),this.columns=[new r.HC("NODE","title")],this.displayType=r.P8.Table,this.scope=r.sX.SavedSearches,this.interactionType=r.s_.Emitter,this.searchInputControl=new c.p4(""),this.destroyed=new E.xQ,this.registerMySavedSearchesSource(),this.registerSharedSavedSearchesSource()}ngOnInit(){this.dialogRef.patchConfig({customHeaderBarContent:this.saveCurrentSearchRef,buttons:this.getButtons()})}ngOnDestroy(){this.destroyed.next(),this.destroyed.complete()}registerMySavedSearchesSource(){const t=new p.X(null);this.savedSearchesService.observeMySavedSearches().pipe((0,A.R)(this.destroyed)).subscribe(t),t.subscribe(()=>this.mySavedSearchesSource.setRemote(({range:n})=>t.pipe((0,y.P)(r.Nf),(0,x.U)(o=>({data:o.slice(n.startIndex,n.endIndex).map(({node:i})=>i),total:o.length})))))}registerSharedSavedSearchesSource(){this.searchInputControl.valueChanges.pipe((0,g.O)(null),(0,T.b)(300)).subscribe(t=>{this.sharedSavedSearchesSource.setRemote(n=>this.savedSearchesService.getSharedSavedSearchesNodes({searchString:t,...n.range}))})}getButtons(){const t=[];return this.data.reUrl&&t.push(new m.Qd("SEARCH.SAVED_SEARCHES.EMBED_BUTTON",{color:"standard"},()=>this.embedSelectedSearch())),t.push(new m.Qd("SEARCH.SAVED_SEARCHES.SEARCH_BUTTON",{color:"primary"},()=>this.closeDialogWithResult())),this._nodeEntries.pipe((0,R.h)(r.Nf),(0,D.w)(n=>n.getSelection().changed),(0,g.O)(void 0)).subscribe(()=>{const n=1===this.nodeEntries?.getSelection().selected.length;t.forEach(o=>o.disabled=!n)}),t}onClick(t){this.data.reUrl?(this.nodeEntries.getSelection().clear(),this.nodeEntries.getSelection().select(t)):this.closeDialogWithResult(t)}closeDialogWithResult(t=this.nodeEntries.getSelection().selected[0]){const n=this.savedSearchesService.savedSearchNodeToSavedSearch(t);this.dialogRef.close(n)}openSaveSearchDialog(){var t=this;return(0,h.Z)(function*(){(yield t.dialogs.openSaveSearchDialog(t.data.saveSearchData)).afterClosed().subscribe(o=>{t.nodeEntries.getSelection().clear(),t.nodeEntries.getSelection().select(o.node)})})()}embedSelectedSearch(){var t=this;return(0,h.Z)(function*(){let n=t.nodeEntries.getSelection().selected[0];t.nodeHelper.addNodeToLms(n,t.data.reUrl)})()}static#e=this.\u0275fac=function(n){return new(n||s)(e.Y36(H.W9),e.Y36(Z.Y),e.Y36(b.H),e.Y36(M.M6),e.Y36(O.G),e.Y36(e.zs3))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["es-saved-searches-dialog"]],viewQuery:function(n,o){if(1&n&&(e.Gf(_,7),e.Gf(r.cE,5)),2&n){let i;e.iGM(i=e.CRH())&&(o.saveCurrentSearchRef=i.first),e.iGM(i=e.CRH())&&(o.nodeEntries=i.first)}},decls:9,vars:6,consts:[["saveCurrentSearch",""],[3,"label"],["matTabContent",""],["mat-raised-button","",3,"click"],["esIcon","star_outline"],[1,"actionbar"],["actionbar",""],[3,"dataSource","columns","displayType","scope","initConfig","elementInteractionType","singleClickHint","clickItem"],["empty",""],[1,"no-results-notice"],[1,"search-input-form"],[1,"search-input-field"],["matInput","",3,"formControl"]],template:function(n,o){1&n&&(e.YNc(0,V,4,3,"ng-template",null,0,e.W1O),e.TgZ(2,"mat-tab-group")(3,"mat-tab",1),e.ALo(4,"translate"),e.YNc(5,Y,5,9,"ng-template",2),e.qZA(),e.TgZ(6,"mat-tab",1),e.ALo(7,"translate"),e.YNc(8,J,11,13,"ng-template",2),e.qZA()()),2&n&&(e.xp6(3),e.Q6J("label",e.lcZ(4,2,"SEARCH.SAVED_SEARCHES.TAB_MY")),e.xp6(3),e.Q6J("label",e.lcZ(7,4,"SEARCH.SAVED_SEARCHES.TAB_SHARED")))},dependencies:[r.nv,r.ar,r.cE,c._Y,c.Fj,c.JJ,c.JL,c.F,N.lW,v.KE,v.hX,U.Nt,d.Vc,d.uX,d.SP,c.oH,I.X$],styles:["[_nghost-%COMP%]     .mat-mdc-tab-body-content{display:flex;flex-direction:column}.mat-tab-group[_ngcontent-%COMP%]{height:100%}.mat-tab-group[_ngcontent-%COMP%]     .mat-tab-body-wrapper{flex-grow:1}.search-input-form[_ngcontent-%COMP%]{display:flex;padding:25px 25px 0}.search-input-form[_ngcontent-%COMP%]   .search-input-field[_ngcontent-%COMP%]{flex-grow:1}.search-input-form[_ngcontent-%COMP%]   .search-input-field[_ngcontent-%COMP%]     .mat-form-field-wrapper{padding:0}.actionbar[_ngcontent-%COMP%]{padding:25px 25px 0;align-self:flex-end}.no-results-notice[_ngcontent-%COMP%]{padding:25px;color:var(--textLight)}"]})}return s})(),Q=(()=>{class s{static#e=this.\u0275fac=function(n){return new(n||s)};static#t=this.\u0275mod=e.oAB({type:s});static#n=this.\u0275inj=e.cJS({imports:[f.m,r.fn]})}return s})()}}]);