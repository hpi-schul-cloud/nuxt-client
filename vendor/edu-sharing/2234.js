"use strict";(self.webpackChunkapp_as_web_component=self.webpackChunkapp_as_web_component||[]).push([[2234],{32234:(H,R,l)=>{l.r(R),l.d(R,{SimpleEditDialogComponent:()=>Ze,SimpleEditDialogModule:()=>Ge});var r=l(50555),P=l(2962),m=l(15861),h=l(77504),v=l(49193),S=l(75222),M=l(96124),y=l(62413),a=l(81771),U=l(53461),C=l(4254),e=l(65879),f=l(91486),T=l(36692),g=l(52081),E=l(1189),G=l(32296),O=l(86825),b=l(54699),Q=l(64634),D=l(90721),V=l(48098),L=l(96814),F=l(17162),N=l(49488),W=l(22941),x=l(71365),z=l(6593),B=l(23680),k=l(98588),Y=l(99994);let K=(()=>{class o{constructor(t,i,n){this.router=t,this.translate=i,this.sanitizer=n,this.active=!1}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(W.F0),e.Y36(x.sK),e.Y36(z.H7))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["es-user-tile"]],inputs:{user:"user",active:"active"},decls:5,vars:6,consts:[["matRipple","",1,"tile"],["size","xsmall",3,"user"],[1,"name"]],template:function(i,n){1&i&&(e.TgZ(0,"div",0),e._UZ(1,"es-user-avatar",1),e.TgZ(2,"div",2),e._uU(3),e.ALo(4,"authorityName"),e.qZA()()),2&i&&(e.ekj("active",n.active),e.xp6(1),e.Q6J("user",n.user),e.xp6(2),e.Oqu(e.lcZ(4,4,n.user)))},dependencies:[B.wG,k.k,Y.F],styles:[".tile[_ngcontent-%COMP%]{width:167px;height:45px;margin:5px;padding:10px 15px;border:1px solid #eee;border-radius:2px;background-color:#fff;display:flex;flex-direction:row;align-items:center;cursor:pointer;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.tile[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], .tile[_ngcontent-%COMP%]   es-user-avatar[_ngcontent-%COMP%]{display:flex;align-items:center}.tile[_ngcontent-%COMP%]   es-user-avatar[_ngcontent-%COMP%]{margin-bottom:-4px}.tile[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-size:90%;text-align:left;padding-left:15px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;line-height:1.25em;max-height:2.5em;-webkit-line-clamp:2;-webkit-box-orient:vertical}.tile.active[_ngcontent-%COMP%]{color:var(--light-primary-text);background-color:var(--primary)}.tile.active[_ngcontent-%COMP%]:hover{background-color:rgb(var(--palette-primary-50))}.tile[_ngcontent-%COMP%]:hover{background-color:rgba(var(--palette-primary-500-no-rgb),.08)}"]})}return o})();const X=["orgGroup"],$=["globalGroup"];function j(o,p){1&o&&e._UZ(0,"es-info-message",5)}function q(o,p){1&o&&e._UZ(0,"es-info-message",6)}function ee(o,p){1&o&&(e.TgZ(0,"es-info-message",7)(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&o&&(e.xp6(2),e.Oqu(e.lcZ(3,1,"SIMPLE_EDIT.INVITE.ERROR_HELP")))}function te(o,p){if(1&o&&(e.TgZ(0,"span",11),e._uU(1),e.ALo(2,"authorityName"),e.qZA()),2&o){const t=p.$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function ie(o,p){if(1&o&&(e.TgZ(0,"es-info-message",8)(1,"div",9),e.YNc(2,te,3,3,"span",10),e.qZA(),e.TgZ(3,"div"),e._uU(4),e.ALo(5,"translate"),e.qZA()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.parentAuthorities),e.xp6(2),e.Oqu(e.lcZ(5,2,"SIMPLE_EDIT.INVITE.ERROR_HELP"))}}const ne=function(o){return{school:o}};function oe(o,p){if(1&o&&(e.TgZ(0,"mat-button-toggle",24),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"authorityName"),e.qZA()),2&o){const t=p.$implicit,i=e.oxw().$implicit;e.Q6J("value",null==i.groups[t]?null:i.groups[t].authorityName)("disabled",!i.groups[t]),e.xp6(1),e.Oqu(e.xi3(2,3,"SIMPLE_EDIT.INVITE.GROUP_TYPES."+t,e.VKq(8,ne,e.lcZ(3,6,i.organization))))}}function se(o,p){if(1&o&&(e.ynx(0),e.YNc(1,oe,4,10,"mat-button-toggle",23),e.TgZ(2,"mat-button-toggle",19),e._uU(3),e.ALo(4,"authorityName"),e.qZA(),e.BQk()),2&o){const t=p.$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",i.organizationGroups),e.xp6(1),e.Q6J("value",t.organization.authorityName),e.xp6(1),e.Oqu(e.lcZ(4,3,t.organization))}}function re(o,p){1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"translate"),e.BQk()),2&o&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SIMPLE_EDIT.INVITE.PUBLISH")))}function ae(o,p){if(1&o&&(e.ynx(0),e._uU(1),e.ALo(2,"authorityName"),e.BQk()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(e.lcZ(2,1,t))}}function le(o,p){if(1&o&&(e.TgZ(0,"mat-button-toggle",28),e.ALo(1,"async"),e.YNc(2,re,3,3,"ng-container",21),e.YNc(3,ae,3,3,"ng-container",21),e.qZA()),2&o){const t=p.$implicit,i=e.oxw(3);let n;e.Q6J("disabled","GROUP_EVERYONE"===t.authorityName&&!i.tpInviteEveryone||null!==(null==(n=e.lcZ(1,4,i.authenticationService.observeLoginInfo()))?null:n.currentScope))("value",t.authorityName),e.xp6(2),e.Q6J("ngIf","GROUP_EVERYONE"===t.authorityName),e.xp6(1),e.Q6J("ngIf","GROUP_EVERYONE"!==t.authorityName)}}function ce(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"mat-button-toggle-group",25,26),e.NdJ("change",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.updateValue("global"))}),e.YNc(3,le,4,6,"mat-button-toggle",27),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngForOf",t.globalGroups)}}function ue(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"es-user-tile",32),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.toggleInvitation(s))}),e.qZA()}if(2&o){const t=p.$implicit,i=e.oxw(3);e.Q6J("user",t)("active",i.isInvited(t))}}function de(o,p){if(1&o&&(e.TgZ(0,"div",14)(1,"label",29),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",30),e.YNc(5,ue,1,2,"es-user-tile",31),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Oqu(e.lcZ(3,2,"SIMPLE_EDIT.INVITE.RECENT_AUTHORITIES")),e.xp6(3),e.Q6J("ngForOf",t.recentAuthorities)}}function pe(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",14)(5,"label",15),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",16)(9,"div")(10,"mat-button-toggle-group",17,18),e.NdJ("change",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.updateValue("org"))}),e.TgZ(12,"mat-button-toggle",19),e._uU(13),e.ALo(14,"translate"),e.qZA(),e.YNc(15,se,5,5,"ng-container",20),e.qZA()(),e.YNc(16,ce,4,1,"div",21),e.qZA()(),e.YNc(17,de,6,4,"div",22),e.qZA()}if(2&o){const t=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,7,"SIMPLE_EDIT.INVITE.INFO")),e.xp6(4),e.hij(" ",e.lcZ(7,9,"SIMPLE_EDIT.INVITE.DEFAULT_GROUPS")," "),e.xp6(6),e.Q6J("value","unset"),e.xp6(1),e.hij(" ",e.lcZ(14,11,"SIMPLE_EDIT.INVITE.UNSET")," "),e.xp6(2),e.Q6J("ngForOf",t.organizations),e.xp6(1),e.Q6J("ngIf",t.globalGroups.length>0),e.xp6(1),e.Q6J("ngIf",t.recentAuthorities&&t.recentAuthorities.length)}}let ge=(()=>{class o{set nodes(t){this._nodes=t,t&&this.prepare()}constructor(t,i,n,s,c,d,u,_){this.nodeApi=t,this.connector=i,this.applicationRef=n,this.configService=s,this.iamApi=c,this.organizationApi=d,this.authenticationService=u,this.toast=_,this.dirty=!1,this.parentAuthorities=[],this.stablePermissionState=!1,this.globalGroups=[],this.onInitFinished=new e.vpe,this.onError=new e.vpe,this.configService.get("simpleEdit.organization.groupTypes",[a.u6.GROUP_TYPE_ADMINISTRATORS]).subscribe(I=>this.organizationGroups=I.filter(A=>!!A)),this.configService.get("simpleEdit.globalGroups",[{groups:[a.u6.AUTHORITY_EVERYONE]}]).subscribe(I=>{this.loadGlobalGroups(I)}),this.connector.hasToolPermission(a.u6.TOOLPERMISSION_INVITE).subscribe(I=>this.tpInvite=I),this.connector.hasToolPermission(a.u6.TOOLPERMISSION_INVITE_ALLAUTHORITIES).subscribe(I=>this.tpInviteEveryone=I)}isDirty(){return!this.hasInvalidState()&&(!!this.dirty||null!=this.getSelectedAuthority()&&!Q.W.objectEquals(this.initialState,this.getSelectedAuthority()))}save(){return new b.y(t=>{if(!this.isDirty())return t.next(),void t.complete();const i=this.getSelectedAuthority();let n=null;const s=i===a.u6.AUTHORITY_EVERYONE;null!=i&&(n=new a.y3,n.authority={authorityName:i,authorityType:i.startsWith(a.u6.GROUP_PREFIX)?a.u6.AUTHORITY_TYPE_GROUP:a.u6.AUTHORITY_TYPE_USER},n.permissions=s?[a.u6.PERMISSION_CONSUMER,a.u6.ACCESS_CC_PUBLISH]:[a.u6.PERMISSION_CONSUMER]),(0,h.D)(this._nodes.map((c,d)=>{let u=this.nodesPermissions[d].localPermissions;return this.currentPermissions&&this.currentPermissions.length&&(u.permissions=[]),n&&(u.permissions=this.stablePermissionState?[n]:D.d.mergePermissionsWithHighestPermission(u.permissions,[n])),this.currentPermissions&&this.currentPermissions.length&&(this.currentPermissions=this.currentPermissions.filter(_=>-1===this.getAvailableGlobalGroups().indexOf(_.authority.authorityName)),u.permissions=D.d.mergePermissionsWithHighestPermission(u.permissions,this.currentPermissions)),u=a.bv.copyAndCleanPermissions(u.permissions,this.nodesPermissions[d].localPermissions.inherited),this.nodeApi.setNodePermissions(c.ref.id,u,!1)})).subscribe(()=>{t.next(null),t.complete()},c=>{t.error(c),t.complete()})})}getSelectedAuthority(){if(this.hasInvalidState())return null;let t=null;return this.orgGroup.value?"unset"===this.orgGroup.value||(t=this.orgGroup.value):this.globalGroup.value?t=this.globalGroup.value:console.warn("invalid value for button toggle in simple invite dialog"),t}prepare(){const t=Array.from(new Set(this._nodes.map(i=>i.parent.id)));if(this.multipleParents=t.length>1,!this.multipleParents)return this._nodes.find(i=>-1===i.access.indexOf(a.u6.ACCESS_CHANGE_PERMISSIONS))?(this.missingNodePermissions=!0,void this.setInitialState()):(this.nodeApi.getNodePermissions(t[0]).subscribe(i=>{this.parentPermissions=i.permissions.localPermissions.permissions.concat(i.permissions.inheritedPermissions);const n=Array.from(new Set(this.parentPermissions.map(s=>s.authority.authorityName).filter(s=>s!==this.connector.getCurrentLogin().authorityName&&s!==a.u6.AUTHORITY_ROLE_OWNER)));this.parentAuthorities=n.map(s=>this.parentPermissions.find(c=>c.authority.authorityName===s))},i=>{i.status===a.u6.HTTP_FORBIDDEN?this.missingNodePermissions=!0:this.onError.emit(i)}),void(0,h.D)(this._nodes.map(i=>this.nodeApi.getNodePermissions(i.ref.id))).subscribe(i=>{this.nodesPermissions=i.map(n=>n.permissions),this.inherited=i.some(n=>n.permissions.localPermissions.inherited),this.organizationApi.getOrganizations("",!0).subscribe(n=>{const s=this.configService.instant("simpleEdit.organizationFilter");if(s){const c=new RegExp(s);n.organizations=n.organizations.filter(d=>null!=c.exec(d.authorityName))}n.organizations.length>=1?(this.organizations=n.organizations.map(c=>({organization:c,groups:{}})),(0,h.D)(this.organizations.map(c=>new b.y(d=>{this.organizationGroups?.length?(0,h.D)(this.organizationGroups.map(u=>this.iamApi.getSubgroupByType(c.organization.authorityName,u))).subscribe(u=>{u.forEach(_=>{c.groups[_.group.profile.groupType]=_.group}),d.next(c),d.complete()},u=>{console.warn("Some group roles could not be found",u),d.next(c),d.complete()}):(d.next(c),d.complete())}))).subscribe(c=>{this.organizations=c,this.detectPermissionState()})):this.detectPermissionState()})},i=>{this.onError.emit(i)}));this.setInitialState()}loadGlobalGroups(t){const i=t.filter(s=>!s.toolpermission||this.connector.hasToolPermissionInstant(s.toolpermission));let n;0===i.length?(console.warn("Invalid config for simple edit / global groups. No matching entry was found"),n=[]):n=i[0].groups||[],this.globalGroups=[],n.find(s=>s===a.u6.AUTHORITY_EVERYONE)&&(n=n.filter(s=>s!==a.u6.AUTHORITY_EVERYONE),this.globalGroups.push({authorityName:a.u6.AUTHORITY_EVERYONE,authorityType:a.u6.AUTHORITY_TYPE_EVERYONE})),(0,h.D)(n.map(s=>this.iamApi.getGroup(s))).subscribe(s=>this.globalGroups=s.map(c=>c.group).concat(this.globalGroups))}updateValue(t){"org"===t?this.globalGroup.value=null:this.orgGroup.value=null}detectPermissionState(){var t=this;return(0,m.Z)(function*(){if(yield t.applicationRef.tick(),t.hasInvalidState())return void t.setInitialState();const i=t.getAvailableGlobalGroups();let c,n=!1,s=!1;for(const d of t.nodesPermissions){const u=d.localPermissions.permissions;if(t.currentPermissions=1===t._nodes.length?u:[],u.length>0){const I=u.filter(A=>-1!==A.permissions.indexOf(a.u6.PERMISSION_CONSUMER)).filter(A=>-1!==i.indexOf(A.authority.authorityName));1!==I.length||c&&c!==I[0].authority.authorityName?s=!0:c=I[0].authority.authorityName}else n=!0}if(t.stablePermissionState=!s,n||s)t.orgGroup.value="unset";else{if(t.organizations?.length&&c){const d=t.organizations.find(u=>u.organization.authorityName===c);if(d)return t.orgGroup.value=d.organization.authorityName,void t.setInitialState()}if(t.organizations?.length)for(const d of t.organizations)for(const u of Object.keys(d.groups))if(c===d.groups[u].authorityName)return t.orgGroup.value=c,void t.setInitialState();if(t.globalGroups)for(const d of t.globalGroups)if(c===d.authorityName)return t.globalGroup.value=c,void t.setInitialState();t.orgGroup.value="unset"}t.setInitialState()})()}getAvailableGlobalGroups(){let t=[];if(this.organizations?.length){t=t.concat(this.organizations.map(i=>i.organization.authorityName));for(const i of this.organizations)for(const n of Object.keys(i.groups))t.push(i.groups[n].authorityName)}if(this.globalGroups)for(const i of this.globalGroups)t.push(i.authorityName);return t}hasInvalidState(){return this.multipleParents||this.inherited&&this.parentAuthorities.length>0||!this.tpInvite||this.missingNodePermissions}setInitialState(){this.iamApi.getRecentlyInvited().subscribe(t=>{this.recentAuthorities=t.authorities.filter(i=>-1===this.getAvailableGlobalGroups().indexOf(i.authorityName)).slice(0,6),this.initialState=this.getSelectedAuthority(),this.onInitFinished.emit(!0)},t=>this.onError.emit(t))}isInvited(t){return!!this.currentPermissions&&!!this.currentPermissions.find(i=>i.authority.authorityName===t.authorityName)}toggleInvitation(t){if(this.dirty=!0,this.isInvited(t))this.currentPermissions=this.currentPermissions.filter(i=>i.authority.authorityName!==t.authorityName),console.log(this.currentPermissions);else{const i=new a.y3;i.authority={authorityName:t.authorityName,authorityType:t.authorityType},i.permissions=[a.u6.PERMISSION_CONSUMER],this.currentPermissions.push(i)}}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(a.xE),e.Y36(a.xD),e.Y36(e.z2F),e.Y36(a.eB),e.Y36(a.Du),e.Y36(a.K$),e.Y36(V.$h),e.Y36(E.F))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["es-simple-edit-invite"]],viewQuery:function(i,n){if(1&i&&(e.Gf(X,5),e.Gf($,5)),2&i){let s;e.iGM(s=e.CRH())&&(n.orgGroup=s.first),e.iGM(s=e.CRH())&&(n.globalGroup=s.first)}},inputs:{nodes:"nodes",fromUpload:"fromUpload"},outputs:{onInitFinished:"onInitFinished",onError:"onError"},decls:5,vars:5,consts:[["message","SIMPLE_EDIT.INVITE.ERROR_TOOLPERMISSION_MISSING",4,"ngIf"],["message","SIMPLE_EDIT.INVITE.ERROR_PERMISSION_MISSING",4,"ngIf"],["message","SIMPLE_EDIT.INVITE.ERROR_MULTIPLE_PARENTS",4,"ngIf"],["message","SIMPLE_EDIT.INVITE.ERROR_INHERIT",4,"ngIf"],["class","toggles",4,"ngIf"],["message","SIMPLE_EDIT.INVITE.ERROR_TOOLPERMISSION_MISSING"],["message","SIMPLE_EDIT.INVITE.ERROR_PERMISSION_MISSING"],["message","SIMPLE_EDIT.INVITE.ERROR_MULTIPLE_PARENTS"],["message","SIMPLE_EDIT.INVITE.ERROR_INHERIT"],[1,"parent-authorities"],["class","authorities",4,"ngFor","ngForOf"],[1,"authorities"],[1,"toggles"],[1,"info","field-group"],[1,"field-group"],["id","global-groups-label"],["role","group","aria-labelledby","global-groups-label"],[1,"toggle-full-size","toggle-org",3,"change"],["orgGroup","matButtonToggleGroup"],[1,"button-toggle-org",3,"value"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","field-group",4,"ngIf"],["class","button-toggle-org",3,"value","disabled",4,"ngFor","ngForOf"],[1,"button-toggle-org",3,"value","disabled"],[1,"toggle-full-size",3,"change"],["globalGroup","matButtonToggleGroup"],["class","button-toggle-global",3,"disabled","value",4,"ngFor","ngForOf"],[1,"button-toggle-global",3,"disabled","value"],["id","last-invitations-label"],["aria-labelledby","last-invitations-label",1,"tiles"],[3,"user","active","click",4,"ngFor","ngForOf"],[3,"user","active","click"]],template:function(i,n){1&i&&(e.YNc(0,j,1,0,"es-info-message",0),e.YNc(1,q,1,0,"es-info-message",1),e.YNc(2,ee,4,3,"es-info-message",2),e.YNc(3,ie,6,4,"es-info-message",3),e.YNc(4,pe,18,13,"div",4)),2&i&&(e.Q6J("ngIf",!n.tpInvite),e.xp6(1),e.Q6J("ngIf",n.missingNodePermissions&&n.tpInvite),e.xp6(1),e.Q6J("ngIf",n.multipleParents),e.xp6(1),e.Q6J("ngIf",n.inherited&&n.parentAuthorities.length>0),e.xp6(1),e.Q6J("ngIf",!n.hasInvalidState()))},dependencies:[L.sg,L.O5,F.u,N.A9,N.Yi,K,Y.F,L.Ov,x.X$],styles:['.authorities[_ngcontent-%COMP%]:not(:last-child):after{content:", "}.parent-authorities[_ngcontent-%COMP%]{font-style:italic;padding:5px 10px}mat-button-toggle-group[_ngcontent-%COMP%]{overflow:visible}.toggle-org[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.toggle-org[_ngcontent-%COMP%]   .button-toggle-org[_ngcontent-%COMP%]{width:50%;border-top:solid 1px rgba(0,0,0,.12)}.toggle-org[_ngcontent-%COMP%]   .button-toggle-org[_ngcontent-%COMP%]:nth-child(1){width:33%;border-top:none}.toggle-org[_ngcontent-%COMP%]   .button-toggle-org[_ngcontent-%COMP%]:nth-child(2){width:33%;border-top:none}.toggle-org[_ngcontent-%COMP%]   .button-toggle-org[_ngcontent-%COMP%]:nth-child(3){width:33%;border-top:none}.toggle-org[_ngcontent-%COMP%]     .mat-button-toggle-label-content{white-space:pre-line;line-height:1.5em;height:48px;display:flex;align-items:center;justify-content:center}.toggles[_ngcontent-%COMP%]{display:flex;flex-direction:column}.toggles[_ngcontent-%COMP%]   .tiles[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.toggles[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{font-size:90%}.toggles[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:20px}.toggles[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-bottom:7px;font-weight:700}@media screen and (max-width: 600px){.tiles[_ngcontent-%COMP%]{justify-content:center}}'],data:{animation:[(0,O.X$)("fade",g.Le.fade()),(0,O.X$)("cardAnimation",g.Le.cardAnimation())]}})}return o})();var w=l(5253),_e=l(76754),Z=l(56223),me=l(73815),J=l(64170),he=l(24516),fe=l(56263);const Ee=["modeGroup"],Ie=["licenseGroup"];function Ce(o,p){1&o&&e._UZ(0,"es-info-message",3)}function Te(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"es-info-message",4)(1,"button",5),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return n.invalid=!1,e.KtG(n.prepare())}),e._uU(2),e.ALo(3,"translate"),e.qZA()()}2&o&&(e.xp6(1),e.Q6J("color","white"),e.xp6(1),e.hij(" ",e.lcZ(3,2,"SIMPLE_EDIT.LICENSE.REPLACE")," "))}function ve(o,p){if(1&o&&(e.TgZ(0,"mat-button-toggle",11),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&o){const t=p.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(e.lcZ(2,2,"SIMPLE_EDIT.LICENSE.LICENSES."+t))}}function Se(o,p){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-form-field",18)(2,"mat-label"),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"textarea",19),e.NdJ("ngModelChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.authorFreetext=n)}),e.qZA()(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Oqu(e.lcZ(4,2,"MDS.AUTHOR_FREETEXT_PLACEHOLDER")),e.xp6(2),e.Q6J("ngModel",t.authorFreetext)}}function Oe(o,p){if(1&o){const t=e.EpF();e.TgZ(0,"es-license-source",20),e.NdJ("ccTitleOfWorkChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.ccTitleOfWork=n)})("ccSourceUrlChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.ccSourceUrl=n)})("ccProfileUrlChange",function(n){e.CHM(t);const s=e.oxw(2);return e.KtG(s.ccProfileUrl=n)}),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("ccTitleOfWork",t.ccTitleOfWork)("ccSourceUrl",t.ccSourceUrl)("ccProfileUrl",t.ccProfileUrl)}}function Pe(o,p){if(1&o&&(e.TgZ(0,"div",6)(1,"label",7),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div",8)(5,"mat-button-toggle-group",9,10)(7,"mat-button-toggle",11),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"mat-button-toggle",11),e._uU(11),e.ALo(12,"translate"),e.qZA()()(),e.TgZ(13,"label",12),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"div",8)(17,"mat-button-toggle-group",13,14),e.YNc(19,ve,3,4,"mat-button-toggle",15),e.qZA()(),e.YNc(20,Se,6,4,"ng-container",16),e.YNc(21,Oe,1,3,"es-license-source",17),e.qZA()),2&o){const t=e.MAs(6),i=e.oxw();e.xp6(2),e.Oqu(e.lcZ(3,9,"SIMPLE_EDIT.LICENSE.SOURCE_TYPE")),e.xp6(5),e.Q6J("value","own"),e.xp6(1),e.Oqu(e.lcZ(9,11,"SIMPLE_EDIT.LICENSE.SOURCE_OWN")),e.xp6(2),e.Q6J("value","foreign"),e.xp6(1),e.Oqu(e.lcZ(12,13,"SIMPLE_EDIT.LICENSE.SOURCE_FOREIGN")),e.xp6(3),e.Oqu(e.lcZ(15,15,"SIMPLE_EDIT.LICENSE.SET_LICENSE")),e.xp6(5),e.Q6J("ngForOf",i.allowedLicenses),e.xp6(1),e.Q6J("ngIf","foreign"===t.value),e.xp6(1),e.Q6J("ngIf",i.isCCAttributableLicense()&&"foreign"===t.value)}}let Me=(()=>{class o{set nodes(t){this._nodes=t,t&&this.prepare(!0)}constructor(t,i,n,s,c,d,u){this.nodeApi=t,this.connector=i,this.configService=n,this.iamApi=s,this.nodeHelper=c,this.organizationApi=d,this.toast=u,this.onInitFinished=new e.vpe,this.onError=new e.vpe,this.configService.get("simpleEdit.licenses",["NONE","COPYRIGHT_FREE","CC_BY","CC_0"]).subscribe(_=>this.allowedLicenses=_),this.connector.hasToolPermission(a.u6.TOOLPERMISSION_LICENSE).subscribe(_=>this.tpLicense=_)}getESUID(){var t=this;return(0,m.Z)(function*(){return(yield t.iamApi.getCurrentUserVCard()).uid})()}isDirty(){return!(this.invalid||!this.tpLicense||!this.wasInvalid&&this.initialLicense===this.licenseGroup.value&&this.initalAuthorFreetext===this.authorFreetext&&this.initialMode===this.modeGroup.value)}save(){return this.isDirty()?(0,h.D)(this._nodes.map(t=>(0,w.D)(this.getProperties()).pipe((0,S.w)(i=>this.nodeApi.editNodeMetadataNewVersion(t.ref.id,a.u6.COMMENT_LICENSE_UPDATE,i))))):new b.y(t=>{t.next(),t.complete()})}prepare(t=!1){var i=this;(0,h.D)(this._nodes.map(n=>this.nodeApi.getNodeMetadata(n.ref.id,[a.u6.ALL]))).subscribe(n=>{this._nodes=n.map(u=>u.node);const s=this.nodeHelper.getValueForAll(this._nodes,a.u6.CCM_PROP_LICENSE,null,"NONE",!1);this.authorFreetext=this.nodeHelper.getValueForAll(this._nodes,a.u6.CCM_PROP_AUTHOR_FREETEXT,"","",!1),this.ccTitleOfWork=this.nodeHelper.getValueForAll(this._nodes,a.u6.CCM_PROP_LICENSE_TITLE_OF_WORK,""),this.ccProfileUrl=this.nodeHelper.getValueForAll(this._nodes,a.u6.CCM_PROP_LICENSE_PROFILE_URL,""),this.ccSourceUrl=this.nodeHelper.getValueForAll(this._nodes,a.u6.CCM_PROP_LICENSE_SOURCE_URL,"");const c=new g._W(this.nodeHelper.getValueForAll(this._nodes,a.u6.CCM_PROP_LIFECYCLECONTRIBUTER_AUTHOR,"","",!1));let d=!0;s?(s.startsWith("CC_BY")&&(d="4.0"===this.nodeHelper.getValueForAll(this._nodes,a.u6.CCM_PROP_LICENSE_CC_VERSION,null,null,!1)),-1===this.allowedLicenses.indexOf(s)&&(d=!1)):d=!1,this.initialLicense=s,this.initalAuthorFreetext=this.authorFreetext,setTimeout((0,m.Z)(function*(){if(t&&(i.invalid=!i.fromUpload&&!d,i.wasInvalid=i.invalid),i.tpLicense&&i.modeGroup){if(i.fromUpload)i.modeGroup.value="own";else{const u=yield i.getESUID();i.modeGroup&&(i.modeGroup.value=u&&u===c.uid?"own":"foreign")}i.modeGroup&&(i.initialMode=i.modeGroup.value,i.licenseGroup.value=d?s:"NONE")}i.onInitFinished.emit()}))},n=>this.onError.emit(n))}getProperties(){var t=this;return(0,m.Z)(function*(){const i={};if("own"===t.modeGroup.value){const n=yield t.iamApi.getCurrentUserVCard();i[a.u6.CCM_PROP_LIFECYCLECONTRIBUTER_AUTHOR]=[n.toVCardString()],i[a.u6.CCM_PROP_AUTHOR_FREETEXT]=null}else i[a.u6.CCM_PROP_LIFECYCLECONTRIBUTER_AUTHOR]=null,i[a.u6.CCM_PROP_AUTHOR_FREETEXT]=[t.authorFreetext];return t.isCCAttributableLicense()&&(i[a.u6.CCM_PROP_LICENSE_TITLE_OF_WORK]=t.ccTitleOfWork?[t.ccTitleOfWork]:null,i[a.u6.CCM_PROP_LICENSE_SOURCE_URL]=t.ccSourceUrl?[t.ccSourceUrl]:null,i[a.u6.CCM_PROP_LICENSE_PROFILE_URL]=t.ccProfileUrl?[t.ccProfileUrl]:null),i[a.u6.CCM_PROP_LICENSE]=[t.licenseGroup.value],i[a.u6.CCM_PROP_LICENSE_CC_VERSION]="CC_BY"===t.licenseGroup.value?["4.0"]:null,i})()}isCCAttributableLicense(){return this.licenseGroup&&this.licenseGroup.value&&this.licenseGroup.value.startsWith("CC_BY")}ngOnInit(){var t=this;return(0,m.Z)(function*(){(yield t.getESUID())||console.warn("Current user has no esuid, detecting owner of license is impossible")})()}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(a.xE),e.Y36(a.xD),e.Y36(a.eB),e.Y36(a.Du),e.Y36(_e.G),e.Y36(a.K$),e.Y36(E.F))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["es-simple-edit-license"]],viewQuery:function(i,n){if(1&i&&(e.Gf(Ee,5),e.Gf(Ie,5)),2&i){let s;e.iGM(s=e.CRH())&&(n.modeGroup=s.first),e.iGM(s=e.CRH())&&(n.licenseGroup=s.first)}},inputs:{fromUpload:"fromUpload",nodes:"nodes"},outputs:{onInitFinished:"onInitFinished",onError:"onError"},decls:3,vars:3,consts:[["message","SIMPLE_EDIT.LICENSE.ERROR_TOOLPERMISSION_MISSING",4,"ngIf"],["message","SIMPLE_EDIT.LICENSE.INVALID_STATE",4,"ngIf"],["class","license",4,"ngIf"],["message","SIMPLE_EDIT.LICENSE.ERROR_TOOLPERMISSION_MISSING"],["message","SIMPLE_EDIT.LICENSE.INVALID_STATE"],["mat-raised-button","",3,"color","click"],[1,"license"],["id","material-source-label"],[1,"field-group"],["aria-labelledby","material-source-label"],["modeGroup","matButtonToggleGroup"],[3,"value"],["id","material-license-label"],["aria-labelledby","material-license-label"],["licenseGroup","matButtonToggleGroup"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["class","field-group",3,"ccTitleOfWork","ccSourceUrl","ccProfileUrl","ccTitleOfWorkChange","ccSourceUrlChange","ccProfileUrlChange",4,"ngIf"],[1,"authorFreetext"],["matInput","","cdkTextareaAutosize","","id","authorFreetext","cdkAutosizeMinRows","3","cdkAutosizeMaxRows","5",3,"ngModel","ngModelChange"],[1,"field-group",3,"ccTitleOfWork","ccSourceUrl","ccProfileUrl","ccTitleOfWorkChange","ccSourceUrlChange","ccProfileUrlChange"]],template:function(i,n){1&i&&(e.YNc(0,Ce,1,0,"es-info-message",0),e.YNc(1,Te,4,4,"es-info-message",1),e.YNc(2,Pe,22,17,"div",2)),2&i&&(e.Q6J("ngIf",!n.tpLicense),e.xp6(1),e.Q6J("ngIf",n.invalid),e.xp6(1),e.Q6J("ngIf",!n.invalid&&n.tpLicense))},dependencies:[L.sg,L.O5,Z.Fj,Z.JJ,Z.On,F.u,me.X,G.lW,N.A9,N.Yi,J.KE,J.hX,he.Nt,fe.IC,x.X$],styles:["es-info-message[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:10px auto 0}.license[_ngcontent-%COMP%]{display:flex;flex-direction:column}.license[_ngcontent-%COMP%]   .field-group[_ngcontent-%COMP%]{padding-bottom:20px}.license[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding-bottom:7px;font-weight:700}"],data:{animation:[(0,O.X$)("fade",g.Le.fade()),(0,O.X$)("cardAnimation",g.Le.cardAnimation())]}})}return o})();var Le=l(16090),Ae=l(87548);const Re=["mds"];let Ne=(()=>{class o{get nodes(){return this._nodes}set nodes(t){this._nodes&&this.mds&&this.mds.reInit(),this._nodes=t}constructor(t,i){this.nodeApi=t,this.toast=i,this.BulkBehaviour=Le.B1,this.onError=new e.vpe}isDirty(){return this.mds.mdsRef?this.mds.mdsRef.isDirty():this.mds.mdsEditorInstance.getHasUserChanges()}validate(){return!!this.mds.mdsEditorInstance.getIsValid()||(this.mds.mdsEditorInstance.showMissingRequiredWidgets(),!1)}save(){return this.isDirty()?(0,h.D)(this.nodes.map(t=>(0,w.D)(this.mds.getValues(t)).pipe((0,S.w)(i=>(delete i[a.u6.CM_NAME],this.nodeApi.editNodeMetadataNewVersion(t.ref.id,a.u6.COMMENT_METADATA_UPDATE,i)))))).pipe((0,M.U)(()=>{})):(0,v.of)(null)}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(a.xE),e.Y36(E.F))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["es-simple-edit-metadata"]],viewQuery:function(i,n){if(1&i&&e.Gf(Re,5),2&i){let s;e.iGM(s=e.CRH())&&(n.mds=s.first)}},inputs:{nodes:"nodes",fromUpload:"fromUpload"},outputs:{onError:"onError"},decls:2,vars:4,consts:[["groupId","io_simple",1,"mds-simple-editor",3,"embedded","allowReplacing","bulkBehaviour","nodes","onCancel"],["mds",""]],template:function(i,n){1&i&&(e.TgZ(0,"es-mds-editor-wrapper",0,1),e.NdJ("onCancel",function(){return n.onError.emit()}),e.qZA()),2&i&&e.Q6J("embedded",!0)("allowReplacing",!n.fromUpload)("bulkBehaviour",n.fromUpload?n.BulkBehaviour.Replace:n.BulkBehaviour.Default)("nodes",n.nodes)},dependencies:[Ae.o],styles:[".mds-simple-editor es-mds-editor-view h3{display:none!important}"],data:{animation:[(0,O.X$)("fade",g.Le.fade()),(0,O.X$)("cardAnimation",g.Le.cardAnimation())]}})}return o})(),xe=(()=>{class o{transform(t,i){return t?.every(n=>n.access.includes(i))}static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275pipe=e.Yjl({name:"hasPermission",type:o,pure:!0})}return o})();const ye=["metadata"],Ue=["invite"],be=["license"];let Ze=(()=>{class o{constructor(t,i,n,s,c,d,u){this.data=t,this.dialogRef=i,this.connector=n,this.dialogs=s,this.localEvents=c,this.nodeApi=d,this.toast=u,this._nodes=this.data.nodes,this.initState={license:!1,invite:!1},this.dialogRef.patchState({isLoading:!0}),this.connector.hasToolPermission(a.u6.TOOLPERMISSION_INVITE).subscribe(_=>this.tpInvite=_),this.connector.hasToolPermission(a.u6.TOOLPERMISSION_LICENSE).subscribe(_=>this.tpLicense=_),this._initButtons()}_initButtons(){this.dialogRef.patchConfig({buttons:[new a.Qd("CANCEL",{color:"standard"},()=>this._cancel()),new a.Qd("SAVE",{color:"primary"},()=>this._saveAndClose())]})}_saveAndClose(){this._save().subscribe(t=>{t&&t.length>0&&(this.localEvents.nodesChanged.next(t),this.dialogRef.close(t))})}_cancel(){this.dialogRef.close(null)}_openMetadata(){var t=this;return(0,m.Z)(function*(){if(!(yield t._ensureUpToDate()))return;const s=yield(yield t.dialogs.openMdsEditorDialogForNodes({nodes:t._nodes})).afterClosed().toPromise();s&&(t._nodes=s)})()}_openShare(){var t=this;return(0,m.Z)(function*(){(yield t._ensureUpToDate())&&(yield(yield t.dialogs.openShareDialog({nodes:t._nodes})).afterClosed().toPromise(),t.dialogRef.patchState({isLoading:!0}),h.D(t._nodes.map(s=>t.nodeApi.getNodeMetadata(s.ref.id,[a.u6.ALL]))).subscribe(s=>{t._nodes=s.map(c=>c.node),t.dialogRef.patchState({isLoading:!1})}))})()}_openLicense(){var t=this;return(0,m.Z)(function*(){if(!(yield t._ensureUpToDate()))return;const s=yield(yield t.dialogs.openLicenseDialog({kind:"nodes",nodes:t._nodes})).afterClosed().toPromise();s&&(t._nodes=s)})()}_save(){return this.metadata.validate()?(this.dialogRef.patchState({isLoading:!0}),this.metadata.save().pipe((0,S.w)(()=>this.invite.save()),(0,S.w)(()=>this.license.save()),(0,S.w)(()=>h.D(this._nodes.map(t=>this.nodeApi.getNodeMetadata(t.ref.id,[a.u6.ALL])))),(0,M.U)(t=>(this.toast.toast("SIMPLE_EDIT.SAVED"+(1===t.length?"":"_MULTIPLE"),{name:t[0].node.name,count:t.length}),this.dialogRef.patchState({isLoading:!1}),t.map(i=>i.node))),(0,y.K)(t=>(this.toast.error(t),this.dialogRef.patchState({isLoading:!1}),v.of(null))))):v.of(null)}_ensureUpToDate(){var t=this;return(0,m.Z)(function*(){if(!t._isDirty())return!0;if("SAVE"===(yield(yield t.dialogs.openGenericDialog({title:"SIMPLE_EDIT.DIRTY.TITLE",message:"SIMPLE_EDIT.DIRTY.MESSAGE",buttons:C.o8})).afterClosed().toPromise())){const s=yield t._save().toPromise();if(s)return t._nodes=s,!0}return!1})()}_isDirty(){return this.metadata.isDirty()||this.invite.isDirty()||this.license.isDirty()}_updateInitState(t){this.initState[t]=!0,this.initState.invite&&this.initState.license&&this.dialogRef.patchState({isLoading:!1})}_handleError(t){t&&this.toast.error(t),this.dialogRef.close(null)}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(U.W9),e.Y36(f.Y),e.Y36(a.xD),e.Y36(T.H),e.Y36(g.Xn),e.Y36(a.xE),e.Y36(E.F))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["es-simple-edit-dialog"]],viewQuery:function(i,n){if(1&i&&(e.Gf(ye,5),e.Gf(Ue,5),e.Gf(be,5)),2&i){let s;e.iGM(s=e.CRH())&&(n.metadata=s.first),e.iGM(s=e.CRH())&&(n.invite=s.first),e.iGM(s=e.CRH())&&(n.license=s.first)}},decls:37,vars:29,consts:[[1,"block"],[1,"top"],[1,"mat-heading-3"],["mat-button","","color","primary","data-test","more-metadata-button",3,"click"],["esIcon","edit"],[3,"nodes","fromUpload","onError"],["metadata",""],["mat-button","","color","primary",3,"disabled","click"],["esIcon","group_add"],[3,"nodes","fromUpload","onError","onInitFinished"],["invite",""],["esIcon","copyright"],["license",""]],template:function(i,n){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"div")(6,"button",3),e.NdJ("click",function(){return n._openMetadata()}),e._UZ(7,"i",4),e._uU(8),e.ALo(9,"translate"),e.qZA()()(),e.TgZ(10,"es-simple-edit-metadata",5,6),e.NdJ("onError",function(c){return n._handleError(c)}),e.qZA()(),e.TgZ(12,"div",0)(13,"div",1)(14,"h3",2),e._uU(15),e.ALo(16,"translate"),e.qZA(),e.TgZ(17,"div")(18,"button",7),e.NdJ("click",function(){return n._openShare()}),e.ALo(19,"hasPermission"),e._UZ(20,"i",8),e._uU(21),e.ALo(22,"translate"),e.qZA()()(),e.TgZ(23,"es-simple-edit-invite",9,10),e.NdJ("onError",function(c){return n._handleError(c)})("onInitFinished",function(){return n._updateInitState("invite")}),e.qZA()(),e.TgZ(25,"div",0)(26,"div",1)(27,"h3",2),e._uU(28),e.ALo(29,"translate"),e.qZA(),e.TgZ(30,"div")(31,"button",7),e.NdJ("click",function(){return n._openLicense()}),e._UZ(32,"i",11),e._uU(33),e.ALo(34,"translate"),e.qZA()()(),e.TgZ(35,"es-simple-edit-license",9,12),e.NdJ("onError",function(c){return n._handleError(c)})("onInitFinished",function(){return n._updateInitState("license")}),e.qZA()()),2&i&&(e.xp6(3),e.hij(" ",e.lcZ(4,14,"SIMPLE_EDIT.METADATA.TITLE")," "),e.xp6(5),e.hij(" ",e.lcZ(9,16,"SIMPLE_EDIT.METADATA.MORE")," "),e.xp6(2),e.Q6J("nodes",n._nodes)("fromUpload",n.data.fromUpload),e.xp6(5),e.hij(" ",e.lcZ(16,18,"SIMPLE_EDIT.INVITE.TITLE")," "),e.xp6(3),e.Q6J("disabled",!n.tpInvite||!e.xi3(19,20,n._nodes,"ChangePermissions")),e.xp6(3),e.hij(" ",e.lcZ(22,23,"SIMPLE_EDIT.INVITE.MORE")," "),e.xp6(2),e.Q6J("nodes",n._nodes)("fromUpload",n.data.fromUpload),e.xp6(5),e.hij(" ",e.lcZ(29,25,"SIMPLE_EDIT.LICENSE.TITLE")," "),e.xp6(3),e.Q6J("disabled",!n.tpLicense),e.xp6(2),e.hij(" ",e.lcZ(34,27,"SIMPLE_EDIT.LICENSE.MORE")," "),e.xp6(2),e.Q6J("nodes",n._nodes)("fromUpload",n.data.fromUpload))},dependencies:[g.ar,G.lW,ge,Me,Ne,x.X$,xe],styles:[".block[_ngcontent-%COMP%]{display:flex;flex-direction:column}.block[_ngcontent-%COMP%]:not(:first-child){padding-top:20px}.block[_ngcontent-%COMP%]:not(:last-child){padding-bottom:20px;border-bottom:1px solid #ccc}.block[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]{display:flex;align-items:center}.block[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%] > h3[_ngcontent-%COMP%]{color:#383838;font-weight:700;flex-grow:1;font-size:125%}.block[_ngcontent-%COMP%]   .top[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;top:3px}"]})}return o})(),Ge=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[r.m,P.x]})}return o})()},73815:(H,R,l)=>{l.d(R,{X:()=>U});var r=l(65879),P=l(86825),m=l(52081),h=l(96814),v=l(56223),S=l(24516),M=l(64170),y=l(71365);function a(C,e){if(1&C){const f=r.EpF();r.TgZ(0,"div")(1,"div",3)(2,"mat-form-field")(3,"mat-label"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"input",4),r.NdJ("ngModelChange",function(g){r.CHM(f);const E=r.oxw();return r.KtG(E.ccTitleOfWorkChange.emit(g))}),r.qZA()(),r.TgZ(7,"mat-form-field")(8,"mat-label"),r._uU(9),r.ALo(10,"translate"),r.qZA(),r.TgZ(11,"input",5),r.NdJ("ngModelChange",function(g){r.CHM(f);const E=r.oxw();return r.KtG(E.ccSourceUrlChange.emit(g))}),r.qZA()(),r.TgZ(12,"mat-form-field")(13,"mat-label"),r._uU(14),r.ALo(15,"translate"),r.qZA(),r.TgZ(16,"input",6),r.NdJ("ngModelChange",function(g){r.CHM(f);const E=r.oxw();return r.KtG(E.ccProfileUrlChange.emit(g))}),r.qZA()()()()}if(2&C){const f=r.oxw();r.Q6J("@cardAnimation",f.showCcAuthor),r.xp6(4),r.Oqu(r.lcZ(5,7,"WORKSPACE.LICENSE.CC.TITLE_OF_WORK")),r.xp6(2),r.Q6J("ngModel",f.ccTitleOfWork),r.xp6(3),r.Oqu(r.lcZ(10,9,"WORKSPACE.LICENSE.CC.SOURCE_URL")),r.xp6(2),r.Q6J("ngModel",f.ccSourceUrl),r.xp6(3),r.Oqu(r.lcZ(15,11,"WORKSPACE.LICENSE.CC.PROFILE_URL")),r.xp6(2),r.Q6J("ngModel",f.ccProfileUrl)}}let U=(()=>{class C{constructor(){this.ccTitleOfWork="",this.ccTitleOfWorkChange=new r.vpe,this.ccSourceUrl="",this.ccSourceUrlChange=new r.vpe,this.ccProfileUrl="",this.ccProfileUrlChange=new r.vpe}static#e=this.\u0275fac=function(T){return new(T||C)};static#t=this.\u0275cmp=r.Xpm({type:C,selectors:[["es-license-source"]],inputs:{ccTitleOfWork:"ccTitleOfWork",ccSourceUrl:"ccSourceUrl",ccProfileUrl:"ccProfileUrl"},outputs:{ccTitleOfWorkChange:"ccTitleOfWorkChange",ccSourceUrlChange:"ccSourceUrlChange",ccProfileUrlChange:"ccProfileUrlChange"},decls:5,vars:5,consts:[["id","reference-info-expander",1,"clickable",3,"click"],[3,"esIcon"],[4,"ngIf"],["role","group","aria-labelledby","reference-info-expander",1,"ccAuthorGroup"],["matInput","","id","CC_TITLE",3,"ngModel","ngModelChange"],["matInput","","id","CC_URL",3,"ngModel","ngModelChange"],["matInput","","id","CC_PROFILE",3,"ngModel","ngModelChange"]],template:function(T,g){1&T&&(r.TgZ(0,"a",0),r.NdJ("click",function(){return g.showCcAuthor=!g.showCcAuthor}),r._UZ(1,"i",1),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.YNc(4,a,17,13,"div",2)),2&T&&(r.xp6(1),r.s9C("esIcon",g.showCcAuthor?"keyboard_arrow_down":"keyboard_arrow_right"),r.xp6(1),r.hij(" ",r.lcZ(3,3,"WORKSPACE.LICENSE.CC.NAME_AUTHOR"),"\n"),r.xp6(2),r.Q6J("ngIf",g.showCcAuthor))},dependencies:[h.O5,v.Fj,v.JJ,v.On,S.Nt,M.KE,M.hX,m.ar,y.X$],styles:["#reference-info-expander[_ngcontent-%COMP%]{display:inline-flex;vertical-align:middle;padding-right:5px;font-weight:700;line-height:24px;text-decoration:none}.ccAuthorGroup[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-top:10px}.ccAuthorGroup[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}"],data:{animation:[(0,P.X$)("fade",m.Le.fade()),(0,P.X$)("cardAnimation",m.Le.cardAnimation()),(0,P.X$)("dialog",m.Le.switchDialog())]}})}return C})()}}]);